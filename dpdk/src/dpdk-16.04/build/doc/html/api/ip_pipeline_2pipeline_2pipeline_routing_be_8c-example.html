<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DPDK: ip_pipeline/pipeline/pipeline_routing_be.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">16.04.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ip_pipeline/pipeline/pipeline_routing_be.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*-</span></div>
<div class="line"><span class="comment"> *   BSD LICENSE</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Copyright(c) 2010-2016 Intel Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *   All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment"> *   modification, are permitted provided that the following conditions</span></div>
<div class="line"><span class="comment"> *   are met:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment"> *     * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer in</span></div>
<div class="line"><span class="comment"> *       the documentation and/or other materials provided with the</span></div>
<div class="line"><span class="comment"> *       distribution.</span></div>
<div class="line"><span class="comment"> *     * Neither the name of Intel Corporation nor the names of its</span></div>
<div class="line"><span class="comment"> *       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment"> *       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment"> *   &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment"> *   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment"> *   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment"> *   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment"> *   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment"> *   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment"> *   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment"> *   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__malloc_8h.html">rte_malloc.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ip_8h.html">rte_ip.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__byteorder_8h.html">rte_byteorder.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__table__lpm_8h.html">rte_table_lpm.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__table__hash_8h.html">rte_table_hash.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__pipeline_8h.html">rte_pipeline.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;pipeline_routing_be.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pipeline_actions_common.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;parser.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;hash_func.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define MPLS_LABEL(label, exp, s, ttl)                  \</span></div>
<div class="line"><span class="preprocessor">    (((((uint64_t) (label)) &amp; 0xFFFFFLLU) &lt;&lt; 12) |      \</span></div>
<div class="line"><span class="preprocessor">    ((((uint64_t) (exp)) &amp; 0x7LLU) &lt;&lt; 9) |              \</span></div>
<div class="line"><span class="preprocessor">    ((((uint64_t) (s)) &amp; 0x1LLU) &lt;&lt; 8) |                \</span></div>
<div class="line"><span class="preprocessor">    (((uint64_t) (ttl)) &amp; 0xFFLU))</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define RTE_SCHED_PORT_HIERARCHY(subport, pipe,     \</span></div>
<div class="line"><span class="preprocessor">    traffic_class, queue, color)                \</span></div>
<div class="line"><span class="preprocessor">    ((((uint64_t) (queue)) &amp; 0x3) |                \</span></div>
<div class="line"><span class="preprocessor">    ((((uint64_t) (traffic_class)) &amp; 0x3) &lt;&lt; 2) |  \</span></div>
<div class="line"><span class="preprocessor">    ((((uint64_t) (color)) &amp; 0x3) &lt;&lt; 4) |          \</span></div>
<div class="line"><span class="preprocessor">    ((((uint64_t) (subport)) &amp; 0xFFFF) &lt;&lt; 16) |    \</span></div>
<div class="line"><span class="preprocessor">    ((((uint64_t) (pipe)) &amp; 0xFFFFFFFF) &lt;&lt; 32))</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define MAC_SRC_DEFAULT 0x112233445566ULL</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifndef PIPELINE_ROUTING_LPM_TABLE_NUMBER_TABLE8s</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define PIPELINE_ROUTING_LPM_TABLE_NUMBER_TABLE8s 256</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">struct </span>pipeline_routing {</div>
<div class="line">    <span class="keyword">struct </span>pipeline p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_params params;</div>
<div class="line">    pipeline_msg_req_handler custom_handlers[PIPELINE_ROUTING_MSG_REQS];</div>
<div class="line">} <a name="a0"></a><a class="code" href="rte__memory_8h.html#a1a29b3bf8655b79e8dca721c5e815aa4">__rte_cache_aligned</a>;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Message handlers</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_custom_handler(<span class="keyword">struct</span> pipeline *p, <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> pipeline_msg_req_handler handlers[] = {</div>
<div class="line">    [PIPELINE_MSG_REQ_PING] =</div>
<div class="line">        pipeline_msg_req_ping_handler,</div>
<div class="line">    [PIPELINE_MSG_REQ_STATS_PORT_IN] =</div>
<div class="line">        pipeline_msg_req_stats_port_in_handler,</div>
<div class="line">    [PIPELINE_MSG_REQ_STATS_PORT_OUT] =</div>
<div class="line">        pipeline_msg_req_stats_port_out_handler,</div>
<div class="line">    [PIPELINE_MSG_REQ_STATS_TABLE] =</div>
<div class="line">        pipeline_msg_req_stats_table_handler,</div>
<div class="line">    [PIPELINE_MSG_REQ_PORT_IN_ENABLE] =</div>
<div class="line">        pipeline_msg_req_port_in_enable_handler,</div>
<div class="line">    [PIPELINE_MSG_REQ_PORT_IN_DISABLE] =</div>
<div class="line">        pipeline_msg_req_port_in_disable_handler,</div>
<div class="line">    [PIPELINE_MSG_REQ_CUSTOM] =</div>
<div class="line">        pipeline_routing_msg_req_custom_handler,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_add_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_del_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_add_default_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_del_default_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_add_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_del_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_add_default_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_del_default_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> pipeline_msg_req_handler custom_handlers[] = {</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ROUTE_ADD] =</div>
<div class="line">        pipeline_routing_msg_req_route_add_handler,</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ROUTE_DEL] =</div>
<div class="line">        pipeline_routing_msg_req_route_del_handler,</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ROUTE_ADD_DEFAULT] =</div>
<div class="line">        pipeline_routing_msg_req_route_add_default_handler,</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ROUTE_DEL_DEFAULT] =</div>
<div class="line">        pipeline_routing_msg_req_route_del_default_handler,</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ARP_ADD] =</div>
<div class="line">        pipeline_routing_msg_req_arp_add_handler,</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ARP_DEL] =</div>
<div class="line">        pipeline_routing_msg_req_arp_del_handler,</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ARP_ADD_DEFAULT] =</div>
<div class="line">        pipeline_routing_msg_req_arp_add_default_handler,</div>
<div class="line">    [PIPELINE_ROUTING_MSG_REQ_ARP_DEL_DEFAULT] =</div>
<div class="line">        pipeline_routing_msg_req_arp_del_default_handler,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Routing table</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>routing_table_entry {</div>
<div class="line">    <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> head;</div>
<div class="line">    uint32_t flags;</div>
<div class="line">    uint32_t <a name="a2"></a><a class="code" href="structrte__pipeline__table__entry.html#a6f54b893342775cdf092c6646e57c83b">port_id</a>; <span class="comment">/* Output port ID */</span></div>
<div class="line">    uint32_t ip; <span class="comment">/* Next hop IP address (only valid for remote routes) */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* ether_l2 */</span></div>
<div class="line">    uint16_t data_offset;</div>
<div class="line">    uint16_t ether_l2_length;</div>
<div class="line">    uint64_t slab[4];</div>
<div class="line">    uint16_t slab_offset[4];</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>layout {</div>
<div class="line">    uint16_t a;</div>
<div class="line">    uint32_t b;</div>
<div class="line">    uint16_t c;</div>
<div class="line">} __attribute__((__packed__));</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define MACADDR_DST_WRITE(slab_ptr, slab)           \</span></div>
<div class="line"><span class="preprocessor">{                               \</span></div>
<div class="line"><span class="preprocessor">    struct layout *dst = (struct layout *) (slab_ptr);  \</span></div>
<div class="line"><span class="preprocessor">    struct layout *src = (struct layout *) &amp;(slab);     \</span></div>
<div class="line"><span class="preprocessor">                                \</span></div>
<div class="line"><span class="preprocessor">    dst-&gt;b = src-&gt;b;                    \</span></div>
<div class="line"><span class="preprocessor">    dst-&gt;c = src-&gt;c;                    \</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> __attribute__((always_inline)) void</div>
<div class="line">pkt_work_routing(</div>
<div class="line">    struct <a name="_a3"></a><a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt,</div>
<div class="line">    struct <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *table_entry,</div>
<div class="line">    <span class="keywordtype">void</span> *arg,</div>
<div class="line">    <span class="keywordtype">int</span> arp,</div>
<div class="line">    <span class="keywordtype">int</span> qinq,</div>
<div class="line">    <span class="keywordtype">int</span> qinq_sched,</div>
<div class="line">    <span class="keywordtype">int</span> mpls,</div>
<div class="line">    <span class="keywordtype">int</span> mpls_color_mark)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing *p_rt = arg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry *entry =</div>
<div class="line">        (<span class="keyword">struct </span>routing_table_entry *) table_entry;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span><a name="_a4"></a><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *ip = (<span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *)</div>
<div class="line">        <a name="a5"></a><a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkt, p_rt-&gt;params.ip_hdr_offset);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a> pkt_color = (<span class="keyword">enum</span> <a name="a6"></a><a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a>)</div>
<div class="line">        <a name="a7"></a><a class="code" href="rte__port_8h.html#a37621cb39d2e1111004b7ee499b6afae">RTE_MBUF_METADATA_UINT32</a>(pkt, p_rt-&gt;params.color_offset);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *arp_key =</div>
<div class="line">        (<span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkt, p_rt-&gt;params.arp_key_offset);</div>
<div class="line"></div>
<div class="line">    uint64_t *slab0_ptr, *slab1_ptr, *slab2_ptr, *slab3_ptr, sched;</div>
<div class="line">    uint32_t ip_da, nh_ip, port_id;</div>
<div class="line">    uint16_t total_length, data_offset, ether_l2_length;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read */</span></div>
<div class="line">    total_length = <a name="a8"></a><a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(ip-&gt;<a name="a9"></a><a class="code" href="structipv4__hdr.html#aa487bb47bd88257a2fcd58d10c7836a2">total_length</a>);</div>
<div class="line">    ip_da = ip-&gt;<a name="a10"></a><a class="code" href="structipv4__hdr.html#ad3367f6b5057b9c73b012338e5a437ae">dst_addr</a>;</div>
<div class="line">    data_offset = entry-&gt;data_offset;</div>
<div class="line">    ether_l2_length = entry-&gt;ether_l2_length;</div>
<div class="line">    slab0_ptr = <a name="a11"></a><a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkt, entry-&gt;slab_offset[0]);</div>
<div class="line">    slab1_ptr = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkt, entry-&gt;slab_offset[1]);</div>
<div class="line">    slab2_ptr = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkt, entry-&gt;slab_offset[2]);</div>
<div class="line">    slab3_ptr = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkt, entry-&gt;slab_offset[3]);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (arp) {</div>
<div class="line">        port_id = entry-&gt;port_id;</div>
<div class="line">        nh_ip = entry-&gt;ip;</div>
<div class="line">        <span class="keywordflow">if</span> (entry-&gt;flags &amp; PIPELINE_ROUTING_ROUTE_LOCAL)</div>
<div class="line">            nh_ip = ip_da;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Compute */</span></div>
<div class="line">    total_length += ether_l2_length;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (qinq &amp;&amp; qinq_sched) {</div>
<div class="line">        uint32_t dscp = ip-&gt;<a name="a12"></a><a class="code" href="structipv4__hdr.html#ad9000ab1449737219532b889f0da0f02">type_of_service</a> &gt;&gt; 2;</div>
<div class="line">        uint32_t svlan, cvlan, tc, tc_q;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (qinq_sched == 1) {</div>
<div class="line">            uint64_t slab_qinq = <a name="a13"></a><a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(entry-&gt;slab[0]);</div>
<div class="line"></div>
<div class="line">            svlan = (slab_qinq &gt;&gt; 48) &amp; 0xFFF;</div>
<div class="line">            cvlan = (slab_qinq &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            tc = (dscp &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc_q = dscp &amp; 0x3;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            uint32_t ip_src = <a name="a14"></a><a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(ip-&gt;<a name="a15"></a><a class="code" href="structipv4__hdr.html#a6a462ff6ecd832025b4f8934f226d5b5">src_addr</a>);</div>
<div class="line"></div>
<div class="line">            svlan = 0;</div>
<div class="line">            cvlan = (ip_src &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            tc = (ip_src &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc_q = ip_src &amp; 0x3;</div>
<div class="line">        }</div>
<div class="line">        sched = RTE_SCHED_PORT_HIERARCHY(svlan,</div>
<div class="line">            cvlan,</div>
<div class="line">            tc,</div>
<div class="line">            tc_q,</div>
<div class="line">            <a name="a16"></a><a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3aa635687a12163cdd741edb786ba5419ec">e_RTE_METER_GREEN</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Write */</span></div>
<div class="line">    pkt-&gt;data_off = data_offset;</div>
<div class="line">    pkt-&gt;data_len = total_length;</div>
<div class="line">    pkt-&gt;pkt_len = total_length;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((qinq == 0) &amp;&amp; (mpls == 0)) {</div>
<div class="line">        *slab0_ptr = entry-&gt;slab[0];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (arp == 0)</div>
<div class="line">            MACADDR_DST_WRITE(slab1_ptr, entry-&gt;slab[1]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (qinq) {</div>
<div class="line">        *slab0_ptr = entry-&gt;slab[0];</div>
<div class="line">        *slab1_ptr = entry-&gt;slab[1];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (arp == 0)</div>
<div class="line">            MACADDR_DST_WRITE(slab2_ptr, entry-&gt;slab[2]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (qinq_sched) {</div>
<div class="line">            pkt-&gt;hash.sched.lo = sched &amp; 0xFFFFFFFF;</div>
<div class="line">            pkt-&gt;hash.sched.hi = sched &gt;&gt; 32;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (mpls) {</div>
<div class="line">        <span class="keywordflow">if</span> (mpls_color_mark) {</div>
<div class="line">            uint64_t mpls_exp = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(0, pkt_color, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(0, pkt_color, 0, 0));</div>
<div class="line"></div>
<div class="line">            *slab0_ptr = entry-&gt;slab[0] | mpls_exp;</div>
<div class="line">            *slab1_ptr = entry-&gt;slab[1] | mpls_exp;</div>
<div class="line">            *slab2_ptr = entry-&gt;slab[2];</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            *slab0_ptr = entry-&gt;slab[0];</div>
<div class="line">            *slab1_ptr = entry-&gt;slab[1];</div>
<div class="line">            *slab2_ptr = entry-&gt;slab[2];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (arp == 0)</div>
<div class="line">            MACADDR_DST_WRITE(slab3_ptr, entry-&gt;slab[3]);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (arp) {</div>
<div class="line">        arp_key-&gt;port_id = port_id;</div>
<div class="line">        arp_key-&gt;ip = nh_ip;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> __attribute__((always_inline)) void</div>
<div class="line">pkt4_work_routing(</div>
<div class="line">    struct <a class="code" href="structrte__mbuf.html">rte_mbuf</a> **pkts,</div>
<div class="line">    struct <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **table_entries,</div>
<div class="line">    <span class="keywordtype">void</span> *arg,</div>
<div class="line">    <span class="keywordtype">int</span> arp,</div>
<div class="line">    <span class="keywordtype">int</span> qinq,</div>
<div class="line">    <span class="keywordtype">int</span> qinq_sched,</div>
<div class="line">    <span class="keywordtype">int</span> mpls,</div>
<div class="line">    <span class="keywordtype">int</span> mpls_color_mark)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing *p_rt = arg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry *entry0 =</div>
<div class="line">        (<span class="keyword">struct </span>routing_table_entry *) table_entries[0];</div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry *entry1 =</div>
<div class="line">        (<span class="keyword">struct </span>routing_table_entry *) table_entries[1];</div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry *entry2 =</div>
<div class="line">        (<span class="keyword">struct </span>routing_table_entry *) table_entries[2];</div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry *entry3 =</div>
<div class="line">        (<span class="keyword">struct </span>routing_table_entry *) table_entries[3];</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *ip0 = (<span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[0],</div>
<div class="line">            p_rt-&gt;params.ip_hdr_offset);</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *ip1 = (<span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[1],</div>
<div class="line">            p_rt-&gt;params.ip_hdr_offset);</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *ip2 = (<span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[2],</div>
<div class="line">            p_rt-&gt;params.ip_hdr_offset);</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *ip3 = (<span class="keyword">struct </span><a class="code" href="structipv4__hdr.html">ipv4_hdr</a> *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[3],</div>
<div class="line">            p_rt-&gt;params.ip_hdr_offset);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a> pkt0_color = (<span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a>)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#a37621cb39d2e1111004b7ee499b6afae">RTE_MBUF_METADATA_UINT32</a>(pkts[0], p_rt-&gt;params.color_offset);</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a> pkt1_color = (<span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a>)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#a37621cb39d2e1111004b7ee499b6afae">RTE_MBUF_METADATA_UINT32</a>(pkts[1], p_rt-&gt;params.color_offset);</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a> pkt2_color = (<span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a>)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#a37621cb39d2e1111004b7ee499b6afae">RTE_MBUF_METADATA_UINT32</a>(pkts[2], p_rt-&gt;params.color_offset);</div>
<div class="line">    <span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a> pkt3_color = (<span class="keyword">enum</span> <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3a">rte_meter_color</a>)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#a37621cb39d2e1111004b7ee499b6afae">RTE_MBUF_METADATA_UINT32</a>(pkts[3], p_rt-&gt;params.color_offset);</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *arp_key0 =</div>
<div class="line">        (<span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[0],</div>
<div class="line">            p_rt-&gt;params.arp_key_offset);</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *arp_key1 =</div>
<div class="line">        (<span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[1],</div>
<div class="line">            p_rt-&gt;params.arp_key_offset);</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *arp_key2 =</div>
<div class="line">        (<span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[2],</div>
<div class="line">            p_rt-&gt;params.arp_key_offset);</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *arp_key3 =</div>
<div class="line">        (<span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 *)</div>
<div class="line">        <a class="code" href="rte__port_8h.html#aa7e19e3725e9ccd22492cf06bac819b9">RTE_MBUF_METADATA_UINT8_PTR</a>(pkts[3],</div>
<div class="line">            p_rt-&gt;params.arp_key_offset);</div>
<div class="line"></div>
<div class="line">    uint64_t *slab0_ptr0, *slab1_ptr0, *slab2_ptr0, *slab3_ptr0;</div>
<div class="line">    uint64_t *slab0_ptr1, *slab1_ptr1, *slab2_ptr1, *slab3_ptr1;</div>
<div class="line">    uint64_t *slab0_ptr2, *slab1_ptr2, *slab2_ptr2, *slab3_ptr2;</div>
<div class="line">    uint64_t *slab0_ptr3, *slab1_ptr3, *slab2_ptr3, *slab3_ptr3;</div>
<div class="line">    uint64_t sched0, sched1, sched2, sched3;</div>
<div class="line"></div>
<div class="line">    uint32_t ip_da0, nh_ip0, port_id0;</div>
<div class="line">    uint32_t ip_da1, nh_ip1, port_id1;</div>
<div class="line">    uint32_t ip_da2, nh_ip2, port_id2;</div>
<div class="line">    uint32_t ip_da3, nh_ip3, port_id3;</div>
<div class="line"></div>
<div class="line">    uint16_t total_length0, data_offset0, ether_l2_length0;</div>
<div class="line">    uint16_t total_length1, data_offset1, ether_l2_length1;</div>
<div class="line">    uint16_t total_length2, data_offset2, ether_l2_length2;</div>
<div class="line">    uint16_t total_length3, data_offset3, ether_l2_length3;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read */</span></div>
<div class="line">    total_length0 = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(ip0-&gt;<a class="code" href="structipv4__hdr.html#aa487bb47bd88257a2fcd58d10c7836a2">total_length</a>);</div>
<div class="line">    total_length1 = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(ip1-&gt;<a class="code" href="structipv4__hdr.html#aa487bb47bd88257a2fcd58d10c7836a2">total_length</a>);</div>
<div class="line">    total_length2 = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(ip2-&gt;<a class="code" href="structipv4__hdr.html#aa487bb47bd88257a2fcd58d10c7836a2">total_length</a>);</div>
<div class="line">    total_length3 = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(ip3-&gt;<a class="code" href="structipv4__hdr.html#aa487bb47bd88257a2fcd58d10c7836a2">total_length</a>);</div>
<div class="line"></div>
<div class="line">    ip_da0 = ip0-&gt;<a class="code" href="structipv4__hdr.html#ad3367f6b5057b9c73b012338e5a437ae">dst_addr</a>;</div>
<div class="line">    ip_da1 = ip1-&gt;<a class="code" href="structipv4__hdr.html#ad3367f6b5057b9c73b012338e5a437ae">dst_addr</a>;</div>
<div class="line">    ip_da2 = ip2-&gt;<a class="code" href="structipv4__hdr.html#ad3367f6b5057b9c73b012338e5a437ae">dst_addr</a>;</div>
<div class="line">    ip_da3 = ip3-&gt;<a class="code" href="structipv4__hdr.html#ad3367f6b5057b9c73b012338e5a437ae">dst_addr</a>;</div>
<div class="line"></div>
<div class="line">    data_offset0 = entry0-&gt;data_offset;</div>
<div class="line">    data_offset1 = entry1-&gt;data_offset;</div>
<div class="line">    data_offset2 = entry2-&gt;data_offset;</div>
<div class="line">    data_offset3 = entry3-&gt;data_offset;</div>
<div class="line"></div>
<div class="line">    ether_l2_length0 = entry0-&gt;ether_l2_length;</div>
<div class="line">    ether_l2_length1 = entry1-&gt;ether_l2_length;</div>
<div class="line">    ether_l2_length2 = entry2-&gt;ether_l2_length;</div>
<div class="line">    ether_l2_length3 = entry3-&gt;ether_l2_length;</div>
<div class="line"></div>
<div class="line">    slab0_ptr0 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[0],</div>
<div class="line">        entry0-&gt;slab_offset[0]);</div>
<div class="line">    slab1_ptr0 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[0],</div>
<div class="line">        entry0-&gt;slab_offset[1]);</div>
<div class="line">    slab2_ptr0 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[0],</div>
<div class="line">        entry0-&gt;slab_offset[2]);</div>
<div class="line">    slab3_ptr0 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[0],</div>
<div class="line">        entry0-&gt;slab_offset[3]);</div>
<div class="line"></div>
<div class="line">    slab0_ptr1 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[1],</div>
<div class="line">        entry1-&gt;slab_offset[0]);</div>
<div class="line">    slab1_ptr1 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[1],</div>
<div class="line">        entry1-&gt;slab_offset[1]);</div>
<div class="line">    slab2_ptr1 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[1],</div>
<div class="line">        entry1-&gt;slab_offset[2]);</div>
<div class="line">    slab3_ptr1 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[1],</div>
<div class="line">        entry1-&gt;slab_offset[3]);</div>
<div class="line"></div>
<div class="line">    slab0_ptr2 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[2],</div>
<div class="line">        entry2-&gt;slab_offset[0]);</div>
<div class="line">    slab1_ptr2 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[2],</div>
<div class="line">        entry2-&gt;slab_offset[1]);</div>
<div class="line">    slab2_ptr2 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[2],</div>
<div class="line">        entry2-&gt;slab_offset[2]);</div>
<div class="line">    slab3_ptr2 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[2],</div>
<div class="line">        entry2-&gt;slab_offset[3]);</div>
<div class="line"></div>
<div class="line">    slab0_ptr3 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[3],</div>
<div class="line">        entry3-&gt;slab_offset[0]);</div>
<div class="line">    slab1_ptr3 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[3],</div>
<div class="line">        entry3-&gt;slab_offset[1]);</div>
<div class="line">    slab2_ptr3 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[3],</div>
<div class="line">        entry3-&gt;slab_offset[2]);</div>
<div class="line">    slab3_ptr3 = <a class="code" href="rte__port_8h.html#aac211161c49f1b4a84243a911421fd50">RTE_MBUF_METADATA_UINT64_PTR</a>(pkts[3],</div>
<div class="line">        entry3-&gt;slab_offset[3]);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (arp) {</div>
<div class="line">        port_id0 = entry0-&gt;port_id;</div>
<div class="line">        nh_ip0 = entry0-&gt;ip;</div>
<div class="line">        <span class="keywordflow">if</span> (entry0-&gt;flags &amp; PIPELINE_ROUTING_ROUTE_LOCAL)</div>
<div class="line">            nh_ip0 = ip_da0;</div>
<div class="line"></div>
<div class="line">        port_id1 = entry1-&gt;port_id;</div>
<div class="line">        nh_ip1 = entry1-&gt;ip;</div>
<div class="line">        <span class="keywordflow">if</span> (entry1-&gt;flags &amp; PIPELINE_ROUTING_ROUTE_LOCAL)</div>
<div class="line">            nh_ip1 = ip_da1;</div>
<div class="line"></div>
<div class="line">        port_id2 = entry2-&gt;port_id;</div>
<div class="line">        nh_ip2 = entry2-&gt;ip;</div>
<div class="line">        <span class="keywordflow">if</span> (entry2-&gt;flags &amp; PIPELINE_ROUTING_ROUTE_LOCAL)</div>
<div class="line">            nh_ip2 = ip_da2;</div>
<div class="line"></div>
<div class="line">        port_id3 = entry3-&gt;port_id;</div>
<div class="line">        nh_ip3 = entry3-&gt;ip;</div>
<div class="line">        <span class="keywordflow">if</span> (entry3-&gt;flags &amp; PIPELINE_ROUTING_ROUTE_LOCAL)</div>
<div class="line">            nh_ip3 = ip_da3;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Compute */</span></div>
<div class="line">    total_length0 += ether_l2_length0;</div>
<div class="line">    total_length1 += ether_l2_length1;</div>
<div class="line">    total_length2 += ether_l2_length2;</div>
<div class="line">    total_length3 += ether_l2_length3;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (qinq &amp;&amp; qinq_sched) {</div>
<div class="line">        uint32_t dscp0 = ip0-&gt;<a class="code" href="structipv4__hdr.html#ad9000ab1449737219532b889f0da0f02">type_of_service</a> &gt;&gt; 2;</div>
<div class="line">        uint32_t dscp1 = ip1-&gt;<a class="code" href="structipv4__hdr.html#ad9000ab1449737219532b889f0da0f02">type_of_service</a> &gt;&gt; 2;</div>
<div class="line">        uint32_t dscp2 = ip2-&gt;<a class="code" href="structipv4__hdr.html#ad9000ab1449737219532b889f0da0f02">type_of_service</a> &gt;&gt; 2;</div>
<div class="line">        uint32_t dscp3 = ip3-&gt;<a class="code" href="structipv4__hdr.html#ad9000ab1449737219532b889f0da0f02">type_of_service</a> &gt;&gt; 2;</div>
<div class="line">        uint32_t svlan0, cvlan0, tc0, tc_q0;</div>
<div class="line">        uint32_t svlan1, cvlan1, tc1, tc_q1;</div>
<div class="line">        uint32_t svlan2, cvlan2, tc2, tc_q2;</div>
<div class="line">        uint32_t svlan3, cvlan3, tc3, tc_q3;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (qinq_sched == 1) {</div>
<div class="line">            uint64_t slab_qinq0 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(entry0-&gt;slab[0]);</div>
<div class="line">            uint64_t slab_qinq1 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(entry1-&gt;slab[0]);</div>
<div class="line">            uint64_t slab_qinq2 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(entry2-&gt;slab[0]);</div>
<div class="line">            uint64_t slab_qinq3 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(entry3-&gt;slab[0]);</div>
<div class="line"></div>
<div class="line">            svlan0 = (slab_qinq0 &gt;&gt; 48) &amp; 0xFFF;</div>
<div class="line">            svlan1 = (slab_qinq1 &gt;&gt; 48) &amp; 0xFFF;</div>
<div class="line">            svlan2 = (slab_qinq2 &gt;&gt; 48) &amp; 0xFFF;</div>
<div class="line">            svlan3 = (slab_qinq3 &gt;&gt; 48) &amp; 0xFFF;</div>
<div class="line"></div>
<div class="line">            cvlan0 = (slab_qinq0 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            cvlan1 = (slab_qinq1 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            cvlan2 = (slab_qinq2 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            cvlan3 = (slab_qinq3 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line"></div>
<div class="line">            tc0 = (dscp0 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc1 = (dscp1 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc2 = (dscp2 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc3 = (dscp3 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line"></div>
<div class="line">            tc_q0 = dscp0 &amp; 0x3;</div>
<div class="line">            tc_q1 = dscp1 &amp; 0x3;</div>
<div class="line">            tc_q2 = dscp2 &amp; 0x3;</div>
<div class="line">            tc_q3 = dscp3 &amp; 0x3;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            uint32_t ip_src0 = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(ip0-&gt;<a class="code" href="structipv4__hdr.html#a6a462ff6ecd832025b4f8934f226d5b5">src_addr</a>);</div>
<div class="line">            uint32_t ip_src1 = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(ip1-&gt;<a class="code" href="structipv4__hdr.html#a6a462ff6ecd832025b4f8934f226d5b5">src_addr</a>);</div>
<div class="line">            uint32_t ip_src2 = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(ip2-&gt;<a class="code" href="structipv4__hdr.html#a6a462ff6ecd832025b4f8934f226d5b5">src_addr</a>);</div>
<div class="line">            uint32_t ip_src3 = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(ip3-&gt;<a class="code" href="structipv4__hdr.html#a6a462ff6ecd832025b4f8934f226d5b5">src_addr</a>);</div>
<div class="line"></div>
<div class="line">            svlan0 = 0;</div>
<div class="line">            svlan1 = 0;</div>
<div class="line">            svlan2 = 0;</div>
<div class="line">            svlan3 = 0;</div>
<div class="line"></div>
<div class="line">            cvlan0 = (ip_src0 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            cvlan1 = (ip_src1 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            cvlan2 = (ip_src2 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line">            cvlan3 = (ip_src3 &gt;&gt; 16) &amp; 0xFFF;</div>
<div class="line"></div>
<div class="line">            tc0 = (ip_src0 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc1 = (ip_src1 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc2 = (ip_src2 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line">            tc3 = (ip_src3 &gt;&gt; 2) &amp; 0x3;</div>
<div class="line"></div>
<div class="line">            tc_q0 = ip_src0 &amp; 0x3;</div>
<div class="line">            tc_q1 = ip_src1 &amp; 0x3;</div>
<div class="line">            tc_q2 = ip_src2 &amp; 0x3;</div>
<div class="line">            tc_q3 = ip_src3 &amp; 0x3;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        sched0 = RTE_SCHED_PORT_HIERARCHY(svlan0,</div>
<div class="line">            cvlan0,</div>
<div class="line">            tc0,</div>
<div class="line">            tc_q0,</div>
<div class="line">            <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3aa635687a12163cdd741edb786ba5419ec">e_RTE_METER_GREEN</a>);</div>
<div class="line">        sched1 = RTE_SCHED_PORT_HIERARCHY(svlan1,</div>
<div class="line">            cvlan1,</div>
<div class="line">            tc1,</div>
<div class="line">            tc_q1,</div>
<div class="line">            <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3aa635687a12163cdd741edb786ba5419ec">e_RTE_METER_GREEN</a>);</div>
<div class="line">        sched2 = RTE_SCHED_PORT_HIERARCHY(svlan2,</div>
<div class="line">            cvlan2,</div>
<div class="line">            tc2,</div>
<div class="line">            tc_q2,</div>
<div class="line">            <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3aa635687a12163cdd741edb786ba5419ec">e_RTE_METER_GREEN</a>);</div>
<div class="line">        sched3 = RTE_SCHED_PORT_HIERARCHY(svlan3,</div>
<div class="line">            cvlan3,</div>
<div class="line">            tc3,</div>
<div class="line">            tc_q3,</div>
<div class="line">            <a class="code" href="rte__meter_8h.html#a9fdad5fa95e62568e827ab7d0c792f3aa635687a12163cdd741edb786ba5419ec">e_RTE_METER_GREEN</a>);</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Write */</span></div>
<div class="line">    pkts[0]-&gt;data_off = data_offset0;</div>
<div class="line">    pkts[1]-&gt;data_off = data_offset1;</div>
<div class="line">    pkts[2]-&gt;data_off = data_offset2;</div>
<div class="line">    pkts[3]-&gt;data_off = data_offset3;</div>
<div class="line"></div>
<div class="line">    pkts[0]-&gt;data_len = total_length0;</div>
<div class="line">    pkts[1]-&gt;data_len = total_length1;</div>
<div class="line">    pkts[2]-&gt;data_len = total_length2;</div>
<div class="line">    pkts[3]-&gt;data_len = total_length3;</div>
<div class="line"></div>
<div class="line">    pkts[0]-&gt;pkt_len = total_length0;</div>
<div class="line">    pkts[1]-&gt;pkt_len = total_length1;</div>
<div class="line">    pkts[2]-&gt;pkt_len = total_length2;</div>
<div class="line">    pkts[3]-&gt;pkt_len = total_length3;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((qinq == 0) &amp;&amp; (mpls == 0)) {</div>
<div class="line">        *slab0_ptr0 = entry0-&gt;slab[0];</div>
<div class="line">        *slab0_ptr1 = entry1-&gt;slab[0];</div>
<div class="line">        *slab0_ptr2 = entry2-&gt;slab[0];</div>
<div class="line">        *slab0_ptr3 = entry3-&gt;slab[0];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (arp == 0) {</div>
<div class="line">            MACADDR_DST_WRITE(slab1_ptr0, entry0-&gt;slab[1]);</div>
<div class="line">            MACADDR_DST_WRITE(slab1_ptr1, entry1-&gt;slab[1]);</div>
<div class="line">            MACADDR_DST_WRITE(slab1_ptr2, entry2-&gt;slab[1]);</div>
<div class="line">            MACADDR_DST_WRITE(slab1_ptr3, entry3-&gt;slab[1]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (qinq) {</div>
<div class="line">        *slab0_ptr0 = entry0-&gt;slab[0];</div>
<div class="line">        *slab0_ptr1 = entry1-&gt;slab[0];</div>
<div class="line">        *slab0_ptr2 = entry2-&gt;slab[0];</div>
<div class="line">        *slab0_ptr3 = entry3-&gt;slab[0];</div>
<div class="line"></div>
<div class="line">        *slab1_ptr0 = entry0-&gt;slab[1];</div>
<div class="line">        *slab1_ptr1 = entry1-&gt;slab[1];</div>
<div class="line">        *slab1_ptr2 = entry2-&gt;slab[1];</div>
<div class="line">        *slab1_ptr3 = entry3-&gt;slab[1];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (arp == 0) {</div>
<div class="line">            MACADDR_DST_WRITE(slab2_ptr0, entry0-&gt;slab[2]);</div>
<div class="line">            MACADDR_DST_WRITE(slab2_ptr1, entry1-&gt;slab[2]);</div>
<div class="line">            MACADDR_DST_WRITE(slab2_ptr2, entry2-&gt;slab[2]);</div>
<div class="line">            MACADDR_DST_WRITE(slab2_ptr3, entry3-&gt;slab[2]);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (qinq_sched) {</div>
<div class="line">            pkts[0]-&gt;hash.sched.lo = sched0 &amp; 0xFFFFFFFF;</div>
<div class="line">            pkts[0]-&gt;hash.sched.hi = sched0 &gt;&gt; 32;</div>
<div class="line">            pkts[1]-&gt;hash.sched.lo = sched1 &amp; 0xFFFFFFFF;</div>
<div class="line">            pkts[1]-&gt;hash.sched.hi = sched1 &gt;&gt; 32;</div>
<div class="line">            pkts[2]-&gt;hash.sched.lo = sched2 &amp; 0xFFFFFFFF;</div>
<div class="line">            pkts[2]-&gt;hash.sched.hi = sched2 &gt;&gt; 32;</div>
<div class="line">            pkts[3]-&gt;hash.sched.lo = sched3 &amp; 0xFFFFFFFF;</div>
<div class="line">            pkts[3]-&gt;hash.sched.hi = sched3 &gt;&gt; 32;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (mpls) {</div>
<div class="line">        <span class="keywordflow">if</span> (mpls_color_mark) {</div>
<div class="line">            uint64_t mpls_exp0 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(0, pkt0_color, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(0, pkt0_color, 0, 0));</div>
<div class="line">            uint64_t mpls_exp1 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(0, pkt1_color, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(0, pkt1_color, 0, 0));</div>
<div class="line">            uint64_t mpls_exp2 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(0, pkt2_color, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(0, pkt2_color, 0, 0));</div>
<div class="line">            uint64_t mpls_exp3 = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(0, pkt3_color, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(0, pkt3_color, 0, 0));</div>
<div class="line"></div>
<div class="line">            *slab0_ptr0 = entry0-&gt;slab[0] | mpls_exp0;</div>
<div class="line">            *slab0_ptr1 = entry1-&gt;slab[0] | mpls_exp1;</div>
<div class="line">            *slab0_ptr2 = entry2-&gt;slab[0] | mpls_exp2;</div>
<div class="line">            *slab0_ptr3 = entry3-&gt;slab[0] | mpls_exp3;</div>
<div class="line"></div>
<div class="line">            *slab1_ptr0 = entry0-&gt;slab[1] | mpls_exp0;</div>
<div class="line">            *slab1_ptr1 = entry1-&gt;slab[1] | mpls_exp1;</div>
<div class="line">            *slab1_ptr2 = entry2-&gt;slab[1] | mpls_exp2;</div>
<div class="line">            *slab1_ptr3 = entry3-&gt;slab[1] | mpls_exp3;</div>
<div class="line"></div>
<div class="line">            *slab2_ptr0 = entry0-&gt;slab[2];</div>
<div class="line">            *slab2_ptr1 = entry1-&gt;slab[2];</div>
<div class="line">            *slab2_ptr2 = entry2-&gt;slab[2];</div>
<div class="line">            *slab2_ptr3 = entry3-&gt;slab[2];</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            *slab0_ptr0 = entry0-&gt;slab[0];</div>
<div class="line">            *slab0_ptr1 = entry1-&gt;slab[0];</div>
<div class="line">            *slab0_ptr2 = entry2-&gt;slab[0];</div>
<div class="line">            *slab0_ptr3 = entry3-&gt;slab[0];</div>
<div class="line"></div>
<div class="line">            *slab1_ptr0 = entry0-&gt;slab[1];</div>
<div class="line">            *slab1_ptr1 = entry1-&gt;slab[1];</div>
<div class="line">            *slab1_ptr2 = entry2-&gt;slab[1];</div>
<div class="line">            *slab1_ptr3 = entry3-&gt;slab[1];</div>
<div class="line"></div>
<div class="line">            *slab2_ptr0 = entry0-&gt;slab[2];</div>
<div class="line">            *slab2_ptr1 = entry1-&gt;slab[2];</div>
<div class="line">            *slab2_ptr2 = entry2-&gt;slab[2];</div>
<div class="line">            *slab2_ptr3 = entry3-&gt;slab[2];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (arp == 0) {</div>
<div class="line">            MACADDR_DST_WRITE(slab3_ptr0, entry0-&gt;slab[3]);</div>
<div class="line">            MACADDR_DST_WRITE(slab3_ptr1, entry1-&gt;slab[3]);</div>
<div class="line">            MACADDR_DST_WRITE(slab3_ptr2, entry2-&gt;slab[3]);</div>
<div class="line">            MACADDR_DST_WRITE(slab3_ptr3, entry3-&gt;slab[3]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (arp) {</div>
<div class="line">        arp_key0-&gt;port_id = port_id0;</div>
<div class="line">        arp_key1-&gt;port_id = port_id1;</div>
<div class="line">        arp_key2-&gt;port_id = port_id2;</div>
<div class="line">        arp_key3-&gt;port_id = port_id3;</div>
<div class="line"></div>
<div class="line">        arp_key0-&gt;ip = nh_ip0;</div>
<div class="line">        arp_key1-&gt;ip = nh_ip1;</div>
<div class="line">        arp_key2-&gt;ip = nh_ip2;</div>
<div class="line">        arp_key3-&gt;ip = nh_ip3;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define PKT_WORK_ROUTING_ETHERNET(arp)              \</span></div>
<div class="line"><span class="preprocessor">static inline void                      \</span></div>
<div class="line"><span class="preprocessor">pkt_work_routing_ether_arp##arp(                \</span></div>
<div class="line"><span class="preprocessor">    struct rte_mbuf *pkt,                   \</span></div>
<div class="line"><span class="preprocessor">    struct rte_pipeline_table_entry *table_entry,       \</span></div>
<div class="line"><span class="preprocessor">    void *arg)                      \</span></div>
<div class="line"><span class="preprocessor">{                               \</span></div>
<div class="line"><span class="preprocessor">    pkt_work_routing(pkt, table_entry, arg, arp, 0, 0, 0, 0);\</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define PKT4_WORK_ROUTING_ETHERNET(arp)             \</span></div>
<div class="line"><span class="preprocessor">static inline void                      \</span></div>
<div class="line"><span class="preprocessor">pkt4_work_routing_ether_arp##arp(               \</span></div>
<div class="line"><span class="preprocessor">    struct rte_mbuf **pkts,                 \</span></div>
<div class="line"><span class="preprocessor">    struct rte_pipeline_table_entry **table_entries,    \</span></div>
<div class="line"><span class="preprocessor">    void *arg)                      \</span></div>
<div class="line"><span class="preprocessor">{                               \</span></div>
<div class="line"><span class="preprocessor">    pkt4_work_routing(pkts, table_entries, arg, arp, 0, 0, 0, 0);\</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define routing_table_ah_hit_ether(arp)             \</span></div>
<div class="line"><span class="preprocessor">PKT_WORK_ROUTING_ETHERNET(arp)                  \</span></div>
<div class="line"><span class="preprocessor">PKT4_WORK_ROUTING_ETHERNET(arp)                 \</span></div>
<div class="line"><span class="preprocessor">PIPELINE_TABLE_AH_HIT(routing_table_ah_hit_ether_arp##arp,  \</span></div>
<div class="line"><span class="preprocessor">    pkt_work_routing_ether_arp##arp,            \</span></div>
<div class="line"><span class="preprocessor">    pkt4_work_routing_ether_arp##arp)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">routing_table_ah_hit_ether(0)</div>
<div class="line">routing_table_ah_hit_ether(1)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define PKT_WORK_ROUTING_ETHERNET_QINQ(sched, arp)      \</span></div>
<div class="line"><span class="preprocessor">static inline void                      \</span></div>
<div class="line"><span class="preprocessor">pkt_work_routing_ether_qinq_sched##sched##_arp##arp(        \</span></div>
<div class="line"><span class="preprocessor">    struct rte_mbuf *pkt,                   \</span></div>
<div class="line"><span class="preprocessor">    struct rte_pipeline_table_entry *table_entry,       \</span></div>
<div class="line"><span class="preprocessor">    void *arg)                      \</span></div>
<div class="line"><span class="preprocessor">{                               \</span></div>
<div class="line"><span class="preprocessor">    pkt_work_routing(pkt, table_entry, arg, arp, 1, sched, 0, 0);\</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define PKT4_WORK_ROUTING_ETHERNET_QINQ(sched, arp)     \</span></div>
<div class="line"><span class="preprocessor">static inline void                      \</span></div>
<div class="line"><span class="preprocessor">pkt4_work_routing_ether_qinq_sched##sched##_arp##arp(       \</span></div>
<div class="line"><span class="preprocessor">    struct rte_mbuf **pkts,                 \</span></div>
<div class="line"><span class="preprocessor">    struct rte_pipeline_table_entry **table_entries,    \</span></div>
<div class="line"><span class="preprocessor">    void *arg)                      \</span></div>
<div class="line"><span class="preprocessor">{                               \</span></div>
<div class="line"><span class="preprocessor">    pkt4_work_routing(pkts, table_entries, arg, arp, 1, sched, 0, 0);\</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define routing_table_ah_hit_ether_qinq(sched, arp)     \</span></div>
<div class="line"><span class="preprocessor">PKT_WORK_ROUTING_ETHERNET_QINQ(sched, arp)          \</span></div>
<div class="line"><span class="preprocessor">PKT4_WORK_ROUTING_ETHERNET_QINQ(sched, arp)         \</span></div>
<div class="line"><span class="preprocessor">PIPELINE_TABLE_AH_HIT(routing_table_ah_hit_ether_qinq_sched##sched##_arp##arp,\</span></div>
<div class="line"><span class="preprocessor">    pkt_work_routing_ether_qinq_sched##sched##_arp##arp,    \</span></div>
<div class="line"><span class="preprocessor">    pkt4_work_routing_ether_qinq_sched##sched##_arp##arp)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">routing_table_ah_hit_ether_qinq(0, 0)</div>
<div class="line">routing_table_ah_hit_ether_qinq(1, 0)</div>
<div class="line">routing_table_ah_hit_ether_qinq(2, 0)</div>
<div class="line">routing_table_ah_hit_ether_qinq(0, 1)</div>
<div class="line">routing_table_ah_hit_ether_qinq(1, 1)</div>
<div class="line">routing_table_ah_hit_ether_qinq(2, 1)</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define PKT_WORK_ROUTING_ETHERNET_MPLS(color, arp)      \</span></div>
<div class="line"><span class="preprocessor">static inline void                      \</span></div>
<div class="line"><span class="preprocessor">pkt_work_routing_ether_mpls_color##color##_arp##arp(        \</span></div>
<div class="line"><span class="preprocessor">    struct rte_mbuf *pkt,                   \</span></div>
<div class="line"><span class="preprocessor">    struct rte_pipeline_table_entry *table_entry,       \</span></div>
<div class="line"><span class="preprocessor">    void *arg)                      \</span></div>
<div class="line"><span class="preprocessor">{                               \</span></div>
<div class="line"><span class="preprocessor">    pkt_work_routing(pkt, table_entry, arg, arp, 0, 0, 1, color);\</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define PKT4_WORK_ROUTING_ETHERNET_MPLS(color, arp)     \</span></div>
<div class="line"><span class="preprocessor">static inline void                      \</span></div>
<div class="line"><span class="preprocessor">pkt4_work_routing_ether_mpls_color##color##_arp##arp(       \</span></div>
<div class="line"><span class="preprocessor">    struct rte_mbuf **pkts,                 \</span></div>
<div class="line"><span class="preprocessor">    struct rte_pipeline_table_entry **table_entries,    \</span></div>
<div class="line"><span class="preprocessor">    void *arg)                      \</span></div>
<div class="line"><span class="preprocessor">{                               \</span></div>
<div class="line"><span class="preprocessor">    pkt4_work_routing(pkts, table_entries, arg, arp, 0, 0, 1, color);\</span></div>
<div class="line"><span class="preprocessor">}</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define routing_table_ah_hit_ether_mpls(color, arp)     \</span></div>
<div class="line"><span class="preprocessor">PKT_WORK_ROUTING_ETHERNET_MPLS(color, arp)          \</span></div>
<div class="line"><span class="preprocessor">PKT4_WORK_ROUTING_ETHERNET_MPLS(color, arp)         \</span></div>
<div class="line"><span class="preprocessor">PIPELINE_TABLE_AH_HIT(routing_table_ah_hit_ether_mpls_color##color##_arp##arp,\</span></div>
<div class="line"><span class="preprocessor">    pkt_work_routing_ether_mpls_color##color##_arp##arp,    \</span></div>
<div class="line"><span class="preprocessor">    pkt4_work_routing_ether_mpls_color##color##_arp##arp)</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">routing_table_ah_hit_ether_mpls(0, 0)</div>
<div class="line">routing_table_ah_hit_ether_mpls(1, 0)</div>
<div class="line">routing_table_ah_hit_ether_mpls(0, 1)</div>
<div class="line">routing_table_ah_hit_ether_mpls(1, 1)</div>
<div class="line"></div>
<div class="line">static <a name="a17"></a><a class="code" href="rte__pipeline_8h.html#a690cec4a2e911968eb8036b333396f7f">rte_pipeline_table_action_handler_hit</a></div>
<div class="line">get_routing_table_ah_hit(struct pipeline_routing *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;params.dbg_ah_disable)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span> (p-&gt;params.encap) {</div>
<div class="line">    <span class="keywordflow">case</span> PIPELINE_ROUTING_ENCAP_ETHERNET:</div>
<div class="line">        <span class="keywordflow">return</span> (p-&gt;params.n_arp_entries) ?</div>
<div class="line">            routing_table_ah_hit_ether_arp1 :</div>
<div class="line">            routing_table_ah_hit_ether_arp0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> PIPELINE_ROUTING_ENCAP_ETHERNET_QINQ:</div>
<div class="line">        <span class="keywordflow">if</span> (p-&gt;params.n_arp_entries)</div>
<div class="line">            <span class="keywordflow">switch</span> (p-&gt;params.qinq_sched) {</div>
<div class="line">            <span class="keywordflow">case</span> 0:</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_qinq_sched0_arp1;</div>
<div class="line">            <span class="keywordflow">case</span> 1:</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_qinq_sched1_arp1;</div>
<div class="line">            <span class="keywordflow">case</span> 2:</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_qinq_sched2_arp1;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> NULL;</div>
<div class="line">            }</div>
<div class="line">         <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">switch</span> (p-&gt;params.qinq_sched) {</div>
<div class="line">            <span class="keywordflow">case</span> 0:</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_qinq_sched0_arp0;</div>
<div class="line">            <span class="keywordflow">case</span> 1:</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_qinq_sched1_arp0;</div>
<div class="line">            <span class="keywordflow">case</span> 2:</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_qinq_sched2_arp0;</div>
<div class="line">            <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">return</span> NULL;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> PIPELINE_ROUTING_ENCAP_ETHERNET_MPLS:</div>
<div class="line">        <span class="keywordflow">if</span> (p-&gt;params.n_arp_entries)</div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;params.mpls_color_mark)</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_mpls_color1_arp1;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_mpls_color0_arp1;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">if</span> (p-&gt;params.mpls_color_mark)</div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_mpls_color1_arp0;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">return</span> routing_table_ah_hit_ether_mpls_color0_arp0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * ARP table</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>arp_table_entry {</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> head;</div>
<div class="line">    uint64_t macaddr;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">pkt_work_arp(</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> *pkt,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *table_entry,</div>
<div class="line">    <a name="a18"></a><a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>arp_table_entry *entry = (<span class="keyword">struct </span>arp_table_entry *) table_entry;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read */</span></div>
<div class="line">    uint64_t macaddr_dst = entry-&gt;macaddr;</div>
<div class="line">    uint64_t *slab_ptr = (uint64_t *) ((<span class="keywordtype">char</span> *) pkt-&gt;<a name="a19"></a><a class="code" href="structrte__mbuf.html#a9db3d388a1381e68e509017a6e7d0f12">buf_addr</a> +</div>
<div class="line">        (pkt-&gt;<a name="a20"></a>data_off - 2));</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Compute */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Write */</span></div>
<div class="line">    MACADDR_DST_WRITE(slab_ptr, macaddr_dst);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span></div>
<div class="line">pkt4_work_arp(</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__mbuf.html">rte_mbuf</a> **pkts,</div>
<div class="line">    <span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **table_entries,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>arp_table_entry *entry0 =</div>
<div class="line">        (<span class="keyword">struct </span>arp_table_entry *) table_entries[0];</div>
<div class="line">    <span class="keyword">struct </span>arp_table_entry *entry1 =</div>
<div class="line">        (<span class="keyword">struct </span>arp_table_entry *) table_entries[1];</div>
<div class="line">    <span class="keyword">struct </span>arp_table_entry *entry2 =</div>
<div class="line">        (<span class="keyword">struct </span>arp_table_entry *) table_entries[2];</div>
<div class="line">    <span class="keyword">struct </span>arp_table_entry *entry3 =</div>
<div class="line">        (<span class="keyword">struct </span>arp_table_entry *) table_entries[3];</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read */</span></div>
<div class="line">    uint64_t macaddr_dst0 = entry0-&gt;macaddr;</div>
<div class="line">    uint64_t macaddr_dst1 = entry1-&gt;macaddr;</div>
<div class="line">    uint64_t macaddr_dst2 = entry2-&gt;macaddr;</div>
<div class="line">    uint64_t macaddr_dst3 = entry3-&gt;macaddr;</div>
<div class="line"></div>
<div class="line">    uint64_t *slab_ptr0 = (uint64_t *) ((<span class="keywordtype">char</span> *) pkts[0]-&gt;<a class="code" href="structrte__mbuf.html#a9db3d388a1381e68e509017a6e7d0f12">buf_addr</a> +</div>
<div class="line">        (pkts[0]-&gt;data_off - 2));</div>
<div class="line">    uint64_t *slab_ptr1 = (uint64_t *) ((<span class="keywordtype">char</span> *) pkts[1]-&gt;<a class="code" href="structrte__mbuf.html#a9db3d388a1381e68e509017a6e7d0f12">buf_addr</a> +</div>
<div class="line">        (pkts[1]-&gt;data_off - 2));</div>
<div class="line">    uint64_t *slab_ptr2 = (uint64_t *) ((<span class="keywordtype">char</span> *) pkts[2]-&gt;<a class="code" href="structrte__mbuf.html#a9db3d388a1381e68e509017a6e7d0f12">buf_addr</a> +</div>
<div class="line">        (pkts[2]-&gt;data_off - 2));</div>
<div class="line">    uint64_t *slab_ptr3 = (uint64_t *) ((<span class="keywordtype">char</span> *) pkts[3]-&gt;<a class="code" href="structrte__mbuf.html#a9db3d388a1381e68e509017a6e7d0f12">buf_addr</a> +</div>
<div class="line">        (pkts[3]-&gt;data_off - 2));</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Compute */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Write */</span></div>
<div class="line">    MACADDR_DST_WRITE(slab_ptr0, macaddr_dst0);</div>
<div class="line">    MACADDR_DST_WRITE(slab_ptr1, macaddr_dst1);</div>
<div class="line">    MACADDR_DST_WRITE(slab_ptr2, macaddr_dst2);</div>
<div class="line">    MACADDR_DST_WRITE(slab_ptr3, macaddr_dst3);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">PIPELINE_TABLE_AH_HIT(arp_table_ah_hit,</div>
<div class="line">    pkt_work_arp,</div>
<div class="line">    pkt4_work_arp);</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="rte__pipeline_8h.html#a690cec4a2e911968eb8036b333396f7f">rte_pipeline_table_action_handler_hit</a></div>
<div class="line">get_arp_table_ah_hit(<span class="keyword">struct</span> pipeline_routing *p)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;params.dbg_ah_disable)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> arp_table_ah_hit;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Argument parsing</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">pipeline_routing_parse_args(<span class="keyword">struct</span> pipeline_routing_params *p,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_params *params)</div>
<div class="line">{</div>
<div class="line">    uint32_t n_routes_present = 0;</div>
<div class="line">    uint32_t encap_present = 0;</div>
<div class="line">    uint32_t qinq_sched_present = 0;</div>
<div class="line">    uint32_t mpls_color_mark_present = 0;</div>
<div class="line">    uint32_t n_arp_entries_present = 0;</div>
<div class="line">    uint32_t ip_hdr_offset_present = 0;</div>
<div class="line">    uint32_t arp_key_offset_present = 0;</div>
<div class="line">    uint32_t color_offset_present = 0;</div>
<div class="line">    uint32_t dbg_ah_disable_present = 0;</div>
<div class="line">    uint32_t i;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* default values */</span></div>
<div class="line">    p-&gt;n_routes = PIPELINE_ROUTING_N_ROUTES_DEFAULT;</div>
<div class="line">    p-&gt;encap = PIPELINE_ROUTING_ENCAP_ETHERNET;</div>
<div class="line">    p-&gt;qinq_sched = 0;</div>
<div class="line">    p-&gt;mpls_color_mark = 0;</div>
<div class="line">    p-&gt;n_arp_entries = 0;</div>
<div class="line">    p-&gt;dbg_ah_disable = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; params-&gt;n_args; i++) {</div>
<div class="line">        <span class="keywordtype">char</span> *arg_name = params-&gt;args_name[i];</div>
<div class="line">        <span class="keywordtype">char</span> *arg_value = params-&gt;args_value[i];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* n_routes */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;n_routes&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                n_routes_present == 0, params-&gt;name,</div>
<div class="line">                arg_name);</div>
<div class="line">            n_routes_present = 1;</div>
<div class="line"></div>
<div class="line">            status = parser_read_uint32(&amp;p-&gt;n_routes,</div>
<div class="line">                arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL(((status != -EINVAL) &amp;&amp;</div>
<div class="line">                (p-&gt;n_routes != 0)), params-&gt;name,</div>
<div class="line">                arg_name, arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_OUT_RNG((status != -ERANGE),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* encap */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;encap&quot;</span>) == 0) {</div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(encap_present == 0,</div>
<div class="line">                params-&gt;name, arg_name);</div>
<div class="line">            encap_present = 1;</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* ethernet */</span></div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(arg_value, <span class="stringliteral">&quot;ethernet&quot;</span>) == 0) {</div>
<div class="line">                p-&gt;encap = PIPELINE_ROUTING_ENCAP_ETHERNET;</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* ethernet_qinq */</span></div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(arg_value, <span class="stringliteral">&quot;ethernet_qinq&quot;</span>) == 0) {</div>
<div class="line">                p-&gt;encap = PIPELINE_ROUTING_ENCAP_ETHERNET_QINQ;</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* ethernet_mpls */</span></div>
<div class="line">            <span class="keywordflow">if</span> (strcmp(arg_value, <span class="stringliteral">&quot;ethernet_mpls&quot;</span>) == 0) {</div>
<div class="line">                p-&gt;encap = PIPELINE_ROUTING_ENCAP_ETHERNET_MPLS;</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="comment">/* any other */</span></div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL(0, params-&gt;name,</div>
<div class="line">                arg_name, arg_value);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* qinq_sched */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;qinq_sched&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                qinq_sched_present == 0, params-&gt;name,</div>
<div class="line">                arg_name);</div>
<div class="line">            qinq_sched_present = 1;</div>
<div class="line"></div>
<div class="line">            status = parser_read_arg_bool(arg_value);</div>
<div class="line">            <span class="keywordflow">if</span> (status == -EINVAL) {</div>
<div class="line">                <span class="keywordflow">if</span> (strcmp(arg_value, <span class="stringliteral">&quot;test&quot;</span>) == 0) {</div>
<div class="line">                    p-&gt;qinq_sched = 2;</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                p-&gt;qinq_sched = status;</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL(0, params-&gt;name,</div>
<div class="line">                arg_name, arg_value);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* mpls_color_mark */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;mpls_color_mark&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                mpls_color_mark_present == 0,</div>
<div class="line">                params-&gt;name, arg_name);</div>
<div class="line">            mpls_color_mark_present = 1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">            status = parser_read_arg_bool(arg_value);</div>
<div class="line">            <span class="keywordflow">if</span> (status &gt;= 0) {</div>
<div class="line">                p-&gt;mpls_color_mark = status;</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL(0, params-&gt;name,</div>
<div class="line">                arg_name, arg_value);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* n_arp_entries */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;n_arp_entries&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                n_arp_entries_present == 0, params-&gt;name,</div>
<div class="line">                arg_name);</div>
<div class="line">            n_arp_entries_present = 1;</div>
<div class="line"></div>
<div class="line">            status = parser_read_uint32(&amp;p-&gt;n_arp_entries,</div>
<div class="line">                arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL((status != -EINVAL),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_OUT_RNG((status != -ERANGE),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* ip_hdr_offset */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;ip_hdr_offset&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                ip_hdr_offset_present == 0, params-&gt;name,</div>
<div class="line">                arg_name);</div>
<div class="line">            ip_hdr_offset_present = 1;</div>
<div class="line"></div>
<div class="line">            status = parser_read_uint32(&amp;p-&gt;ip_hdr_offset,</div>
<div class="line">                arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL((status != -EINVAL),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_OUT_RNG((status != -ERANGE),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* arp_key_offset */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;arp_key_offset&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                arp_key_offset_present == 0, params-&gt;name,</div>
<div class="line">                arg_name);</div>
<div class="line">            arp_key_offset_present = 1;</div>
<div class="line"></div>
<div class="line">            status = parser_read_uint32(&amp;p-&gt;arp_key_offset,</div>
<div class="line">                arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL((status != -EINVAL),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_OUT_RNG((status != -ERANGE),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* color_offset */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;color_offset&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                color_offset_present == 0, params-&gt;name,</div>
<div class="line">                arg_name);</div>
<div class="line">            color_offset_present = 1;</div>
<div class="line"></div>
<div class="line">            status = parser_read_uint32(&amp;p-&gt;color_offset,</div>
<div class="line">                arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL((status != -EINVAL),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line">            PIPELINE_PARSE_ERR_OUT_RNG((status != -ERANGE),</div>
<div class="line">                params-&gt;name, arg_name, arg_value);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* debug */</span></div>
<div class="line">        <span class="keywordflow">if</span> (strcmp(arg_name, <span class="stringliteral">&quot;dbg_ah_disable&quot;</span>) == 0) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_DUPLICATE(</div>
<div class="line">                dbg_ah_disable_present == 0, params-&gt;name,</div>
<div class="line">                arg_name);</div>
<div class="line">            dbg_ah_disable_present = 1;</div>
<div class="line"></div>
<div class="line">            status = parser_read_arg_bool(arg_value);</div>
<div class="line">            <span class="keywordflow">if</span> (status &gt;= 0) {</div>
<div class="line">                p-&gt;dbg_ah_disable = status;</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            PIPELINE_PARSE_ERR_INV_VAL(0, params-&gt;name,</div>
<div class="line">                arg_name, arg_value);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* any other */</span></div>
<div class="line">        PIPELINE_PARSE_ERR_INV_ENT(0, params-&gt;name, arg_name);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check that mandatory arguments are present */</span></div>
<div class="line">    PIPELINE_PARSE_ERR_MANDATORY(ip_hdr_offset_present, params-&gt;name,</div>
<div class="line">        <span class="stringliteral">&quot;ip_hdr_offset&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check relations between arguments */</span></div>
<div class="line">    <span class="keywordflow">switch</span> (p-&gt;encap) {</div>
<div class="line">    <span class="keywordflow">case</span> PIPELINE_ROUTING_ENCAP_ETHERNET:</div>
<div class="line">        PIPELINE_ARG_CHECK((!p-&gt;qinq_sched), <span class="stringliteral">&quot;Parse error in &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;section \&quot;%s\&quot;: encap = ethernet, therefore &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;qinq_sched = yes/test is not allowed&quot;</span>,</div>
<div class="line">            params-&gt;name);</div>
<div class="line">        PIPELINE_ARG_CHECK((!p-&gt;mpls_color_mark), <span class="stringliteral">&quot;Parse error &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;in section \&quot;%s\&quot;: encap = ethernet, therefore &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;mpls_color_mark = yes is not allowed&quot;</span>,</div>
<div class="line">            params-&gt;name);</div>
<div class="line">        PIPELINE_ARG_CHECK((!color_offset_present), <span class="stringliteral">&quot;Parse error &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;in section \&quot;%s\&quot;: encap = ethernet, therefore &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;color_offset is not allowed&quot;</span>,</div>
<div class="line">            params-&gt;name);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> PIPELINE_ROUTING_ENCAP_ETHERNET_QINQ:</div>
<div class="line">        PIPELINE_ARG_CHECK((!p-&gt;mpls_color_mark), <span class="stringliteral">&quot;Parse error &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;in section \&quot;%s\&quot;: encap = ethernet_qinq, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;therefore mpls_color_mark = yes is not allowed&quot;</span>,</div>
<div class="line">            params-&gt;name);</div>
<div class="line">        PIPELINE_ARG_CHECK((!color_offset_present), <span class="stringliteral">&quot;Parse error &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;in section \&quot;%s\&quot;: encap = ethernet_qinq, &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;therefore color_offset is not allowed&quot;</span>,</div>
<div class="line">            params-&gt;name);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> PIPELINE_ROUTING_ENCAP_ETHERNET_MPLS:</div>
<div class="line">        PIPELINE_ARG_CHECK((!p-&gt;qinq_sched), <span class="stringliteral">&quot;Parse error in &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;section \&quot;%s\&quot;: encap = ethernet_mpls, therefore &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;qinq_sched  = yes/test is not allowed&quot;</span>,</div>
<div class="line">            params-&gt;name);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    PIPELINE_ARG_CHECK((!(p-&gt;n_arp_entries &amp;&amp;</div>
<div class="line">        (!arp_key_offset_present))), <span class="stringliteral">&quot;Parse error in section &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\&quot;%s\&quot;: n_arp_entries is set while &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;arp_key_offset is not set&quot;</span>, params-&gt;name);</div>
<div class="line"></div>
<div class="line">    PIPELINE_ARG_CHECK((!((p-&gt;n_arp_entries == 0) &amp;&amp;</div>
<div class="line">        arp_key_offset_present)), <span class="stringliteral">&quot;Parse error in section &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;\&quot;%s\&quot;: arp_key_offset present while &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;n_arp_entries is not set&quot;</span>, params-&gt;name);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_init(<span class="keyword">struct</span> pipeline_params *params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing *p_rt;</div>
<div class="line">    uint32_t size, i;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((params == NULL) ||</div>
<div class="line">        (params-&gt;n_ports_in == 0) ||</div>
<div class="line">        (params-&gt;n_ports_out == 0))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    size = <a name="a21"></a><a class="code" href="rte__memory_8h.html#a30eec128f3d71add687a1cbfe48abcbb">RTE_CACHE_LINE_ROUNDUP</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> pipeline_routing));</div>
<div class="line">    p = <a name="a22"></a><a class="code" href="rte__malloc_8h.html#a58042061ad622f028aa2b97e8cb73a41">rte_zmalloc</a>(NULL, size, RTE_CACHE_LINE_SIZE);</div>
<div class="line">    p_rt = (<span class="keyword">struct </span>pipeline_routing *) p;</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"></div>
<div class="line">    strcpy(p-&gt;name, params-&gt;name);</div>
<div class="line">    p-&gt;log_level = params-&gt;log_level;</div>
<div class="line"></div>
<div class="line">    PLOG(p, HIGH, <span class="stringliteral">&quot;Routing&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Parse arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (pipeline_routing_parse_args(&amp;p_rt-&gt;params, params))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Pipeline */</span></div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a23"></a><a class="code" href="structrte__pipeline__params.html">rte_pipeline_params</a> pipeline_params = {</div>
<div class="line">            .<a name="a24"></a><a class="code" href="structrte__pipeline__params.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = params-&gt;name,</div>
<div class="line">            .socket_id = params-&gt;socket_id,</div>
<div class="line">            .offset_port_id = 0,</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        p-&gt;p = <a name="a25"></a><a class="code" href="rte__pipeline_8h.html#ad650149ed178057bfb54bda0b6e39e05">rte_pipeline_create</a>(&amp;pipeline_params);</div>
<div class="line">        <span class="keywordflow">if</span> (p-&gt;p == NULL) {</div>
<div class="line">            <a name="a26"></a><a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Input ports */</span></div>
<div class="line">    p-&gt;n_ports_in = params-&gt;n_ports_in;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;n_ports_in; i++) {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a27"></a><a class="code" href="structrte__pipeline__port__in__params.html">rte_pipeline_port_in_params</a> port_params = {</div>
<div class="line">            .<a name="a28"></a><a class="code" href="structrte__pipeline__port__in__params.html#ad8c92480b58ad5e6b7917c16b5ea7b3d">ops</a> = pipeline_port_in_params_get_ops(</div>
<div class="line">                &amp;params-&gt;port_in[i]),</div>
<div class="line">            .arg_create = pipeline_port_in_params_convert(</div>
<div class="line">                &amp;params-&gt;port_in[i]),</div>
<div class="line">            .f_action = NULL,</div>
<div class="line">            .arg_ah = NULL,</div>
<div class="line">            .burst_size = params-&gt;port_in[i].burst_size,</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> status = <a name="a29"></a><a class="code" href="rte__pipeline_8h.html#ab0c0f093519ccc9fbb76e7c5696fd266">rte_pipeline_port_in_create</a>(p-&gt;p,</div>
<div class="line">            &amp;port_params,</div>
<div class="line">            &amp;p-&gt;port_in_id[i]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            <a name="a30"></a><a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Output ports */</span></div>
<div class="line">    p-&gt;n_ports_out = params-&gt;n_ports_out;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;n_ports_out; i++) {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a31"></a><a class="code" href="structrte__pipeline__port__out__params.html">rte_pipeline_port_out_params</a> port_params = {</div>
<div class="line">            .<a class="code" href="structrte__pipeline__port__in__params.html#ad8c92480b58ad5e6b7917c16b5ea7b3d">ops</a> = pipeline_port_out_params_get_ops(</div>
<div class="line">                &amp;params-&gt;port_out[i]),</div>
<div class="line">            .arg_create = pipeline_port_out_params_convert(</div>
<div class="line">                &amp;params-&gt;port_out[i]),</div>
<div class="line">            .f_action = NULL,</div>
<div class="line">            .arg_ah = NULL,</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> status = <a name="a32"></a><a class="code" href="rte__pipeline_8h.html#a247f58fe13cba38922ccf5c60a2f86bb">rte_pipeline_port_out_create</a>(p-&gt;p,</div>
<div class="line">            &amp;port_params,</div>
<div class="line">            &amp;p-&gt;port_out_id[i]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            <a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Routing table */</span></div>
<div class="line">    p-&gt;n_tables = 1;</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a33"></a><a class="code" href="structrte__table__lpm__params.html">rte_table_lpm_params</a> table_lpm_params = {</div>
<div class="line">            .<a name="a34"></a><a class="code" href="structrte__table__lpm__params.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = p-&gt;name,</div>
<div class="line">            .n_rules = p_rt-&gt;params.n_routes,</div>
<div class="line">            .number_tbl8s = PIPELINE_ROUTING_LPM_TABLE_NUMBER_TABLE8s,</div>
<div class="line">            .flags = 0,</div>
<div class="line">            .entry_unique_size = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>routing_table_entry),</div>
<div class="line">            .offset = p_rt-&gt;params.ip_hdr_offset +</div>
<div class="line">                __builtin_offsetof(<span class="keyword">struct</span> <a class="code" href="structipv4__hdr.html">ipv4_hdr</a>, dst_addr),</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a name="_a35"></a><a class="code" href="structrte__pipeline__table__params.html">rte_pipeline_table_params</a> table_params = {</div>
<div class="line">                .<a name="a36"></a><a class="code" href="structrte__pipeline__table__params.html#ad1966fbeee5c7e1923a4e567b5bcd77d">ops</a> = &amp;<a name="a37"></a><a class="code" href="rte__table__lpm_8h.html#ad8ce9bc1c0f2a5b25ea367b4b3d52c0c">rte_table_lpm_ops</a>,</div>
<div class="line">                .arg_create = &amp;table_lpm_params,</div>
<div class="line">                .f_action_hit = get_routing_table_ah_hit(p_rt),</div>
<div class="line">                .f_action_miss = NULL,</div>
<div class="line">                .arg_ah = p_rt,</div>
<div class="line">                .action_data_size =</div>
<div class="line">                    <span class="keyword">sizeof</span>(<span class="keyword">struct </span>routing_table_entry) -</div>
<div class="line">                    sizeof(struct <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a>),</div>
<div class="line">            };</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">        status = <a name="a38"></a><a class="code" href="rte__pipeline_8h.html#af1cb4d7ac4516443e6f9d82a4beebed6">rte_pipeline_table_create</a>(p-&gt;p,</div>
<div class="line">            &amp;table_params,</div>
<div class="line">            &amp;p-&gt;table_id[0]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            <a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* ARP table configuration */</span></div>
<div class="line">    <span class="keywordflow">if</span> (p_rt-&gt;params.n_arp_entries) {</div>
<div class="line">        <span class="keyword">struct </span><a name="_a39"></a><a class="code" href="structrte__table__hash__key8__ext__params.html">rte_table_hash_key8_ext_params</a> table_arp_params = {</div>
<div class="line">            .<a name="a40"></a><a class="code" href="structrte__table__hash__key8__ext__params.html#aafba5a1f8ad65b41148894026098cad7">n_entries</a> = p_rt-&gt;params.n_arp_entries,</div>
<div class="line">            .n_entries_ext = p_rt-&gt;params.n_arp_entries,</div>
<div class="line">            .f_hash = hash_default_key8,</div>
<div class="line">            .seed = 0,</div>
<div class="line">            .signature_offset = 0, <span class="comment">/* Unused */</span></div>
<div class="line">            .key_offset = p_rt-&gt;params.arp_key_offset,</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__params.html">rte_pipeline_table_params</a> table_params = {</div>
<div class="line">            .<a class="code" href="structrte__pipeline__table__params.html#ad1966fbeee5c7e1923a4e567b5bcd77d">ops</a> = &amp;<a name="a41"></a><a class="code" href="rte__table__hash_8h.html#ad0c1c0da2ab6107aeb9d7e865f3dff96">rte_table_hash_key8_ext_dosig_ops</a>,</div>
<div class="line">            .arg_create = &amp;table_arp_params,</div>
<div class="line">            .f_action_hit = get_arp_table_ah_hit(p_rt),</div>
<div class="line">            .f_action_miss = NULL,</div>
<div class="line">            .arg_ah = p_rt,</div>
<div class="line">            .action_data_size = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>arp_table_entry) -</div>
<div class="line">                sizeof(struct <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a>),</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">        status = <a class="code" href="rte__pipeline_8h.html#af1cb4d7ac4516443e6f9d82a4beebed6">rte_pipeline_table_create</a>(p-&gt;p,</div>
<div class="line">            &amp;table_params,</div>
<div class="line">            &amp;p-&gt;table_id[1]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            <a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        p-&gt;n_tables++;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Connecting input ports to tables */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;n_ports_in; i++) {</div>
<div class="line">        <span class="keywordtype">int</span> status = <a name="a42"></a><a class="code" href="rte__pipeline_8h.html#adc4634b81c75f146f3afac17dbbe727c">rte_pipeline_port_in_connect_to_table</a>(p-&gt;p,</div>
<div class="line">            p-&gt;port_in_id[i],</div>
<div class="line">            p-&gt;table_id[0]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            <a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Enable input ports */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;n_ports_in; i++) {</div>
<div class="line">        <span class="keywordtype">int</span> status = <a name="a43"></a><a class="code" href="rte__pipeline_8h.html#af8a48f99a99731883005dfe93c5406e6">rte_pipeline_port_in_enable</a>(p-&gt;p,</div>
<div class="line">            p-&gt;port_in_id[i]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            <a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">            <span class="keywordflow">return</span> NULL;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check pipeline consistency */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a name="a44"></a><a class="code" href="rte__pipeline_8h.html#ada72ecd95a1a181d1d555dd699f95475">rte_pipeline_check</a>(p-&gt;p) &lt; 0) {</div>
<div class="line">        <a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Message queues */</span></div>
<div class="line">    p-&gt;n_msgq = params-&gt;n_msgq;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; p-&gt;n_msgq; i++)</div>
<div class="line">        p-&gt;msgq_in[i] = params-&gt;msgq_in[i];</div>
<div class="line">    for (i = 0; i &lt; p-&gt;n_msgq; i++)</div>
<div class="line">        p-&gt;msgq_out[i] = params-&gt;msgq_out[i];</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Message handlers */</span></div>
<div class="line">    memcpy(p-&gt;handlers, handlers, <span class="keyword">sizeof</span>(p-&gt;handlers));</div>
<div class="line">    memcpy(p_rt-&gt;custom_handlers,</div>
<div class="line">        custom_handlers,</div>
<div class="line">        <span class="keyword">sizeof</span>(p_rt-&gt;custom_handlers));</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> p;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">pipeline_routing_free(<span class="keywordtype">void</span> *pipeline)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p = (<span class="keyword">struct </span>pipeline *) pipeline;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Free resources */</span></div>
<div class="line">    <a class="code" href="rte__pipeline_8h.html#a85ce2e4661092748a84409a1d6eae14c">rte_pipeline_free</a>(p-&gt;p);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">pipeline_routing_track(<span class="keywordtype">void</span> *pipeline,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> uint32_t port_in,</div>
<div class="line">    uint32_t *port_out)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p = (<span class="keyword">struct </span>pipeline *) pipeline;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((p == NULL) ||</div>
<div class="line">        (port_in &gt;= p-&gt;n_ports_in) ||</div>
<div class="line">        (port_out == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;n_ports_in == 1) {</div>
<div class="line">        *port_out = 0;</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">pipeline_routing_timer(<span class="keywordtype">void</span> *pipeline)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline *p = (<span class="keyword">struct </span>pipeline *) pipeline;</div>
<div class="line"></div>
<div class="line">    pipeline_msg_req_handle(p);</div>
<div class="line">    <a name="a45"></a><a class="code" href="rte__pipeline_8h.html#ac26447a6b0c4b1ec218a9133d790fef1">rte_pipeline_flush</a>(p-&gt;p);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_custom_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing *p_rt = (<span class="keyword">struct </span>pipeline_routing *) p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_custom_msg_req *req = msg;</div>
<div class="line">    pipeline_msg_req_handler f_handle;</div>
<div class="line"></div>
<div class="line">    f_handle = (req-&gt;subtype &lt; PIPELINE_ROUTING_MSG_REQS) ?</div>
<div class="line">        p_rt-&gt;custom_handlers[req-&gt;subtype] :</div>
<div class="line">        pipeline_msg_req_invalid_handler;</div>
<div class="line"></div>
<div class="line">    if (f_handle == NULL)</div>
<div class="line">        f_handle = pipeline_msg_req_invalid_handler;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> f_handle(p, req);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_add_handler(<span class="keyword">struct</span> pipeline *p, <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing *p_rt = (<span class="keyword">struct </span>pipeline_routing *) p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_route_add_msg_req *req = msg;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_route_add_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span><a name="_a46"></a><a class="code" href="structrte__table__lpm__key.html">rte_table_lpm_key</a> key = {</div>
<div class="line">        .<a name="a47"></a><a class="code" href="structrte__table__lpm__key.html#a69ddb9c845da426f636d9dd0dbed4e7e">ip</a> = req-&gt;key.key.ipv4.ip,</div>
<div class="line">        .depth = req-&gt;key.key.ipv4.depth,</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry entry_arp0 = {</div>
<div class="line">        .head = {</div>
<div class="line">            .action = <a name="a48"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>,</div>
<div class="line">            {.port_id = p-&gt;port_out_id[req-&gt;data.port_id]},</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        .flags = req-&gt;data.flags,</div>
<div class="line">        .port_id = req-&gt;data.port_id,</div>
<div class="line">        .ip = 0,</div>
<div class="line">        .data_offset = 0,</div>
<div class="line">        .ether_l2_length = 0,</div>
<div class="line">        .slab = {0},</div>
<div class="line">        .slab_offset = {0},</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry entry_arp1 = {</div>
<div class="line">        .head = {</div>
<div class="line">            .action = <a name="a49"></a><a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572abafaf6276afcfcb170a2f7aa44c21048">RTE_PIPELINE_ACTION_TABLE</a>,</div>
<div class="line">            {.table_id = p-&gt;table_id[1]},</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        .flags = req-&gt;data.flags,</div>
<div class="line">        .port_id = req-&gt;data.port_id,</div>
<div class="line">        .ip = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(req-&gt;data.ethernet.ip),</div>
<div class="line">        .data_offset = 0,</div>
<div class="line">        .ether_l2_length = 0,</div>
<div class="line">        .slab = {0},</div>
<div class="line">        .slab_offset = {0},</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *entry = (p_rt-&gt;params.n_arp_entries) ?</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *) &amp;entry_arp1 :</div>
<div class="line">        (<span class="keyword">struct </span><a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *) &amp;entry_arp0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((req-&gt;key.type != PIPELINE_ROUTING_ROUTE_IPV4) ||</div>
<div class="line">        ((p_rt-&gt;params.n_arp_entries == 0) &amp;&amp;</div>
<div class="line">            (req-&gt;data.flags &amp; PIPELINE_ROUTING_ROUTE_ARP)) ||</div>
<div class="line">        (p_rt-&gt;params.n_arp_entries &amp;&amp;</div>
<div class="line">            ((req-&gt;data.flags &amp; PIPELINE_ROUTING_ROUTE_ARP) == 0)) ||</div>
<div class="line">        ((p_rt-&gt;params.encap != PIPELINE_ROUTING_ENCAP_ETHERNET_QINQ) &amp;&amp;</div>
<div class="line">            (req-&gt;data.flags &amp; PIPELINE_ROUTING_ROUTE_QINQ)) ||</div>
<div class="line">        ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET_QINQ) &amp;&amp;</div>
<div class="line">            ((req-&gt;data.flags &amp; PIPELINE_ROUTING_ROUTE_QINQ) == 0)) ||</div>
<div class="line">        ((p_rt-&gt;params.encap != PIPELINE_ROUTING_ENCAP_ETHERNET_MPLS) &amp;&amp;</div>
<div class="line">            (req-&gt;data.flags &amp; PIPELINE_ROUTING_ROUTE_MPLS)) ||</div>
<div class="line">        ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET_MPLS) &amp;&amp;</div>
<div class="line">            ((req-&gt;data.flags &amp; PIPELINE_ROUTING_ROUTE_MPLS) == 0))) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Ether - ARP off */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET) &amp;&amp;</div>
<div class="line">        (p_rt-&gt;params.n_arp_entries == 0)) {</div>
<div class="line">        uint64_t macaddr_src = MAC_SRC_DEFAULT;</div>
<div class="line">        uint64_t macaddr_dst;</div>
<div class="line">        uint64_t ethertype = <a name="a50"></a><a class="code" href="rte__ether_8h.html#a08cc3337f1584270c6f9de9bffd14b2b">ETHER_TYPE_IPv4</a>;</div>
<div class="line"></div>
<div class="line">        macaddr_dst = *((uint64_t *)&amp;(req-&gt;data.ethernet.macaddr));</div>
<div class="line">        macaddr_dst = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(macaddr_dst &lt;&lt; 16);</div>
<div class="line"></div>
<div class="line">        entry_arp0.slab[0] =</div>
<div class="line">            <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((macaddr_src &lt;&lt; 16) | ethertype);</div>
<div class="line">        entry_arp0.slab_offset[0] = p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">        entry_arp0.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(macaddr_dst);</div>
<div class="line">        entry_arp0.slab_offset[1] = p_rt-&gt;params.ip_hdr_offset - 2 * 8;</div>
<div class="line"></div>
<div class="line">        entry_arp0.data_offset = entry_arp0.slab_offset[1] + 2</div>
<div class="line">            - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a>);</div>
<div class="line">        entry_arp0.ether_l2_length = 14;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Ether - ARP on */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET) &amp;&amp;</div>
<div class="line">        p_rt-&gt;params.n_arp_entries) {</div>
<div class="line">        uint64_t macaddr_src = MAC_SRC_DEFAULT;</div>
<div class="line">        uint64_t ethertype = <a class="code" href="rte__ether_8h.html#a08cc3337f1584270c6f9de9bffd14b2b">ETHER_TYPE_IPv4</a>;</div>
<div class="line"></div>
<div class="line">        entry_arp1.slab[0] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((macaddr_src &lt;&lt; 16) |</div>
<div class="line">            ethertype);</div>
<div class="line">        entry_arp1.slab_offset[0] = p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">        entry_arp1.data_offset = entry_arp1.slab_offset[0] - 6</div>
<div class="line">            - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a>);</div>
<div class="line">        entry_arp1.ether_l2_length = 14;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Ether QinQ - ARP off */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET_QINQ) &amp;&amp;</div>
<div class="line">        (p_rt-&gt;params.n_arp_entries == 0)) {</div>
<div class="line">        uint64_t macaddr_src = MAC_SRC_DEFAULT;</div>
<div class="line">        uint64_t macaddr_dst;</div>
<div class="line">        uint64_t ethertype_ipv4 = <a class="code" href="rte__ether_8h.html#a08cc3337f1584270c6f9de9bffd14b2b">ETHER_TYPE_IPv4</a>;</div>
<div class="line">        uint64_t ethertype_vlan = 0x8100;</div>
<div class="line">        uint64_t ethertype_qinq = 0x9100;</div>
<div class="line">        uint64_t svlan = req-&gt;data.l2.qinq.svlan;</div>
<div class="line">        uint64_t cvlan = req-&gt;data.l2.qinq.cvlan;</div>
<div class="line"></div>
<div class="line">        macaddr_dst = *((uint64_t *)&amp;(req-&gt;data.ethernet.macaddr));</div>
<div class="line">        macaddr_dst = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(macaddr_dst &lt;&lt; 16);</div>
<div class="line"></div>
<div class="line">        entry_arp0.slab[0] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((svlan &lt;&lt; 48) |</div>
<div class="line">            (ethertype_vlan &lt;&lt; 32) |</div>
<div class="line">            (cvlan &lt;&lt; 16) |</div>
<div class="line">            ethertype_ipv4);</div>
<div class="line">        entry_arp0.slab_offset[0] = p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">        entry_arp0.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((macaddr_src &lt;&lt; 16) |</div>
<div class="line">            ethertype_qinq);</div>
<div class="line">        entry_arp0.slab_offset[1] = p_rt-&gt;params.ip_hdr_offset - 2 * 8;</div>
<div class="line"></div>
<div class="line">        entry_arp0.slab[2] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(macaddr_dst);</div>
<div class="line">        entry_arp0.slab_offset[2] = p_rt-&gt;params.ip_hdr_offset - 3 * 8;</div>
<div class="line"></div>
<div class="line">        entry_arp0.data_offset = entry_arp0.slab_offset[2] + 2</div>
<div class="line">            - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a>);</div>
<div class="line">        entry_arp0.ether_l2_length = 22;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Ether QinQ - ARP on */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET_QINQ) &amp;&amp;</div>
<div class="line">        p_rt-&gt;params.n_arp_entries) {</div>
<div class="line">        uint64_t macaddr_src = MAC_SRC_DEFAULT;</div>
<div class="line">        uint64_t ethertype_ipv4 = <a class="code" href="rte__ether_8h.html#a08cc3337f1584270c6f9de9bffd14b2b">ETHER_TYPE_IPv4</a>;</div>
<div class="line">        uint64_t ethertype_vlan = 0x8100;</div>
<div class="line">        uint64_t ethertype_qinq = 0x9100;</div>
<div class="line">        uint64_t svlan = req-&gt;data.l2.qinq.svlan;</div>
<div class="line">        uint64_t cvlan = req-&gt;data.l2.qinq.cvlan;</div>
<div class="line"></div>
<div class="line">        entry_arp1.slab[0] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((svlan &lt;&lt; 48) |</div>
<div class="line">            (ethertype_vlan &lt;&lt; 32) |</div>
<div class="line">            (cvlan &lt;&lt; 16) |</div>
<div class="line">            ethertype_ipv4);</div>
<div class="line">        entry_arp1.slab_offset[0] = p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">        entry_arp1.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((macaddr_src &lt;&lt; 16) |</div>
<div class="line">            ethertype_qinq);</div>
<div class="line">        entry_arp1.slab_offset[1] = p_rt-&gt;params.ip_hdr_offset - 2 * 8;</div>
<div class="line"></div>
<div class="line">        entry_arp1.data_offset = entry_arp1.slab_offset[1] - 6</div>
<div class="line">            - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a>);</div>
<div class="line">        entry_arp1.ether_l2_length = 22;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Ether MPLS - ARP off */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET_MPLS) &amp;&amp;</div>
<div class="line">        (p_rt-&gt;params.n_arp_entries == 0)) {</div>
<div class="line">        uint64_t macaddr_src = MAC_SRC_DEFAULT;</div>
<div class="line">        uint64_t macaddr_dst;</div>
<div class="line">        uint64_t ethertype_mpls = 0x8847;</div>
<div class="line"></div>
<div class="line">        uint64_t label0 = req-&gt;data.l2.mpls.labels[0];</div>
<div class="line">        uint64_t label1 = req-&gt;data.l2.mpls.labels[1];</div>
<div class="line">        uint64_t label2 = req-&gt;data.l2.mpls.labels[2];</div>
<div class="line">        uint64_t label3 = req-&gt;data.l2.mpls.labels[3];</div>
<div class="line">        uint32_t n_labels = req-&gt;data.l2.mpls.n_labels;</div>
<div class="line"></div>
<div class="line">        macaddr_dst = *((uint64_t *)&amp;(req-&gt;data.ethernet.macaddr));</div>
<div class="line">        macaddr_dst = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(macaddr_dst &lt;&lt; 16);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span> (n_labels) {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            entry_arp0.slab[0] = 0;</div>
<div class="line">            entry_arp0.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp0.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                MPLS_LABEL(label0, 0, 1, 0));</div>
<div class="line">            entry_arp0.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            entry_arp0.slab[0] = 0;</div>
<div class="line">            entry_arp0.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp0.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label0, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label1, 0, 1, 0));</div>
<div class="line">            entry_arp0.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">            entry_arp0.slab[0] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label1, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label2, 0, 1, 0));</div>
<div class="line">            entry_arp0.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp0.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                MPLS_LABEL(label0, 0, 0, 0));</div>
<div class="line">            entry_arp0.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 2 * 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> 4:</div>
<div class="line">            entry_arp0.slab[0] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label2, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label3, 0, 1, 0));</div>
<div class="line">            entry_arp0.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp0.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label0, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label1, 0, 0, 0));</div>
<div class="line">            entry_arp0.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 2 * 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            rsp-&gt;status = -1;</div>
<div class="line">            <span class="keywordflow">return</span> rsp;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        entry_arp0.slab[2] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((macaddr_src &lt;&lt; 16) |</div>
<div class="line">            ethertype_mpls);</div>
<div class="line">        entry_arp0.slab_offset[2] = p_rt-&gt;params.ip_hdr_offset -</div>
<div class="line">            (n_labels * 4 + 8);</div>
<div class="line"></div>
<div class="line">        entry_arp0.slab[3] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(macaddr_dst);</div>
<div class="line">        entry_arp0.slab_offset[3] = p_rt-&gt;params.ip_hdr_offset -</div>
<div class="line">            (n_labels * 4 + 2 * 8);</div>
<div class="line"></div>
<div class="line">        entry_arp0.data_offset = entry_arp0.slab_offset[3] + 2</div>
<div class="line">            - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a>);</div>
<div class="line">        entry_arp0.ether_l2_length = n_labels * 4 + 14;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Ether MPLS - ARP on */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((p_rt-&gt;params.encap == PIPELINE_ROUTING_ENCAP_ETHERNET_MPLS) &amp;&amp;</div>
<div class="line">        p_rt-&gt;params.n_arp_entries) {</div>
<div class="line">        uint64_t macaddr_src = MAC_SRC_DEFAULT;</div>
<div class="line">        uint64_t ethertype_mpls = 0x8847;</div>
<div class="line"></div>
<div class="line">        uint64_t label0 = req-&gt;data.l2.mpls.labels[0];</div>
<div class="line">        uint64_t label1 = req-&gt;data.l2.mpls.labels[1];</div>
<div class="line">        uint64_t label2 = req-&gt;data.l2.mpls.labels[2];</div>
<div class="line">        uint64_t label3 = req-&gt;data.l2.mpls.labels[3];</div>
<div class="line">        uint32_t n_labels = req-&gt;data.l2.mpls.n_labels;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span> (n_labels) {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            entry_arp1.slab[0] = 0;</div>
<div class="line">            entry_arp1.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp1.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                MPLS_LABEL(label0, 0, 1, 0));</div>
<div class="line">            entry_arp1.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">            entry_arp1.slab[0] = 0;</div>
<div class="line">            entry_arp1.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp1.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label0, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label1, 0, 1, 0));</div>
<div class="line">            entry_arp1.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">            entry_arp1.slab[0] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label1, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label2, 0, 1, 0));</div>
<div class="line">            entry_arp1.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp1.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                MPLS_LABEL(label0, 0, 0, 0));</div>
<div class="line">            entry_arp1.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 2 * 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">case</span> 4:</div>
<div class="line">            entry_arp1.slab[0] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label2, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label3, 0, 1, 0));</div>
<div class="line">            entry_arp1.slab_offset[0] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 8;</div>
<div class="line"></div>
<div class="line">            entry_arp1.slab[1] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>(</div>
<div class="line">                (MPLS_LABEL(label0, 0, 0, 0) &lt;&lt; 32) |</div>
<div class="line">                MPLS_LABEL(label1, 0, 0, 0));</div>
<div class="line">            entry_arp1.slab_offset[1] =</div>
<div class="line">                p_rt-&gt;params.ip_hdr_offset - 2 * 8;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            rsp-&gt;status = -1;</div>
<div class="line">            <span class="keywordflow">return</span> rsp;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        entry_arp1.slab[2] = <a class="code" href="rte__byteorder_8h.html#a2c05e54d6949236eb71a71e3e853b1b6">rte_bswap64</a>((macaddr_src &lt;&lt; 16) |</div>
<div class="line">            ethertype_mpls);</div>
<div class="line">        entry_arp1.slab_offset[2] = p_rt-&gt;params.ip_hdr_offset -</div>
<div class="line">            (n_labels * 4 + 8);</div>
<div class="line"></div>
<div class="line">        entry_arp1.data_offset = entry_arp1.slab_offset[2] - 6</div>
<div class="line">            - <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structrte__mbuf.html">rte_mbuf</a>);</div>
<div class="line">        entry_arp1.ether_l2_length = n_labels * 4 + 14;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a name="a51"></a><a class="code" href="rte__pipeline_8h.html#a0e90e4a54b6467deb9b449bf8bd5cab4">rte_pipeline_table_entry_add</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[0],</div>
<div class="line">        &amp;key,</div>
<div class="line">        entry,</div>
<div class="line">        &amp;rsp-&gt;key_found,</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **) &amp;rsp-&gt;entry_ptr);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_del_handler(<span class="keyword">struct</span> pipeline *p, <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_route_delete_msg_req *req = msg;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_route_delete_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structrte__table__lpm__key.html">rte_table_lpm_key</a> key = {</div>
<div class="line">        .<a class="code" href="structrte__table__lpm__key.html#a69ddb9c845da426f636d9dd0dbed4e7e">ip</a> = req-&gt;key.key.ipv4.ip,</div>
<div class="line">        .depth = req-&gt;key.key.ipv4.depth,</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (req-&gt;key.type != PIPELINE_ROUTING_ROUTE_IPV4) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a name="a52"></a><a class="code" href="rte__pipeline_8h.html#a946f0d5610d152c1e6f641928c4f0743">rte_pipeline_table_entry_delete</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[0],</div>
<div class="line">        &amp;key,</div>
<div class="line">        &amp;rsp-&gt;key_found,</div>
<div class="line">        NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_add_default_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_route_add_default_msg_req *req = msg;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_route_add_default_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>routing_table_entry default_entry = {</div>
<div class="line">        .head = {</div>
<div class="line">            .action = <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>,</div>
<div class="line">            {.port_id = p-&gt;port_out_id[req-&gt;port_id]},</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        .flags = 0,</div>
<div class="line">        .port_id = 0,</div>
<div class="line">        .ip = 0,</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a name="a53"></a><a class="code" href="rte__pipeline_8h.html#a8980fbc2a51d6dc8041b798ea5172318">rte_pipeline_table_default_entry_add</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[0],</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *) &amp;default_entry,</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **) &amp;rsp-&gt;entry_ptr);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_route_del_default_handler(<span class="keyword">struct</span> pipeline *p,</div>
<div class="line">    <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_route_delete_default_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a name="a54"></a><a class="code" href="rte__pipeline_8h.html#ac83e9cacb91301a7425694f32249e050">rte_pipeline_table_default_entry_delete</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[0],</div>
<div class="line">        NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_add_handler(<span class="keyword">struct</span> pipeline *p, <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_add_msg_req *req = msg;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_add_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 key = {</div>
<div class="line">        .port_id = req-&gt;key.key.ipv4.port_id,</div>
<div class="line">        .<a class="code" href="structrte__table__lpm__key.html#a69ddb9c845da426f636d9dd0dbed4e7e">ip</a> = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(req-&gt;key.key.ipv4.ip),</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>arp_table_entry entry = {</div>
<div class="line">        .head = {</div>
<div class="line">            .<a name="a55"></a><a class="code" href="structrte__pipeline__table__entry.html#ab65480a4c6171d9ea813e0b1be3afef2">action</a> = <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>,</div>
<div class="line">            {.port_id = p-&gt;port_out_id[req-&gt;key.key.ipv4.port_id]},</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        .macaddr = 0, <span class="comment">/* set below */</span></div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (req-&gt;key.type != PIPELINE_ROUTING_ARP_IPV4) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    entry.macaddr = *((uint64_t *)&amp;(req-&gt;macaddr));</div>
<div class="line">    entry.macaddr = entry.macaddr &lt;&lt; 16;</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#a0e90e4a54b6467deb9b449bf8bd5cab4">rte_pipeline_table_entry_add</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[1],</div>
<div class="line">        &amp;key,</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *) &amp;entry,</div>
<div class="line">        &amp;rsp-&gt;key_found,</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **) &amp;rsp-&gt;entry_ptr);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_del_handler(<span class="keyword">struct</span> pipeline *p, <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_delete_msg_req *req = msg;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_delete_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_key_ipv4 key = {</div>
<div class="line">        .port_id = req-&gt;key.key.ipv4.port_id,</div>
<div class="line">        .ip = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(req-&gt;key.key.ipv4.ip),</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (req-&gt;key.type != PIPELINE_ROUTING_ARP_IPV4) {</div>
<div class="line">        rsp-&gt;status = -1;</div>
<div class="line">        <span class="keywordflow">return</span> rsp;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#a946f0d5610d152c1e6f641928c4f0743">rte_pipeline_table_entry_delete</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[1],</div>
<div class="line">        &amp;key,</div>
<div class="line">        &amp;rsp-&gt;key_found,</div>
<div class="line">        NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_add_default_handler(<span class="keyword">struct</span> pipeline *p, <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_add_default_msg_req *req = msg;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_add_default_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>arp_table_entry default_entry = {</div>
<div class="line">        .head = {</div>
<div class="line">            .action = <a class="code" href="rte__pipeline_8h.html#a6376b240935404d998f003d113651572ac8c58609785d844989b7d9eb1e6db8aa">RTE_PIPELINE_ACTION_PORT</a>,</div>
<div class="line">            {.port_id = p-&gt;port_out_id[req-&gt;port_id]},</div>
<div class="line">        },</div>
<div class="line"></div>
<div class="line">        .macaddr = 0,</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#a8980fbc2a51d6dc8041b798ea5172318">rte_pipeline_table_default_entry_add</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[1],</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> *) &amp;default_entry,</div>
<div class="line">        (<span class="keyword">struct</span> <a class="code" href="structrte__pipeline__table__entry.html">rte_pipeline_table_entry</a> **) &amp;rsp-&gt;entry_ptr);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> *</div>
<div class="line">pipeline_routing_msg_req_arp_del_default_handler(<span class="keyword">struct</span> pipeline *p, <span class="keywordtype">void</span> *msg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pipeline_routing_arp_delete_default_msg_rsp *rsp = msg;</div>
<div class="line"></div>
<div class="line">    rsp-&gt;status = <a class="code" href="rte__pipeline_8h.html#ac83e9cacb91301a7425694f32249e050">rte_pipeline_table_default_entry_delete</a>(p-&gt;p,</div>
<div class="line">        p-&gt;table_id[1],</div>
<div class="line">        NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> rsp;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>pipeline_be_ops pipeline_routing_be_ops = {</div>
<div class="line">    .f_init = pipeline_routing_init,</div>
<div class="line">    .f_free = pipeline_routing_free,</div>
<div class="line">    .f_run = NULL,</div>
<div class="line">    .f_timer = pipeline_routing_timer,</div>
<div class="line">    .f_track = pipeline_routing_track,</div>
<div class="line">};</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>

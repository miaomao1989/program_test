<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DPDK: load_balancer/config.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">16.04.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">load_balancer/config.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*-</span></div>
<div class="line"><span class="comment"> *   BSD LICENSE</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Copyright(c) 2010-2014 Intel Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *   All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment"> *   modification, are permitted provided that the following conditions</span></div>
<div class="line"><span class="comment"> *   are met:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment"> *     * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer in</span></div>
<div class="line"><span class="comment"> *       the documentation and/or other materials provided with the</span></div>
<div class="line"><span class="comment"> *       distribution.</span></div>
<div class="line"><span class="comment"> *     * Neither the name of Intel Corporation nor the names of its</span></div>
<div class="line"><span class="comment"> *       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment"> *       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment"> *   &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment"> *   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment"> *   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment"> *   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment"> *   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment"> *   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment"> *   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment"> *   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/queue.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__byteorder_8h.html">rte_byteorder.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__log_8h.html">rte_log.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__memory_8h.html">rte_memory.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__memcpy_8h.html">rte_memcpy.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__memzone_8h.html">rte_memzone.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__eal_8h.html">rte_eal.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__per__lcore_8h.html">rte_per_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__launch_8h.html">rte_launch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__atomic_8h.html">rte_atomic.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__cycles_8h.html">rte_cycles.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__prefetch_8h.html">rte_prefetch.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lcore_8h.html">rte_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__per__lcore_8h.html">rte_per_lcore.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__branch__prediction_8h.html">rte_branch_prediction.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__interrupts_8h.html">rte_interrupts.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__pci_8h.html">rte_pci.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__random_8h.html">rte_random.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__debug_8h.html">rte_debug.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ether_8h.html">rte_ether.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ethdev_8h.html">rte_ethdev.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ring_8h.html">rte_ring.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mempool_8h.html">rte_mempool.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__mbuf_8h.html">rte_mbuf.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__ip_8h.html">rte_ip.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__tcp_8h.html">rte_tcp.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__lpm_8h.html">rte_lpm.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__string__fns_8h.html">rte_string_fns.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;main.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>app_params app;</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> usage[] =</div>
<div class="line"><span class="stringliteral">&quot;                                                                               \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    load_balancer &lt;EAL PARAMS&gt; -- &lt;APP PARAMS&gt;                                 \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;                                                                               \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;Application manadatory parameters:                                             \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    --rx \&quot;(PORT, QUEUE, LCORE), ...\&quot; : List of NIC RX ports and queues       \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           handled by the I/O RX lcores                                        \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    --tx \&quot;(PORT, LCORE), ...\&quot; : List of NIC TX ports handled by the I/O TX   \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           lcores                                                              \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    --w \&quot;LCORE, ...\&quot; : List of the worker lcores                             \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    --lpm \&quot;IP / PREFIX =&gt; PORT; ...\&quot; : List of LPM rules used by the worker  \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           lcores for packet forwarding                                        \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;                                                                               \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;Application optional parameters:                                               \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    --rsz \&quot;A, B, C, D\&quot; : Ring sizes                                          \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           A = Size (in number of buffer descriptors) of each of the NIC RX    \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               rings read by the I/O RX lcores (default value is %u)           \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           B = Size (in number of elements) of each of the SW rings used by the\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               I/O RX lcores to send packets to worker lcores (default value is\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               %u)                                                             \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           C = Size (in number of elements) of each of the SW rings used by the\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               worker lcores to send packets to I/O TX lcores (default value is\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               %u)                                                             \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           D = Size (in number of buffer descriptors) of each of the NIC TX    \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               rings written by I/O TX lcores (default value is %u)            \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    --bsz \&quot;(A, B), (C, D), (E, F)\&quot; :  Burst sizes                            \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           A = I/O RX lcore read burst size from NIC RX (default value is %u)  \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           B = I/O RX lcore write burst size to output SW rings (default value \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               is %u)                                                          \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           C = Worker lcore read burst size from input SW rings (default value \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               is %u)                                                          \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           D = Worker lcore write burst size to output SW rings (default value \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               is %u)                                                          \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           E = I/O TX lcore read burst size from input SW rings (default value \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;               is %u)                                                          \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           F = I/O TX lcore write burst size to NIC TX (default value is %u)   \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;    --pos-lb POS : Position of the 1-byte field within the input packet used by\n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           the I/O RX lcores to identify the worker lcore for the current      \n&quot;</span></div>
<div class="line"><span class="stringliteral">&quot;           packet (default value is %u)                                        \n&quot;</span>;</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">app_print_usage(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    printf(usage,</div>
<div class="line">        APP_DEFAULT_NIC_RX_RING_SIZE,</div>
<div class="line">        APP_DEFAULT_RING_RX_SIZE,</div>
<div class="line">        APP_DEFAULT_RING_TX_SIZE,</div>
<div class="line">        APP_DEFAULT_NIC_TX_RING_SIZE,</div>
<div class="line">        APP_DEFAULT_BURST_SIZE_IO_RX_READ,</div>
<div class="line">        APP_DEFAULT_BURST_SIZE_IO_RX_WRITE,</div>
<div class="line">        APP_DEFAULT_BURST_SIZE_WORKER_READ,</div>
<div class="line">        APP_DEFAULT_BURST_SIZE_WORKER_WRITE,</div>
<div class="line">        APP_DEFAULT_BURST_SIZE_IO_TX_READ,</div>
<div class="line">        APP_DEFAULT_BURST_SIZE_IO_TX_WRITE,</div>
<div class="line">        APP_DEFAULT_IO_RX_LB_POS</div>
<div class="line">    );</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_RX_MAX_CHARS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_RX_MAX_CHARS     4096</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_RX_MAX_TUPLES</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_RX_MAX_TUPLES    128</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">str_to_unsigned_array(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">size_t</span> sbuflen,</div>
<div class="line">    <span class="keywordtype">char</span> separator,</div>
<div class="line">    <span class="keywordtype">unsigned</span> num_vals,</div>
<div class="line">    <span class="keywordtype">unsigned</span> *vals)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> str[sbuflen+1];</div>
<div class="line">    <span class="keywordtype">char</span> *splits[num_vals];</div>
<div class="line">    <span class="keywordtype">char</span> *endptr = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> i, num_splits = 0;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* copy s so we don&#39;t modify original string */</span></div>
<div class="line">    snprintf(str, <span class="keyword">sizeof</span>(str), <span class="stringliteral">&quot;%s&quot;</span>, s);</div>
<div class="line">    num_splits = <a name="a0"></a><a class="code" href="rte__string__fns_8h.html#af3ffc4e2ca821bc44f7fd08afbfe3638">rte_strsplit</a>(str, <span class="keyword">sizeof</span>(str), splits, num_vals, separator);</div>
<div class="line"></div>
<div class="line">    errno = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; num_splits; i++) {</div>
<div class="line">        vals[i] = strtoul(splits[i], &amp;endptr, 0);</div>
<div class="line">        <span class="keywordflow">if</span> (errno != 0 || *endptr != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> num_splits;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">str_to_unsigned_vals(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *s,</div>
<div class="line">    <span class="keywordtype">size_t</span> sbuflen,</div>
<div class="line">    <span class="keywordtype">char</span> separator,</div>
<div class="line">    <span class="keywordtype">unsigned</span> num_vals, ...)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> i, vals[num_vals];</div>
<div class="line">    va_list ap;</div>
<div class="line"></div>
<div class="line">    num_vals = str_to_unsigned_array(s, sbuflen, separator, num_vals, vals);</div>
<div class="line"></div>
<div class="line">    va_start(ap, num_vals);</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; num_vals; i++) {</div>
<div class="line">        <span class="keywordtype">unsigned</span> *u = va_arg(ap, <span class="keywordtype">unsigned</span> *);</div>
<div class="line">        *u = vals[i];</div>
<div class="line">    }</div>
<div class="line">    va_end(ap);</div>
<div class="line">    <span class="keywordflow">return</span> num_vals;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_arg_rx(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *p0 = arg, *p = arg;</div>
<div class="line">    uint32_t n_tuples;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (strnlen(arg, APP_ARG_RX_MAX_CHARS + 1) == APP_ARG_RX_MAX_CHARS + 1) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    n_tuples = 0;</div>
<div class="line">    <span class="keywordflow">while</span> ((p = strchr(p0,<span class="charliteral">&#39;(&#39;</span>)) != NULL) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params *lp;</div>
<div class="line">        uint32_t <a name="_a1"></a><a class="code" href="structport.html">port</a>, queue, lcore, i;</div>
<div class="line"></div>
<div class="line">        p0 = strchr(p++, <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((p0 == NULL) ||</div>
<div class="line">            (str_to_unsigned_vals(p, p0 - p, <span class="charliteral">&#39;,&#39;</span>, 3, &amp;port, &amp;queue, &amp;lcore) !=  3)) {</div>
<div class="line">            <span class="keywordflow">return</span> -2;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Enable port and queue for later initialization */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((port &gt;= APP_MAX_NIC_PORTS) || (queue &gt;= APP_MAX_RX_QUEUES_PER_NIC_PORT)) {</div>
<div class="line">            <span class="keywordflow">return</span> -3;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (app.nic_rx_queue_mask[port][queue] != 0) {</div>
<div class="line">            <span class="keywordflow">return</span> -4;</div>
<div class="line">        }</div>
<div class="line">        app.nic_rx_queue_mask[port][queue] = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check and assign (port, queue) to I/O lcore */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a2"></a><a class="code" href="rte__lcore_8h.html#a076d17802fafc1fb54e168cc37c94c60">rte_lcore_is_enabled</a>(lcore) == 0) {</div>
<div class="line">            <span class="keywordflow">return</span> -5;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (lcore &gt;= APP_MAX_LCORES) {</div>
<div class="line">            <span class="keywordflow">return</span> -6;</div>
<div class="line">        }</div>
<div class="line">        lp = &amp;app.lcore_params[lcore];</div>
<div class="line">        <span class="keywordflow">if</span> (lp-&gt;type == e_APP_LCORE_WORKER) {</div>
<div class="line">            <span class="keywordflow">return</span> -7;</div>
<div class="line">        }</div>
<div class="line">        lp-&gt;type = e_APP_LCORE_IO;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n_queues = <a name="a3"></a><a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(lp-&gt;io.rx.n_nic_queues,</div>
<div class="line">                                        <a name="a4"></a><a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(lp-&gt;io.rx.nic_queues));</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n_queues; i ++) {</div>
<div class="line">            <span class="keywordflow">if</span> ((lp-&gt;io.rx.nic_queues[i].port == port) &amp;&amp;</div>
<div class="line">                (lp-&gt;io.rx.nic_queues[i].queue == queue)) {</div>
<div class="line">                <span class="keywordflow">return</span> -8;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (lp-&gt;io.rx.n_nic_queues &gt;= APP_MAX_NIC_RX_QUEUES_PER_IO_LCORE) {</div>
<div class="line">            <span class="keywordflow">return</span> -9;</div>
<div class="line">        }</div>
<div class="line">        lp-&gt;io.rx.nic_queues[lp-&gt;io.rx.n_nic_queues].port = (uint8_t) port;</div>
<div class="line">        lp-&gt;io.rx.nic_queues[lp-&gt;io.rx.n_nic_queues].queue = (uint8_t) queue;</div>
<div class="line">        lp-&gt;io.rx.n_nic_queues ++;</div>
<div class="line"></div>
<div class="line">        n_tuples ++;</div>
<div class="line">        <span class="keywordflow">if</span> (n_tuples &gt; APP_ARG_RX_MAX_TUPLES) {</div>
<div class="line">            <span class="keywordflow">return</span> -10;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (n_tuples == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> -11;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_TX_MAX_CHARS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_TX_MAX_CHARS     4096</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_TX_MAX_TUPLES</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_TX_MAX_TUPLES    128</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_arg_tx(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *p0 = arg, *p = arg;</div>
<div class="line">    uint32_t n_tuples;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (strnlen(arg, APP_ARG_TX_MAX_CHARS + 1) == APP_ARG_TX_MAX_CHARS + 1) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    n_tuples = 0;</div>
<div class="line">    <span class="keywordflow">while</span> ((p = strchr(p0,<span class="charliteral">&#39;(&#39;</span>)) != NULL) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params *lp;</div>
<div class="line">        uint32_t port, lcore, i;</div>
<div class="line"></div>
<div class="line">        p0 = strchr(p++, <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((p0 == NULL) ||</div>
<div class="line">            (str_to_unsigned_vals(p, p0 - p, <span class="charliteral">&#39;,&#39;</span>, 2, &amp;port, &amp;lcore) !=  2)) {</div>
<div class="line">            <span class="keywordflow">return</span> -2;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Enable port and queue for later initialization */</span></div>
<div class="line">        <span class="keywordflow">if</span> (port &gt;= APP_MAX_NIC_PORTS) {</div>
<div class="line">            <span class="keywordflow">return</span> -3;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (app.nic_tx_port_mask[port] != 0) {</div>
<div class="line">            <span class="keywordflow">return</span> -4;</div>
<div class="line">        }</div>
<div class="line">        app.nic_tx_port_mask[port] = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check and assign (port, queue) to I/O lcore */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__lcore_8h.html#a076d17802fafc1fb54e168cc37c94c60">rte_lcore_is_enabled</a>(lcore) == 0) {</div>
<div class="line">            <span class="keywordflow">return</span> -5;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (lcore &gt;= APP_MAX_LCORES) {</div>
<div class="line">            <span class="keywordflow">return</span> -6;</div>
<div class="line">        }</div>
<div class="line">        lp = &amp;app.lcore_params[lcore];</div>
<div class="line">        <span class="keywordflow">if</span> (lp-&gt;type == e_APP_LCORE_WORKER) {</div>
<div class="line">            <span class="keywordflow">return</span> -7;</div>
<div class="line">        }</div>
<div class="line">        lp-&gt;type = e_APP_LCORE_IO;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n_ports = <a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(lp-&gt;io.tx.n_nic_ports,</div>
<div class="line">                                       <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(lp-&gt;io.tx.nic_ports));</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n_ports; i ++) {</div>
<div class="line">            <span class="keywordflow">if</span> (lp-&gt;io.tx.nic_ports[i] == port) {</div>
<div class="line">                <span class="keywordflow">return</span> -8;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (lp-&gt;io.tx.n_nic_ports &gt;= APP_MAX_NIC_TX_PORTS_PER_IO_LCORE) {</div>
<div class="line">            <span class="keywordflow">return</span> -9;</div>
<div class="line">        }</div>
<div class="line">        lp-&gt;io.tx.nic_ports[lp-&gt;io.tx.n_nic_ports] = (uint8_t) port;</div>
<div class="line">        lp-&gt;io.tx.n_nic_ports ++;</div>
<div class="line"></div>
<div class="line">        n_tuples ++;</div>
<div class="line">        <span class="keywordflow">if</span> (n_tuples &gt; APP_ARG_TX_MAX_TUPLES) {</div>
<div class="line">            <span class="keywordflow">return</span> -10;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (n_tuples == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> -11;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_W_MAX_CHARS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_W_MAX_CHARS     4096</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_W_MAX_TUPLES</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_W_MAX_TUPLES    APP_MAX_WORKER_LCORES</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_arg_w(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *p = arg;</div>
<div class="line">    uint32_t n_tuples;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (strnlen(arg, APP_ARG_W_MAX_CHARS + 1) == APP_ARG_W_MAX_CHARS + 1) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    n_tuples = 0;</div>
<div class="line">    <span class="keywordflow">while</span> (*p != 0) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params *lp;</div>
<div class="line">        uint32_t lcore;</div>
<div class="line"></div>
<div class="line">        errno = 0;</div>
<div class="line">        lcore = strtoul(p, NULL, 0);</div>
<div class="line">        <span class="keywordflow">if</span> ((errno != 0)) {</div>
<div class="line">            <span class="keywordflow">return</span> -2;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Check and enable worker lcore */</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="rte__lcore_8h.html#a076d17802fafc1fb54e168cc37c94c60">rte_lcore_is_enabled</a>(lcore) == 0) {</div>
<div class="line">            <span class="keywordflow">return</span> -3;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (lcore &gt;= APP_MAX_LCORES) {</div>
<div class="line">            <span class="keywordflow">return</span> -4;</div>
<div class="line">        }</div>
<div class="line">        lp = &amp;app.lcore_params[lcore];</div>
<div class="line">        <span class="keywordflow">if</span> (lp-&gt;type == e_APP_LCORE_IO) {</div>
<div class="line">            <span class="keywordflow">return</span> -5;</div>
<div class="line">        }</div>
<div class="line">        lp-&gt;type = e_APP_LCORE_WORKER;</div>
<div class="line"></div>
<div class="line">        n_tuples ++;</div>
<div class="line">        <span class="keywordflow">if</span> (n_tuples &gt; APP_ARG_W_MAX_TUPLES) {</div>
<div class="line">            <span class="keywordflow">return</span> -6;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        p = strchr(p, <span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (p == NULL) {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        p ++;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (n_tuples == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> -7;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((n_tuples &amp; (n_tuples - 1)) != 0) {</div>
<div class="line">        <span class="keywordflow">return</span> -8;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_LPM_MAX_CHARS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_LPM_MAX_CHARS     4096</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_arg_lpm(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *p = arg, *p0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (strnlen(arg, APP_ARG_LPM_MAX_CHARS + 1) == APP_ARG_TX_MAX_CHARS + 1) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (*p != 0) {</div>
<div class="line">        uint32_t ip_a, ip_b, ip_c, ip_d, ip, depth, if_out;</div>
<div class="line">        <span class="keywordtype">char</span> *endptr;</div>
<div class="line"></div>
<div class="line">        p0 = strchr(p, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> ((p0 == NULL) ||</div>
<div class="line">            (str_to_unsigned_vals(p, p0 - p, <span class="charliteral">&#39;.&#39;</span>, 4, &amp;ip_a, &amp;ip_b, &amp;ip_c, &amp;ip_d) != 4)) {</div>
<div class="line">            <span class="keywordflow">return</span> -2;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        p = p0 + 1;</div>
<div class="line">        errno = 0;</div>
<div class="line">        depth = strtoul(p, &amp;endptr, 0);</div>
<div class="line">        <span class="keywordflow">if</span> (errno != 0 || *endptr != <span class="charliteral">&#39;=&#39;</span>) {</div>
<div class="line">            <span class="keywordflow">return</span> -3;</div>
<div class="line">        }</div>
<div class="line">        p = strchr(p, <span class="charliteral">&#39;&gt;&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (p == NULL) {</div>
<div class="line">            <span class="keywordflow">return</span> -4;</div>
<div class="line">        }</div>
<div class="line">        if_out = strtoul(++p, &amp;endptr, 0);</div>
<div class="line">        <span class="keywordflow">if</span> (errno != 0 || (*endptr != <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; *endptr != <span class="charliteral">&#39;;&#39;</span>)) {</div>
<div class="line">            <span class="keywordflow">return</span> -5;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((ip_a &gt;= 256) || (ip_b &gt;= 256) || (ip_c &gt;= 256) || (ip_d &gt;= 256) ||</div>
<div class="line">             (depth == 0) || (depth &gt;= 32) ||</div>
<div class="line">             (if_out &gt;= APP_MAX_NIC_PORTS)) {</div>
<div class="line">            <span class="keywordflow">return</span> -6;</div>
<div class="line">        }</div>
<div class="line">        ip = (ip_a &lt;&lt; 24) | (ip_b &lt;&lt; 16) | (ip_c &lt;&lt; 8) | ip_d;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (app.n_lpm_rules &gt;= APP_MAX_LPM_RULES) {</div>
<div class="line">            <span class="keywordflow">return</span> -7;</div>
<div class="line">        }</div>
<div class="line">        app.lpm_rules[app.n_lpm_rules].ip = ip;</div>
<div class="line">        app.lpm_rules[app.n_lpm_rules].depth = (uint8_t) depth;</div>
<div class="line">        app.lpm_rules[app.n_lpm_rules].if_out = (uint8_t) if_out;</div>
<div class="line">        app.n_lpm_rules ++;</div>
<div class="line"></div>
<div class="line">        p = strchr(p, <span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (p == NULL) {</div>
<div class="line">            <span class="keywordflow">return</span> -8;</div>
<div class="line">        }</div>
<div class="line">        p ++;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (app.n_lpm_rules == 0) {</div>
<div class="line">        <span class="keywordflow">return</span> -9;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">app_check_lpm_table(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint32_t rule;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* For each rule, check that the output I/F is enabled */</span></div>
<div class="line">    <span class="keywordflow">for</span> (rule = 0; rule &lt; app.n_lpm_rules; rule ++)</div>
<div class="line">    {</div>
<div class="line">        uint32_t port = app.lpm_rules[rule].if_out;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (app.nic_tx_port_mask[port] == 0) {</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">app_check_every_rx_port_is_tx_enabled(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint8_t port;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (port = 0; port &lt; APP_MAX_NIC_PORTS; port ++) {</div>
<div class="line">        <span class="keywordflow">if</span> ((app_get_nic_rx_queues_per_port(port) &gt; 0) &amp;&amp; (app.nic_tx_port_mask[port] == 0)) {</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_RSZ_CHARS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_RSZ_CHARS 63</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_arg_rsz(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (strnlen(arg, APP_ARG_RSZ_CHARS + 1) == APP_ARG_RSZ_CHARS + 1) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (str_to_unsigned_vals(arg, APP_ARG_RSZ_CHARS, <span class="charliteral">&#39;,&#39;</span>, 4,</div>
<div class="line">            &amp;app.nic_rx_ring_size,</div>
<div class="line">            &amp;app.ring_rx_size,</div>
<div class="line">            &amp;app.ring_tx_size,</div>
<div class="line">            &amp;app.nic_tx_ring_size) !=  4)</div>
<div class="line">        <span class="keywordflow">return</span> -2;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((app.nic_rx_ring_size == 0) ||</div>
<div class="line">        (app.nic_tx_ring_size == 0) ||</div>
<div class="line">        (app.ring_rx_size == 0) ||</div>
<div class="line">        (app.ring_tx_size == 0)) {</div>
<div class="line">        <span class="keywordflow">return</span> -3;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_BSZ_CHARS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_BSZ_CHARS 63</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_arg_bsz(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *p = arg, *p0;</div>
<div class="line">    <span class="keywordflow">if</span> (strnlen(arg, APP_ARG_BSZ_CHARS + 1) == APP_ARG_BSZ_CHARS + 1) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    p0 = strchr(p++, <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> ((p0 == NULL) ||</div>
<div class="line">        (str_to_unsigned_vals(p, p0 - p, <span class="charliteral">&#39;,&#39;</span>, 2, &amp;app.burst_size_io_rx_read, &amp;app.burst_size_io_rx_write) !=  2)) {</div>
<div class="line">        <span class="keywordflow">return</span> -2;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    p = strchr(p0, <span class="charliteral">&#39;(&#39;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL) {</div>
<div class="line">        <span class="keywordflow">return</span> -3;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    p0 = strchr(p++, <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> ((p0 == NULL) ||</div>
<div class="line">        (str_to_unsigned_vals(p, p0 - p, <span class="charliteral">&#39;,&#39;</span>, 2, &amp;app.burst_size_worker_read, &amp;app.burst_size_worker_write) !=  2)) {</div>
<div class="line">        <span class="keywordflow">return</span> -4;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    p = strchr(p0, <span class="charliteral">&#39;(&#39;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL) {</div>
<div class="line">        <span class="keywordflow">return</span> -5;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    p0 = strchr(p++, <span class="charliteral">&#39;)&#39;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> ((p0 == NULL) ||</div>
<div class="line">        (str_to_unsigned_vals(p, p0 - p, <span class="charliteral">&#39;,&#39;</span>, 2, &amp;app.burst_size_io_tx_read, &amp;app.burst_size_io_tx_write) !=  2)) {</div>
<div class="line">        <span class="keywordflow">return</span> -6;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((app.burst_size_io_rx_read == 0) ||</div>
<div class="line">        (app.burst_size_io_rx_write == 0) ||</div>
<div class="line">        (app.burst_size_worker_read == 0) ||</div>
<div class="line">        (app.burst_size_worker_write == 0) ||</div>
<div class="line">        (app.burst_size_io_tx_read == 0) ||</div>
<div class="line">        (app.burst_size_io_tx_write == 0)) {</div>
<div class="line">        <span class="keywordflow">return</span> -7;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((app.burst_size_io_rx_read &gt; APP_MBUF_ARRAY_SIZE) ||</div>
<div class="line">        (app.burst_size_io_rx_write &gt; APP_MBUF_ARRAY_SIZE) ||</div>
<div class="line">        (app.burst_size_worker_read &gt; APP_MBUF_ARRAY_SIZE) ||</div>
<div class="line">        (app.burst_size_worker_write &gt; APP_MBUF_ARRAY_SIZE) ||</div>
<div class="line">        ((2 * app.burst_size_io_tx_read) &gt; APP_MBUF_ARRAY_SIZE) ||</div>
<div class="line">        (app.burst_size_io_tx_write &gt; APP_MBUF_ARRAY_SIZE)) {</div>
<div class="line">        <span class="keywordflow">return</span> -8;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef APP_ARG_NUMERICAL_SIZE_CHARS</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define APP_ARG_NUMERICAL_SIZE_CHARS 15</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_arg_pos_lb(<span class="keyword">const</span> <span class="keywordtype">char</span> *arg)</div>
<div class="line">{</div>
<div class="line">    uint32_t x;</div>
<div class="line">    <span class="keywordtype">char</span> *endpt;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (strnlen(arg, APP_ARG_NUMERICAL_SIZE_CHARS + 1) == APP_ARG_NUMERICAL_SIZE_CHARS + 1) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    errno = 0;</div>
<div class="line">    x = strtoul(arg, &amp;endpt, 10);</div>
<div class="line">    <span class="keywordflow">if</span> (errno != 0 || endpt == arg || *endpt != <span class="charliteral">&#39;\0&#39;</span>){</div>
<div class="line">        <span class="keywordflow">return</span> -2;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (x &gt;= 64) {</div>
<div class="line">        <span class="keywordflow">return</span> -3;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    app.pos_lb = (uint8_t) x;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Parse the argument given in the command line of the application */</span></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_parse_args(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> opt, ret;</div>
<div class="line">    <span class="keywordtype">char</span> **argvopt;</div>
<div class="line">    <span class="keywordtype">int</span> option_index;</div>
<div class="line">    <span class="keywordtype">char</span> *prgname = argv[0];</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">struct </span>option lgopts[] = {</div>
<div class="line">        {<span class="stringliteral">&quot;rx&quot;</span>, 1, 0, 0},</div>
<div class="line">        {<span class="stringliteral">&quot;tx&quot;</span>, 1, 0, 0},</div>
<div class="line">        {<span class="stringliteral">&quot;w&quot;</span>, 1, 0, 0},</div>
<div class="line">        {<span class="stringliteral">&quot;lpm&quot;</span>, 1, 0, 0},</div>
<div class="line">        {<span class="stringliteral">&quot;rsz&quot;</span>, 1, 0, 0},</div>
<div class="line">        {<span class="stringliteral">&quot;bsz&quot;</span>, 1, 0, 0},</div>
<div class="line">        {<span class="stringliteral">&quot;pos-lb&quot;</span>, 1, 0, 0},</div>
<div class="line">        {NULL, 0, 0, 0}</div>
<div class="line">    };</div>
<div class="line">    uint32_t arg_w = 0;</div>
<div class="line">    uint32_t arg_rx = 0;</div>
<div class="line">    uint32_t arg_tx = 0;</div>
<div class="line">    uint32_t arg_lpm = 0;</div>
<div class="line">    uint32_t arg_rsz = 0;</div>
<div class="line">    uint32_t arg_bsz = 0;</div>
<div class="line">    uint32_t arg_pos_lb = 0;</div>
<div class="line"></div>
<div class="line">    argvopt = argv;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> ((opt = getopt_long(argc, argvopt, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                lgopts, &amp;option_index)) != EOF) {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">switch</span> (opt) {</div>
<div class="line">        <span class="comment">/* long options */</span></div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;rx&quot;</span>)) {</div>
<div class="line">                arg_rx = 1;</div>
<div class="line">                ret = parse_arg_rx(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Incorrect value for --rx argument (%d)\n&quot;</span>, ret);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;tx&quot;</span>)) {</div>
<div class="line">                arg_tx = 1;</div>
<div class="line">                ret = parse_arg_tx(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Incorrect value for --tx argument (%d)\n&quot;</span>, ret);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;w&quot;</span>)) {</div>
<div class="line">                arg_w = 1;</div>
<div class="line">                ret = parse_arg_w(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Incorrect value for --w argument (%d)\n&quot;</span>, ret);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;lpm&quot;</span>)) {</div>
<div class="line">                arg_lpm = 1;</div>
<div class="line">                ret = parse_arg_lpm(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Incorrect value for --lpm argument (%d)\n&quot;</span>, ret);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;rsz&quot;</span>)) {</div>
<div class="line">                arg_rsz = 1;</div>
<div class="line">                ret = parse_arg_rsz(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Incorrect value for --rsz argument (%d)\n&quot;</span>, ret);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;bsz&quot;</span>)) {</div>
<div class="line">                arg_bsz = 1;</div>
<div class="line">                ret = parse_arg_bsz(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Incorrect value for --bsz argument (%d)\n&quot;</span>, ret);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (!strcmp(lgopts[option_index].name, <span class="stringliteral">&quot;pos-lb&quot;</span>)) {</div>
<div class="line">                arg_pos_lb = 1;</div>
<div class="line">                ret = parse_arg_pos_lb(optarg);</div>
<div class="line">                <span class="keywordflow">if</span> (ret) {</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Incorrect value for --pos-lb argument (%d)\n&quot;</span>, ret);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check that all mandatory arguments are provided */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((arg_rx == 0) || (arg_tx == 0) || (arg_w == 0) || (arg_lpm == 0)){</div>
<div class="line">        printf(<span class="stringliteral">&quot;Not all mandatory arguments are present\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Assign default values for the optional arguments not provided */</span></div>
<div class="line">    <span class="keywordflow">if</span> (arg_rsz == 0) {</div>
<div class="line">        app.nic_rx_ring_size = APP_DEFAULT_NIC_RX_RING_SIZE;</div>
<div class="line">        app.nic_tx_ring_size = APP_DEFAULT_NIC_TX_RING_SIZE;</div>
<div class="line">        app.ring_rx_size = APP_DEFAULT_RING_RX_SIZE;</div>
<div class="line">        app.ring_tx_size = APP_DEFAULT_RING_TX_SIZE;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (arg_bsz == 0) {</div>
<div class="line">        app.burst_size_io_rx_read = APP_DEFAULT_BURST_SIZE_IO_RX_READ;</div>
<div class="line">        app.burst_size_io_rx_write = APP_DEFAULT_BURST_SIZE_IO_RX_WRITE;</div>
<div class="line">        app.burst_size_io_tx_read = APP_DEFAULT_BURST_SIZE_IO_TX_READ;</div>
<div class="line">        app.burst_size_io_tx_write = APP_DEFAULT_BURST_SIZE_IO_TX_WRITE;</div>
<div class="line">        app.burst_size_worker_read = APP_DEFAULT_BURST_SIZE_WORKER_READ;</div>
<div class="line">        app.burst_size_worker_write = APP_DEFAULT_BURST_SIZE_WORKER_WRITE;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (arg_pos_lb == 0) {</div>
<div class="line">        app.pos_lb = APP_DEFAULT_IO_RX_LB_POS;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check cross-consistency of arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((ret = app_check_lpm_table()) &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;At least one LPM rule is inconsistent (%d)\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (app_check_every_rx_port_is_tx_enabled() &lt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;On LPM lookup miss, packet is sent back on the input port.\n&quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;At least one RX port is not enabled for TX.\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -2;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (optind &gt;= 0)</div>
<div class="line">        argv[optind - 1] = prgname;</div>
<div class="line"></div>
<div class="line">    ret = optind - 1;</div>
<div class="line">    optind = 0; <span class="comment">/* reset getopt lib */</span></div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_get_nic_rx_queues_per_port(uint8_t port)</div>
<div class="line">{</div>
<div class="line">    uint32_t i, count;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (port &gt;= APP_MAX_NIC_PORTS) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    count = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; APP_MAX_RX_QUEUES_PER_NIC_PORT; i ++) {</div>
<div class="line">        <span class="keywordflow">if</span> (app.nic_rx_queue_mask[port][i] == 1) {</div>
<div class="line">            count ++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> count;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_get_lcore_for_nic_rx(uint8_t port, uint8_t queue, uint32_t *lcore_out)</div>
<div class="line">{</div>
<div class="line">    uint32_t lcore;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params_io *lp = &amp;app.lcore_params[lcore].io;</div>
<div class="line">        uint32_t i;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (app.lcore_params[lcore].type != e_APP_LCORE_IO) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n_queues = <a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(lp-&gt;rx.n_nic_queues,</div>
<div class="line">                                        <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(lp-&gt;rx.nic_queues));</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n_queues; i ++) {</div>
<div class="line">            <span class="keywordflow">if</span> ((lp-&gt;rx.nic_queues[i].port == port) &amp;&amp;</div>
<div class="line">                (lp-&gt;rx.nic_queues[i].queue == queue)) {</div>
<div class="line">                *lcore_out = lcore;</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_get_lcore_for_nic_tx(uint8_t port, uint32_t *lcore_out)</div>
<div class="line">{</div>
<div class="line">    uint32_t lcore;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params_io *lp = &amp;app.lcore_params[lcore].io;</div>
<div class="line">        uint32_t i;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (app.lcore_params[lcore].type != e_APP_LCORE_IO) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> n_ports = <a class="code" href="rte__common_8h.html#a4c7571cbcdbfe9b63431036af811bee9">RTE_MIN</a>(lp-&gt;tx.n_nic_ports,</div>
<div class="line">                                       <a class="code" href="rte__common_8h.html#ac963da91b35efa4700b73a1f4eb1d8a6">RTE_DIM</a>(lp-&gt;tx.nic_ports));</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n_ports; i ++) {</div>
<div class="line">            <span class="keywordflow">if</span> (lp-&gt;tx.nic_ports[i] == port) {</div>
<div class="line">                *lcore_out = lcore;</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_is_socket_used(uint32_t socket)</div>
<div class="line">{</div>
<div class="line">    uint32_t lcore;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keywordflow">if</span> (app.lcore_params[lcore].type == e_APP_LCORE_DISABLED) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (socket == <a name="a5"></a><a class="code" href="rte__lcore_8h.html#afef423c8171c6800dc6583979fe85856">rte_lcore_to_socket_id</a>(lcore)) {</div>
<div class="line">            <span class="keywordflow">return</span> 1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">uint32_t</div>
<div class="line">app_get_lcores_io_rx(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint32_t lcore, count;</div>
<div class="line"></div>
<div class="line">    count = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params_io *lp_io = &amp;app.lcore_params[lcore].io;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((app.lcore_params[lcore].type != e_APP_LCORE_IO) ||</div>
<div class="line">            (lp_io-&gt;rx.n_nic_queues == 0)) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        count ++;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> count;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">uint32_t</div>
<div class="line">app_get_lcores_worker(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    uint32_t lcore, count;</div>
<div class="line"></div>
<div class="line">    count = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keywordflow">if</span> (app.lcore_params[lcore].type != e_APP_LCORE_WORKER) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        count ++;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (count &gt; APP_MAX_WORKER_LCORES) {</div>
<div class="line">        <a name="a6"></a><a class="code" href="rte__debug_8h.html#a9fcab5683ce1c1164c52c17579cc2b5f">rte_panic</a>(<span class="stringliteral">&quot;Algorithmic error (too many worker lcores)\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> count;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">app_print_params(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> port, queue, lcore, rule, i, j;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Print NIC RX configuration */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;NIC RX ports: &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (port = 0; port &lt; APP_MAX_NIC_PORTS; port ++) {</div>
<div class="line">        uint32_t n_rx_queues = app_get_nic_rx_queues_per_port((uint8_t) port);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (n_rx_queues == 0) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;%u (&quot;</span>, port);</div>
<div class="line">        <span class="keywordflow">for</span> (queue = 0; queue &lt; APP_MAX_RX_QUEUES_PER_NIC_PORT; queue ++) {</div>
<div class="line">            <span class="keywordflow">if</span> (app.nic_rx_queue_mask[port][queue] == 1) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;%u &quot;</span>, queue);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        printf(<span class="stringliteral">&quot;)  &quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;;\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Print I/O lcore RX params */</span></div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params_io *lp = &amp;app.lcore_params[lcore].io;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((app.lcore_params[lcore].type != e_APP_LCORE_IO) ||</div>
<div class="line">            (lp-&gt;rx.n_nic_queues == 0)) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;I/O lcore %u (socket %u): &quot;</span>, lcore, <a class="code" href="rte__lcore_8h.html#afef423c8171c6800dc6583979fe85856">rte_lcore_to_socket_id</a>(lcore));</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;RX ports  &quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; lp-&gt;rx.n_nic_queues; i ++) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;(%u, %u)  &quot;</span>,</div>
<div class="line">                (<span class="keywordtype">unsigned</span>) lp-&gt;rx.nic_queues[i].port,</div>
<div class="line">                (<span class="keywordtype">unsigned</span>) lp-&gt;rx.nic_queues[i].queue);</div>
<div class="line">        }</div>
<div class="line">        printf(<span class="stringliteral">&quot;; &quot;</span>);</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Output rings  &quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; lp-&gt;rx.n_rings; i ++) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;%p  &quot;</span>, lp-&gt;rx.rings[i]);</div>
<div class="line">        }</div>
<div class="line">        printf(<span class="stringliteral">&quot;;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Print worker lcore RX params */</span></div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params_worker *lp = &amp;app.lcore_params[lcore].worker;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (app.lcore_params[lcore].type != e_APP_LCORE_WORKER) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Worker lcore %u (socket %u) ID %u: &quot;</span>,</div>
<div class="line">            lcore,</div>
<div class="line">            <a class="code" href="rte__lcore_8h.html#afef423c8171c6800dc6583979fe85856">rte_lcore_to_socket_id</a>(lcore),</div>
<div class="line">            (<span class="keywordtype">unsigned</span>)lp-&gt;worker_id);</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Input rings  &quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; lp-&gt;n_rings_in; i ++) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;%p  &quot;</span>, lp-&gt;rings_in[i]);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Print NIC TX configuration */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;NIC TX ports:  &quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (port = 0; port &lt; APP_MAX_NIC_PORTS; port ++) {</div>
<div class="line">        <span class="keywordflow">if</span> (app.nic_tx_port_mask[port] == 1) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;%u  &quot;</span>, port);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;;\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Print I/O TX lcore params */</span></div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params_io *lp = &amp;app.lcore_params[lcore].io;</div>
<div class="line">        uint32_t n_workers = app_get_lcores_worker();</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((app.lcore_params[lcore].type != e_APP_LCORE_IO) ||</div>
<div class="line">             (lp-&gt;tx.n_nic_ports == 0)) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;I/O lcore %u (socket %u): &quot;</span>, lcore, <a class="code" href="rte__lcore_8h.html#afef423c8171c6800dc6583979fe85856">rte_lcore_to_socket_id</a>(lcore));</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Input rings per TX port  &quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; lp-&gt;tx.n_nic_ports; i ++) {</div>
<div class="line">            port = lp-&gt;tx.nic_ports[i];</div>
<div class="line"></div>
<div class="line">            printf(<span class="stringliteral">&quot;%u (&quot;</span>, port);</div>
<div class="line">            <span class="keywordflow">for</span> (j = 0; j &lt; n_workers; j ++) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;%p  &quot;</span>, lp-&gt;tx.rings[port][j]);</div>
<div class="line">            }</div>
<div class="line">            printf(<span class="stringliteral">&quot;)  &quot;</span>);</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Print worker lcore TX params */</span></div>
<div class="line">    <span class="keywordflow">for</span> (lcore = 0; lcore &lt; APP_MAX_LCORES; lcore ++) {</div>
<div class="line">        <span class="keyword">struct </span>app_lcore_params_worker *lp = &amp;app.lcore_params[lcore].worker;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (app.lcore_params[lcore].type != e_APP_LCORE_WORKER) {</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Worker lcore %u (socket %u) ID %u: \n&quot;</span>,</div>
<div class="line">            lcore,</div>
<div class="line">            <a class="code" href="rte__lcore_8h.html#afef423c8171c6800dc6583979fe85856">rte_lcore_to_socket_id</a>(lcore),</div>
<div class="line">            (<span class="keywordtype">unsigned</span>)lp-&gt;worker_id);</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;Output rings per TX port  &quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (port = 0; port &lt; APP_MAX_NIC_PORTS; port ++) {</div>
<div class="line">            <span class="keywordflow">if</span> (lp-&gt;rings_out[port] != NULL) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;%u (%p)  &quot;</span>, port, lp-&gt;rings_out[port]);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Print LPM rules */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;LPM rules: \n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (rule = 0; rule &lt; app.n_lpm_rules; rule ++) {</div>
<div class="line">        uint32_t ip = app.lpm_rules[rule].ip;</div>
<div class="line">        uint8_t depth = app.lpm_rules[rule].depth;</div>
<div class="line">        uint8_t if_out = app.lpm_rules[rule].if_out;</div>
<div class="line"></div>
<div class="line">        printf(<span class="stringliteral">&quot;\t%u: %u.%u.%u.%u/%u =&gt; %u;\n&quot;</span>,</div>
<div class="line">            rule,</div>
<div class="line">            (<span class="keywordtype">unsigned</span>) (ip &amp; 0xFF000000) &gt;&gt; 24,</div>
<div class="line">            (<span class="keywordtype">unsigned</span>) (ip &amp; 0x00FF0000) &gt;&gt; 16,</div>
<div class="line">            (<span class="keywordtype">unsigned</span>) (ip &amp; 0x0000FF00) &gt;&gt; 8,</div>
<div class="line">            (<span class="keywordtype">unsigned</span>) ip &amp; 0x000000FF,</div>
<div class="line">            (<span class="keywordtype">unsigned</span>) depth,</div>
<div class="line">            (<span class="keywordtype">unsigned</span>) if_out</div>
<div class="line">        );</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Rings */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Ring sizes: NIC RX = %u; Worker in = %u; Worker out = %u; NIC TX = %u;\n&quot;</span>,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.nic_rx_ring_size,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.ring_rx_size,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.ring_tx_size,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.nic_tx_ring_size);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Bursts */</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Burst sizes: I/O RX (rd = %u, wr = %u); Worker (rd = %u, wr = %u); I/O TX (rd = %u, wr = %u)\n&quot;</span>,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.burst_size_io_rx_read,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.burst_size_io_rx_write,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.burst_size_worker_read,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.burst_size_worker_write,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.burst_size_io_tx_read,</div>
<div class="line">        (<span class="keywordtype">unsigned</span>) app.burst_size_io_tx_write);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>

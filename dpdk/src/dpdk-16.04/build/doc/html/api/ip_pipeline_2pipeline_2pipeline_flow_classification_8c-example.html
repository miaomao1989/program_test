<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DPDK: ip_pipeline/pipeline/pipeline_flow_classification.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">16.04.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ip_pipeline/pipeline/pipeline_flow_classification.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*-</span></div>
<div class="line"><span class="comment"> *   BSD LICENSE</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Copyright(c) 2010-2015 Intel Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *   All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment"> *   modification, are permitted provided that the following conditions</span></div>
<div class="line"><span class="comment"> *   are met:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment"> *     * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer in</span></div>
<div class="line"><span class="comment"> *       the documentation and/or other materials provided with the</span></div>
<div class="line"><span class="comment"> *       distribution.</span></div>
<div class="line"><span class="comment"> *     * Neither the name of Intel Corporation nor the names of its</span></div>
<div class="line"><span class="comment"> *       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment"> *       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment"> *   &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment"> *   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment"> *   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment"> *   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment"> *   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment"> *   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment"> *   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment"> *   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/queue.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__common_8h.html">rte_common.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__hexdump_8h.html">rte_hexdump.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="rte__malloc_8h.html">rte_malloc.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_rdline.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse_num.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse_string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse_ipaddr.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse_etheraddr.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;app.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pipeline_common_fe.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pipeline_flow_classification.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;hash_func.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Key conversion</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>pkt_key_qinq {</div>
<div class="line">    uint16_t ethertype_svlan;</div>
<div class="line">    uint16_t svlan;</div>
<div class="line">    uint16_t ethertype_cvlan;</div>
<div class="line">    uint16_t cvlan;</div>
<div class="line">} __attribute__((__packed__));</div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>pkt_key_ipv4_5tuple {</div>
<div class="line">    uint8_t ttl;</div>
<div class="line">    uint8_t proto;</div>
<div class="line">    uint16_t checksum;</div>
<div class="line">    uint32_t ip_src;</div>
<div class="line">    uint32_t ip_dst;</div>
<div class="line">    uint16_t port_src;</div>
<div class="line">    uint16_t port_dst;</div>
<div class="line">} __attribute__((__packed__));</div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>pkt_key_ipv6_5tuple {</div>
<div class="line">    uint16_t payload_length;</div>
<div class="line">    uint8_t proto;</div>
<div class="line">    uint8_t hop_limit;</div>
<div class="line">    uint8_t ip_src[16];</div>
<div class="line">    uint8_t ip_dst[16];</div>
<div class="line">    uint16_t port_src;</div>
<div class="line">    uint16_t port_dst;</div>
<div class="line">} __attribute__((__packed__));</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_key_convert(<span class="keyword">struct</span> pipeline_fc_key *key_in,</div>
<div class="line">    uint8_t *key_out,</div>
<div class="line">    uint32_t *signature)</div>
<div class="line">{</div>
<div class="line">    uint8_t buffer[PIPELINE_FC_FLOW_KEY_MAX_SIZE];</div>
<div class="line">    <span class="keywordtype">void</span> *key_buffer = (key_out) ? key_out : buffer;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">switch</span> (key_in-&gt;type) {</div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_QINQ:</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span>pkt_key_qinq *qinq = key_buffer;</div>
<div class="line"></div>
<div class="line">        qinq-&gt;ethertype_svlan = 0;</div>
<div class="line">        qinq-&gt;svlan = <a name="a0"></a><a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(key_in-&gt;key.qinq.svlan);</div>
<div class="line">        qinq-&gt;ethertype_cvlan = 0;</div>
<div class="line">        qinq-&gt;cvlan = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(key_in-&gt;key.qinq.cvlan);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (signature)</div>
<div class="line">            *signature = (uint32_t) hash_default_key8(qinq, 8, 0);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_IPV4_5TUPLE:</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span>pkt_key_ipv4_5tuple *ipv4 = key_buffer;</div>
<div class="line"></div>
<div class="line">        ipv4-&gt;ttl = 0;</div>
<div class="line">        ipv4-&gt;proto = key_in-&gt;key.ipv4_5tuple.proto;</div>
<div class="line">        ipv4-&gt;checksum = 0;</div>
<div class="line">        ipv4-&gt;ip_src = <a name="a1"></a><a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(key_in-&gt;key.ipv4_5tuple.ip_src);</div>
<div class="line">        ipv4-&gt;ip_dst = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(key_in-&gt;key.ipv4_5tuple.ip_dst);</div>
<div class="line">        ipv4-&gt;port_src = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(key_in-&gt;key.ipv4_5tuple.port_src);</div>
<div class="line">        ipv4-&gt;port_dst = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(key_in-&gt;key.ipv4_5tuple.port_dst);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (signature)</div>
<div class="line">            *signature = (uint32_t) hash_default_key16(ipv4, 16, 0);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_IPV6_5TUPLE:</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">struct </span>pkt_key_ipv6_5tuple *ipv6 = key_buffer;</div>
<div class="line"></div>
<div class="line">        memset(ipv6, 0, 64);</div>
<div class="line">        ipv6-&gt;payload_length = 0;</div>
<div class="line">        ipv6-&gt;proto = key_in-&gt;key.ipv6_5tuple.proto;</div>
<div class="line">        ipv6-&gt;hop_limit = 0;</div>
<div class="line">        memcpy(&amp;ipv6-&gt;ip_src, &amp;key_in-&gt;key.ipv6_5tuple.ip_src, 16);</div>
<div class="line">        memcpy(&amp;ipv6-&gt;ip_dst, &amp;key_in-&gt;key.ipv6_5tuple.ip_dst, 16);</div>
<div class="line">        ipv6-&gt;port_src = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(key_in-&gt;key.ipv6_5tuple.port_src);</div>
<div class="line">        ipv6-&gt;port_dst = <a class="code" href="rte__byteorder_8h.html#a8630d768a50c489c2000dbb318e8a0ef">rte_bswap16</a>(key_in-&gt;key.ipv6_5tuple.port_dst);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (signature)</div>
<div class="line">            *signature = (uint32_t) hash_default_key64(ipv6, 64, 0);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Flow classification pipeline</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>app_pipeline_fc_flow {</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key key;</div>
<div class="line">    uint32_t port_id;</div>
<div class="line">    uint32_t flow_id;</div>
<div class="line">    uint32_t signature;</div>
<div class="line">    <span class="keywordtype">void</span> *entry_ptr;</div>
<div class="line"></div>
<div class="line">    TAILQ_ENTRY(app_pipeline_fc_flow) node;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define N_BUCKETS                                65536</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">struct </span>app_pipeline_fc {</div>
<div class="line">    <span class="comment">/* Parameters */</span></div>
<div class="line">    uint32_t n_ports_in;</div>
<div class="line">    uint32_t n_ports_out;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Flows */</span></div>
<div class="line">    <a name="a2"></a><a class="code" href="rte__dev_8h.html#a6ded4e1869262353a8700cdc4d453b82">TAILQ_HEAD</a>(, app_pipeline_fc_flow) flows[N_BUCKETS];</div>
<div class="line">    uint32_t n_flows;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Default flow */</span></div>
<div class="line">    uint32_t default_flow_present;</div>
<div class="line">    uint32_t default_flow_port_id;</div>
<div class="line">    <span class="keywordtype">void</span> *default_flow_entry_ptr;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line">static struct app_pipeline_fc_flow *</div>
<div class="line">app_pipeline_fc_flow_find(struct app_pipeline_fc *p,</div>
<div class="line">    struct pipeline_fc_key *key)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc_flow *f;</div>
<div class="line">    uint32_t signature, bucket_id;</div>
<div class="line"></div>
<div class="line">    app_pipeline_fc_key_convert(key, NULL, &amp;signature);</div>
<div class="line">    bucket_id = signature &amp; (N_BUCKETS - 1);</div>
<div class="line"></div>
<div class="line">    TAILQ_FOREACH(f, &amp;p-&gt;flows[bucket_id], node)</div>
<div class="line">        if ((signature == f-&gt;signature) &amp;&amp;</div>
<div class="line">            (memcmp(key,</div>
<div class="line">                &amp;f-&gt;key,</div>
<div class="line">                sizeof(struct pipeline_fc_key)) == 0))</div>
<div class="line">            return f;</div>
<div class="line"></div>
<div class="line">    return NULL;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">static <span class="keywordtype">void</span>*</div>
<div class="line">app_pipeline_fc_init(struct pipeline_params *params,</div>
<div class="line">    <a name="a3"></a><a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *arg)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p;</div>
<div class="line">    uint32_t size, i;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((params == NULL) ||</div>
<div class="line">        (params-&gt;n_ports_in == 0) ||</div>
<div class="line">        (params-&gt;n_ports_out == 0))</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    size = <a name="a4"></a><a class="code" href="rte__memory_8h.html#a30eec128f3d71add687a1cbfe48abcbb">RTE_CACHE_LINE_ROUNDUP</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> app_pipeline_fc));</div>
<div class="line">    p = <a name="a5"></a><a class="code" href="rte__malloc_8h.html#a58042061ad622f028aa2b97e8cb73a41">rte_zmalloc</a>(NULL, size, RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> NULL;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Initialization */</span></div>
<div class="line">    p-&gt;n_ports_in = params-&gt;n_ports_in;</div>
<div class="line">    p-&gt;n_ports_out = params-&gt;n_ports_out;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; N_BUCKETS; i++)</div>
<div class="line">        TAILQ_INIT(&amp;p-&gt;flows[i]);</div>
<div class="line">    p-&gt;n_flows = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> (<span class="keywordtype">void</span> *) p;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_free(<span class="keywordtype">void</span> *pipeline)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p = pipeline;</div>
<div class="line">    uint32_t i;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Free resources */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; N_BUCKETS; i++)</div>
<div class="line">        <span class="keywordflow">while</span> (!TAILQ_EMPTY(&amp;p-&gt;flows[i])) {</div>
<div class="line">            <span class="keyword">struct </span>app_pipeline_fc_flow *flow;</div>
<div class="line"></div>
<div class="line">            flow = TAILQ_FIRST(&amp;p-&gt;flows[i]);</div>
<div class="line">            TAILQ_REMOVE(&amp;p-&gt;flows[i], flow, node);</div>
<div class="line">            <a name="a6"></a><a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(p);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_key_check(<span class="keyword">struct</span> pipeline_fc_key *key)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (key-&gt;type) {</div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_QINQ:</div>
<div class="line">    {</div>
<div class="line">        uint16_t svlan = key-&gt;key.qinq.svlan;</div>
<div class="line">        uint16_t cvlan = key-&gt;key.qinq.cvlan;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((svlan &amp; 0xF000) ||</div>
<div class="line">            (cvlan &amp; 0xF000))</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_IPV4_5TUPLE:</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_IPV6_5TUPLE:</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_add(<span class="keyword">struct</span> app_params *app,</div>
<div class="line">    uint32_t pipeline_id,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_fc_key *key,</div>
<div class="line">    uint32_t port_id,</div>
<div class="line">    uint32_t flow_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p;</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc_flow *flow;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_msg_rsp *rsp;</div>
<div class="line"></div>
<div class="line">    uint32_t signature;</div>
<div class="line">    <span class="keywordtype">int</span> new_flow;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((app == NULL) ||</div>
<div class="line">        (key == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    p = app_pipeline_data_fe(app, pipeline_id, &amp;pipeline_flow_classification);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (port_id &gt;= p-&gt;n_ports_out)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (app_pipeline_fc_key_check(key) != 0)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Find existing flow or allocate new flow */</span></div>
<div class="line">    flow = app_pipeline_fc_flow_find(p, key);</div>
<div class="line">    new_flow = (flow == NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (flow == NULL) {</div>
<div class="line">        flow = <a name="a7"></a><a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL, <span class="keyword">sizeof</span>(*flow), RTE_CACHE_LINE_SIZE);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (flow == NULL)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Allocate and write request */</span></div>
<div class="line">    req = app_msg_alloc(app);</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    req-&gt;type = PIPELINE_MSG_REQ_CUSTOM;</div>
<div class="line">    req-&gt;subtype = PIPELINE_FC_MSG_REQ_FLOW_ADD;</div>
<div class="line">    app_pipeline_fc_key_convert(key, req-&gt;key, &amp;signature);</div>
<div class="line">    req-&gt;port_id = port_id;</div>
<div class="line">    req-&gt;flow_id = flow_id;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = app_msg_send_recv(app, pipeline_id, req, MSG_TIMEOUT_DEFAULT);</div>
<div class="line">    <span class="keywordflow">if</span> (rsp == NULL) {</div>
<div class="line">        <span class="keywordflow">if</span> (new_flow)</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read response and write flow */</span></div>
<div class="line">    <span class="keywordflow">if</span> (rsp-&gt;status ||</div>
<div class="line">        (rsp-&gt;entry_ptr == NULL) ||</div>
<div class="line">        ((new_flow == 0) &amp;&amp; (rsp-&gt;key_found == 0)) ||</div>
<div class="line">        ((new_flow == 1) &amp;&amp; (rsp-&gt;key_found == 1))) {</div>
<div class="line">        app_msg_free(app, rsp);</div>
<div class="line">        <span class="keywordflow">if</span> (new_flow)</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    memset(&amp;flow-&gt;key, 0, <span class="keyword">sizeof</span>(flow-&gt;key));</div>
<div class="line">    memcpy(&amp;flow-&gt;key, key, <span class="keyword">sizeof</span>(flow-&gt;key));</div>
<div class="line">    flow-&gt;port_id = port_id;</div>
<div class="line">    flow-&gt;flow_id = flow_id;</div>
<div class="line">    flow-&gt;signature = signature;</div>
<div class="line">    flow-&gt;entry_ptr = rsp-&gt;entry_ptr;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Commit rule */</span></div>
<div class="line">    <span class="keywordflow">if</span> (new_flow) {</div>
<div class="line">        uint32_t bucket_id = signature &amp; (N_BUCKETS - 1);</div>
<div class="line"></div>
<div class="line">        TAILQ_INSERT_TAIL(&amp;p-&gt;flows[bucket_id], flow, node);</div>
<div class="line">        p-&gt;n_flows++;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    app_msg_free(app, rsp);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_add_bulk(<span class="keyword">struct</span> app_params *app,</div>
<div class="line">    uint32_t pipeline_id,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_fc_key *key,</div>
<div class="line">    uint32_t *port_id,</div>
<div class="line">    uint32_t *flow_id,</div>
<div class="line">    uint32_t n_keys)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_bulk_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_bulk_msg_rsp *rsp;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc_flow **flow;</div>
<div class="line">    uint32_t *signature;</div>
<div class="line">    <span class="keywordtype">int</span> *new_flow;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_bulk_flow_req *flow_req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_bulk_flow_rsp *flow_rsp;</div>
<div class="line"></div>
<div class="line">    uint32_t i;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((app == NULL) ||</div>
<div class="line">        (key == NULL) ||</div>
<div class="line">        (port_id == NULL) ||</div>
<div class="line">        (flow_id == NULL) ||</div>
<div class="line">        (n_keys == 0))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    p = app_pipeline_data_fe(app, pipeline_id, &amp;pipeline_flow_classification);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; n_keys; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (port_id[i] &gt;= p-&gt;n_ports_out)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; n_keys; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (app_pipeline_fc_key_check(&amp;key[i]) != 0)</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    flow = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        n_keys * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> app_pipeline_fc_flow *),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (flow == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    signature = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        n_keys * <span class="keyword">sizeof</span>(uint32_t),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (signature == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    new_flow = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(</div>
<div class="line">        NULL,</div>
<div class="line">        n_keys * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (new_flow == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(signature);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    flow_req = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        n_keys * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> pipeline_fc_add_bulk_flow_req),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (flow_req == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(new_flow);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(signature);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    flow_rsp = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        n_keys * <span class="keyword">sizeof</span>(<span class="keyword">struct</span> pipeline_fc_add_bulk_flow_rsp),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (flow_rsp == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_req);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(new_flow);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(signature);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Find existing flow or allocate new flow */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; n_keys; i++) {</div>
<div class="line">        flow[i] = app_pipeline_fc_flow_find(p, &amp;key[i]);</div>
<div class="line">        new_flow[i] = (flow[i] == NULL);</div>
<div class="line">        <span class="keywordflow">if</span> (flow[i] == NULL) {</div>
<div class="line">            flow[i] = <a class="code" href="rte__malloc_8h.html#a58042061ad622f028aa2b97e8cb73a41">rte_zmalloc</a>(NULL,</div>
<div class="line">                <span class="keyword">sizeof</span>(<span class="keyword">struct</span> app_pipeline_fc_flow),</div>
<div class="line">                RTE_CACHE_LINE_SIZE);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (flow[i] == NULL) {</div>
<div class="line">                uint32_t j;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">for</span> (j = 0; j &lt; i; j++)</div>
<div class="line">                    <span class="keywordflow">if</span> (new_flow[j])</div>
<div class="line">                        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow[j]);</div>
<div class="line"></div>
<div class="line">                <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_rsp);</div>
<div class="line">                <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_req);</div>
<div class="line">                <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(new_flow);</div>
<div class="line">                <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(signature);</div>
<div class="line">                <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Allocate and write request */</span></div>
<div class="line">    req = app_msg_alloc(app);</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL) {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n_keys; i++)</div>
<div class="line">            <span class="keywordflow">if</span> (new_flow[i])</div>
<div class="line">                <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow[i]);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_rsp);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_req);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(new_flow);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(signature);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; n_keys; i++) {</div>
<div class="line">        app_pipeline_fc_key_convert(&amp;key[i],</div>
<div class="line">            flow_req[i].key,</div>
<div class="line">            &amp;signature[i]);</div>
<div class="line">        flow_req[i].port_id = port_id[i];</div>
<div class="line">        flow_req[i].flow_id = flow_id[i];</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    req-&gt;type = PIPELINE_MSG_REQ_CUSTOM;</div>
<div class="line">    req-&gt;subtype = PIPELINE_FC_MSG_REQ_FLOW_ADD_BULK;</div>
<div class="line">    req-&gt;req = flow_req;</div>
<div class="line">    req-&gt;rsp = flow_rsp;</div>
<div class="line">    req-&gt;n_keys = n_keys;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = app_msg_send_recv(app, pipeline_id, req, 10000);</div>
<div class="line">    <span class="keywordflow">if</span> (rsp == NULL) {</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n_keys; i++)</div>
<div class="line">            <span class="keywordflow">if</span> (new_flow[i])</div>
<div class="line">                <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow[i]);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_rsp);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_req);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(new_flow);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(signature);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    status = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; rsp-&gt;n_keys; i++)</div>
<div class="line">        <span class="keywordflow">if</span> ((flow_rsp[i].entry_ptr == NULL) ||</div>
<div class="line">            ((new_flow[i] == 0) &amp;&amp; (flow_rsp[i].key_found == 0)) ||</div>
<div class="line">            ((new_flow[i] == 1) &amp;&amp; (flow_rsp[i].key_found == 1)))</div>
<div class="line">            status = -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (rsp-&gt;n_keys &lt; n_keys)</div>
<div class="line">        status = -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Commit flows */</span></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; rsp-&gt;n_keys; i++) {</div>
<div class="line">        memcpy(&amp;flow[i]-&gt;key, &amp;key[i], <span class="keyword">sizeof</span>(flow[i]-&gt;key));</div>
<div class="line">        flow[i]-&gt;port_id = port_id[i];</div>
<div class="line">        flow[i]-&gt;flow_id = flow_id[i];</div>
<div class="line">        flow[i]-&gt;signature = signature[i];</div>
<div class="line">        flow[i]-&gt;entry_ptr = flow_rsp[i].entry_ptr;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (new_flow[i]) {</div>
<div class="line">            uint32_t bucket_id = signature[i] &amp; (N_BUCKETS - 1);</div>
<div class="line"></div>
<div class="line">            TAILQ_INSERT_TAIL(&amp;p-&gt;flows[bucket_id], flow[i], node);</div>
<div class="line">            p-&gt;n_flows++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Free resources */</span></div>
<div class="line">    app_msg_free(app, rsp);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = rsp-&gt;n_keys; i &lt; n_keys; i++)</div>
<div class="line">        <span class="keywordflow">if</span> (new_flow[i])</div>
<div class="line">            <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow[i]);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_rsp);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_req);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(new_flow);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(signature);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> status;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_del(<span class="keyword">struct</span> app_params *app,</div>
<div class="line">    uint32_t pipeline_id,</div>
<div class="line">    <span class="keyword">struct</span> pipeline_fc_key *key)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p;</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc_flow *flow;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_del_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_del_msg_rsp *rsp;</div>
<div class="line"></div>
<div class="line">    uint32_t signature, bucket_id;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((app == NULL) ||</div>
<div class="line">        (key == NULL))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    p = app_pipeline_data_fe(app, pipeline_id, &amp;pipeline_flow_classification);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (app_pipeline_fc_key_check(key) != 0)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Find rule */</span></div>
<div class="line">    flow = app_pipeline_fc_flow_find(p, key);</div>
<div class="line">    <span class="keywordflow">if</span> (flow == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Allocate and write request */</span></div>
<div class="line">    req = app_msg_alloc(app);</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    req-&gt;type = PIPELINE_MSG_REQ_CUSTOM;</div>
<div class="line">    req-&gt;subtype = PIPELINE_FC_MSG_REQ_FLOW_DEL;</div>
<div class="line">    app_pipeline_fc_key_convert(key, req-&gt;key, &amp;signature);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = app_msg_send_recv(app, pipeline_id, req, MSG_TIMEOUT_DEFAULT);</div>
<div class="line">    <span class="keywordflow">if</span> (rsp == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    <span class="keywordflow">if</span> (rsp-&gt;status || !rsp-&gt;key_found) {</div>
<div class="line">        app_msg_free(app, rsp);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Remove rule */</span></div>
<div class="line">    bucket_id = signature &amp; (N_BUCKETS - 1);</div>
<div class="line">    TAILQ_REMOVE(&amp;p-&gt;flows[bucket_id], flow, node);</div>
<div class="line">    p-&gt;n_flows--;</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    app_msg_free(app, rsp);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_add_default(<span class="keyword">struct</span> app_params *app,</div>
<div class="line">    uint32_t pipeline_id,</div>
<div class="line">    uint32_t port_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_default_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_add_default_msg_rsp *rsp;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (app == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    p = app_pipeline_data_fe(app, pipeline_id, &amp;pipeline_flow_classification);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (port_id &gt;= p-&gt;n_ports_out)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Allocate and write request */</span></div>
<div class="line">    req = app_msg_alloc(app);</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    req-&gt;type = PIPELINE_MSG_REQ_CUSTOM;</div>
<div class="line">    req-&gt;subtype = PIPELINE_FC_MSG_REQ_FLOW_ADD_DEFAULT;</div>
<div class="line">    req-&gt;port_id = port_id;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = app_msg_send_recv(app, pipeline_id, req, MSG_TIMEOUT_DEFAULT);</div>
<div class="line">    <span class="keywordflow">if</span> (rsp == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read response and write flow */</span></div>
<div class="line">    <span class="keywordflow">if</span> (rsp-&gt;status || (rsp-&gt;entry_ptr == NULL)) {</div>
<div class="line">        app_msg_free(app, rsp);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    p-&gt;default_flow_port_id = port_id;</div>
<div class="line">    p-&gt;default_flow_entry_ptr = rsp-&gt;entry_ptr;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Commit route */</span></div>
<div class="line">    p-&gt;default_flow_present = 1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    app_msg_free(app, rsp);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_del_default(<span class="keyword">struct</span> app_params *app,</div>
<div class="line">    uint32_t pipeline_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_del_default_msg_req *req;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_del_default_msg_rsp *rsp;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (app == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    p = app_pipeline_data_fe(app, pipeline_id, &amp;pipeline_flow_classification);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -EINVAL;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Allocate and write request */</span></div>
<div class="line">    req = app_msg_alloc(app);</div>
<div class="line">    <span class="keywordflow">if</span> (req == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    req-&gt;type = PIPELINE_MSG_REQ_CUSTOM;</div>
<div class="line">    req-&gt;subtype = PIPELINE_FC_MSG_REQ_FLOW_DEL_DEFAULT;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Send request and wait for response */</span></div>
<div class="line">    rsp = app_msg_send_recv(app, pipeline_id, req, MSG_TIMEOUT_DEFAULT);</div>
<div class="line">    <span class="keywordflow">if</span> (rsp == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Read response */</span></div>
<div class="line">    <span class="keywordflow">if</span> (rsp-&gt;status) {</div>
<div class="line">        app_msg_free(app, rsp);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Commit route */</span></div>
<div class="line">    p-&gt;default_flow_present = 0;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Free response */</span></div>
<div class="line">    app_msg_free(app, rsp);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Flow ls</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_fc_qinq_flow(<span class="keyword">struct</span> app_pipeline_fc_flow *flow)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;(SVLAN = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;CVLAN = %&quot;</span> PRIu32 <span class="stringliteral">&quot;) =&gt; &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;Port = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;Flow ID = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;(signature = 0x%08&quot;</span> PRIx32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;entry_ptr = %p)\n&quot;</span>,</div>
<div class="line"></div>
<div class="line">        flow-&gt;key.key.qinq.svlan,</div>
<div class="line">        flow-&gt;key.key.qinq.cvlan,</div>
<div class="line">        flow-&gt;port_id,</div>
<div class="line">        flow-&gt;flow_id,</div>
<div class="line">        flow-&gt;signature,</div>
<div class="line">        flow-&gt;entry_ptr);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_fc_ipv4_5tuple_flow(<span class="keyword">struct</span> app_pipeline_fc_flow *flow)</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;(SA = %&quot;</span> PRIu32 <span class="stringliteral">&quot;.%&quot;</span> PRIu32 <span class="stringliteral">&quot;.%&quot;</span> PRIu32 <span class="stringliteral">&quot;.%&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;DA = %&quot;</span> PRIu32 <span class="stringliteral">&quot;.%&quot;</span> PRIu32 <span class="stringliteral">&quot;.%&quot;</span> PRIu32 <span class="stringliteral">&quot;.%&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;SP = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;DP = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;Proto = %&quot;</span> PRIu32 <span class="stringliteral">&quot;) =&gt; &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;Port = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;Flow ID = %&quot;</span> PRIu32 <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;(signature = 0x%08&quot;</span> PRIx32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">           <span class="stringliteral">&quot;entry_ptr = %p)\n&quot;</span>,</div>
<div class="line"></div>
<div class="line">           (flow-&gt;key.key.ipv4_5tuple.ip_src &gt;&gt; 24) &amp; 0xFF,</div>
<div class="line">           (flow-&gt;key.key.ipv4_5tuple.ip_src &gt;&gt; 16) &amp; 0xFF,</div>
<div class="line">           (flow-&gt;key.key.ipv4_5tuple.ip_src &gt;&gt; 8) &amp; 0xFF,</div>
<div class="line">           flow-&gt;key.key.ipv4_5tuple.ip_src &amp; 0xFF,</div>
<div class="line"></div>
<div class="line">           (flow-&gt;key.key.ipv4_5tuple.ip_dst &gt;&gt; 24) &amp; 0xFF,</div>
<div class="line">           (flow-&gt;key.key.ipv4_5tuple.ip_dst &gt;&gt; 16) &amp; 0xFF,</div>
<div class="line">           (flow-&gt;key.key.ipv4_5tuple.ip_dst &gt;&gt; 8) &amp; 0xFF,</div>
<div class="line">           flow-&gt;key.key.ipv4_5tuple.ip_dst &amp; 0xFF,</div>
<div class="line"></div>
<div class="line">           flow-&gt;key.key.ipv4_5tuple.port_src,</div>
<div class="line">           flow-&gt;key.key.ipv4_5tuple.port_dst,</div>
<div class="line"></div>
<div class="line">           flow-&gt;key.key.ipv4_5tuple.proto,</div>
<div class="line"></div>
<div class="line">           flow-&gt;port_id,</div>
<div class="line">           flow-&gt;flow_id,</div>
<div class="line">           flow-&gt;signature,</div>
<div class="line">           flow-&gt;entry_ptr);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_fc_ipv6_5tuple_flow(<span class="keyword">struct</span> app_pipeline_fc_flow *flow) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;(SA = %02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32</div>
<div class="line">        <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32</div>
<div class="line">        <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32</div>
<div class="line">        <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;DA = %02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32</div>
<div class="line">        <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32</div>
<div class="line">        <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32</div>
<div class="line">        <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;:%02&quot;</span> PRIx32 <span class="stringliteral">&quot;%02&quot;</span> PRIx32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;SP = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;DP = %&quot;</span> PRIu32 <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;Proto = %&quot;</span> PRIu32 <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;=&gt; Port = %&quot;</span> PRIu32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;Flow ID = %&quot;</span> PRIu32 <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;(signature = 0x%08&quot;</span> PRIx32 <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;entry_ptr = %p)\n&quot;</span>,</div>
<div class="line"></div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[0],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[1],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[2],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[3],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[4],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[5],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[6],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[7],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[8],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[9],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[10],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[11],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[12],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[13],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[14],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_src[15],</div>
<div class="line"></div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[0],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[1],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[2],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[3],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[4],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[5],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[6],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[7],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[8],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[9],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[10],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[11],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[12],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[13],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[14],</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.ip_dst[15],</div>
<div class="line"></div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.port_src,</div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.port_dst,</div>
<div class="line"></div>
<div class="line">        flow-&gt;key.key.ipv6_5tuple.proto,</div>
<div class="line"></div>
<div class="line">        flow-&gt;port_id,</div>
<div class="line">        flow-&gt;flow_id,</div>
<div class="line">        flow-&gt;signature,</div>
<div class="line">        flow-&gt;entry_ptr);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_fc_flow(<span class="keyword">struct</span> app_pipeline_fc_flow *flow)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (flow-&gt;key.type) {</div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_QINQ:</div>
<div class="line">        print_fc_qinq_flow(flow);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_IPV4_5TUPLE:</div>
<div class="line">        print_fc_ipv4_5tuple_flow(flow);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">case</span> FLOW_KEY_IPV6_5TUPLE:</div>
<div class="line">        print_fc_ipv6_5tuple_flow(flow);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">app_pipeline_fc_ls(<span class="keyword">struct</span> app_params *app,</div>
<div class="line">        uint32_t pipeline_id)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc *p;</div>
<div class="line">    <span class="keyword">struct </span>app_pipeline_fc_flow *flow;</div>
<div class="line">    uint32_t i;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (app == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    p = app_pipeline_data_fe(app, pipeline_id, &amp;pipeline_flow_classification);</div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; N_BUCKETS; i++)</div>
<div class="line">        TAILQ_FOREACH(flow, &amp;p-&gt;flows[i], node)</div>
<div class="line">            print_fc_flow(flow);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (p-&gt;default_flow_present)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Default flow: port %&quot;</span> PRIu32 <span class="stringliteral">&quot; (entry ptr = %p)\n&quot;</span>,</div>
<div class="line">            p-&gt;default_flow_port_id,</div>
<div class="line">            p-&gt;default_flow_entry_ptr);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Default: DROP\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow add qinq</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_add_qinq_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t add_string;</div>
<div class="line">    cmdline_fixed_string_t qinq_string;</div>
<div class="line">    uint16_t svlan;</div>
<div class="line">    uint16_t cvlan;</div>
<div class="line">    cmdline_fixed_string_t port_string;</div>
<div class="line">    uint32_t <a name="_a8"></a><a class="code" href="structport.html">port</a>;</div>
<div class="line">    cmdline_fixed_string_t flowid_string;</div>
<div class="line">    uint32_t flow_id;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_add_qinq_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_add_qinq_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key key;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    memset(&amp;key, 0, <span class="keyword">sizeof</span>(key));</div>
<div class="line">    key.type = FLOW_KEY_QINQ;</div>
<div class="line">    key.key.qinq.svlan = params-&gt;svlan;</div>
<div class="line">    key.key.qinq.cvlan = params-&gt;cvlan;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_add(app,</div>
<div class="line">        params-&gt;pipeline_id,</div>
<div class="line">        &amp;key,</div>
<div class="line">        params-&gt;port,</div>
<div class="line">        params-&gt;flow_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, pipeline_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, flow_string,</div>
<div class="line">        <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_add_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, add_string,</div>
<div class="line">        <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_qinq_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, qinq_string,</div>
<div class="line">        <span class="stringliteral">&quot;qinq&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_svlan =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, svlan, UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_cvlan =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, cvlan, UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_port_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, port_string,</div>
<div class="line">        <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, <a class="code" href="structport.html">port</a>, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_flowid_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, flowid_string,</div>
<div class="line">        <span class="stringliteral">&quot;flowid&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_flow_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_result, flow_id, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_add_qinq = {</div>
<div class="line">    .f = cmd_fc_add_qinq_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow add (Q-in-Q)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_add_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_qinq_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_svlan,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_cvlan,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_port_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_flowid_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_flow_id,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow add qinq all</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_add_qinq_all_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t add_string;</div>
<div class="line">    cmdline_fixed_string_t qinq_string;</div>
<div class="line">    cmdline_fixed_string_t all_string;</div>
<div class="line">    uint32_t n_flows;</div>
<div class="line">    uint32_t n_ports;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef N_FLOWS_BULK</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#define N_FLOWS_BULK                    4096</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_add_qinq_all_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_add_qinq_all_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key *key;</div>
<div class="line">    uint32_t *port_id;</div>
<div class="line">    uint32_t *flow_id;</div>
<div class="line">    uint32_t id;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input arguments */</span></div>
<div class="line">    <span class="keywordflow">if</span> (params-&gt;n_flows == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid number of flows\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (params-&gt;n_ports == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid number of output ports\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    key = <a class="code" href="rte__malloc_8h.html#a58042061ad622f028aa2b97e8cb73a41">rte_zmalloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*key),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (key == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    port_id = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*port_id),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (port_id == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    flow_id = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*flow_id),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (flow_id == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(port_id);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Flow add */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; params-&gt;n_flows; <span class="keywordtype">id</span>++) {</div>
<div class="line">        uint32_t pos = <span class="keywordtype">id</span> &amp; (N_FLOWS_BULK - 1);</div>
<div class="line"></div>
<div class="line">        key[pos].type = FLOW_KEY_QINQ;</div>
<div class="line">        key[pos].key.qinq.svlan = <span class="keywordtype">id</span> &gt;&gt; 12;</div>
<div class="line">        key[pos].key.qinq.cvlan = <span class="keywordtype">id</span> &amp; 0xFFF;</div>
<div class="line"></div>
<div class="line">        port_id[pos] = <span class="keywordtype">id</span> % params-&gt;n_ports;</div>
<div class="line">        flow_id[pos] = id;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((pos == N_FLOWS_BULK - 1) ||</div>
<div class="line">            (<span class="keywordtype">id</span> == params-&gt;n_flows - 1)) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            status = app_pipeline_fc_add_bulk(app,</div>
<div class="line">                params-&gt;pipeline_id,</div>
<div class="line">                key,</div>
<div class="line">                port_id,</div>
<div class="line">                flow_id,</div>
<div class="line">                pos + 1);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (status != 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory free */</span></div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_id);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(port_id);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_all_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, p_string,</div>
<div class="line">        <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_all_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, pipeline_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_all_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, flow_string,</div>
<div class="line">        <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_all_add_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, add_string,</div>
<div class="line">        <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_all_qinq_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, qinq_string,</div>
<div class="line">        <span class="stringliteral">&quot;qinq&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_qinq_all_all_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, all_string,</div>
<div class="line">        <span class="stringliteral">&quot;all&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_all_n_flows =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, n_flows,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_qinq_all_n_ports =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_qinq_all_result, n_ports,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_add_qinq_all = {</div>
<div class="line">    .f = cmd_fc_add_qinq_all_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow add all (Q-in-Q)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_add_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_qinq_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_all_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_n_flows,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_qinq_all_n_ports,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow add ipv4_5tuple</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_add_ipv4_5tuple_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t add_string;</div>
<div class="line">    cmdline_fixed_string_t ipv4_5tuple_string;</div>
<div class="line">    cmdline_ipaddr_t ip_src;</div>
<div class="line">    cmdline_ipaddr_t ip_dst;</div>
<div class="line">    uint16_t port_src;</div>
<div class="line">    uint16_t port_dst;</div>
<div class="line">    uint32_t proto;</div>
<div class="line">    cmdline_fixed_string_t port_string;</div>
<div class="line">    uint32_t <a class="code" href="structport.html">port</a>;</div>
<div class="line">    cmdline_fixed_string_t flowid_string;</div>
<div class="line">    uint32_t flow_id;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_add_ipv4_5tuple_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_add_ipv4_5tuple_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key key;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    memset(&amp;key, 0, <span class="keyword">sizeof</span>(key));</div>
<div class="line">    key.type = FLOW_KEY_IPV4_5TUPLE;</div>
<div class="line">    key.key.ipv4_5tuple.ip_src = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(</div>
<div class="line">        params-&gt;ip_src.addr.ipv4.s_addr);</div>
<div class="line">    key.key.ipv4_5tuple.ip_dst = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(</div>
<div class="line">        params-&gt;ip_dst.addr.ipv4.s_addr);</div>
<div class="line">    key.key.ipv4_5tuple.port_src = params-&gt;port_src;</div>
<div class="line">    key.key.ipv4_5tuple.port_dst = params-&gt;port_dst;</div>
<div class="line">    key.key.ipv4_5tuple.proto = params-&gt;proto;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_add(app,</div>
<div class="line">        params-&gt;pipeline_id,</div>
<div class="line">        &amp;key,</div>
<div class="line">        params-&gt;port,</div>
<div class="line">        params-&gt;flow_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, p_string,</div>
<div class="line">        <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, pipeline_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result,</div>
<div class="line">        flow_string, <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_add_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result,</div>
<div class="line">        add_string, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_ipv4_5tuple_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result,</div>
<div class="line">        ipv4_5tuple_string, <span class="stringliteral">&quot;ipv4_5tuple&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_add_ipv4_5tuple_ip_src =</div>
<div class="line">    TOKEN_IPV4_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, ip_src);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_add_ipv4_5tuple_ip_dst =</div>
<div class="line">    TOKEN_IPV4_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, ip_dst);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_port_src =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, port_src,</div>
<div class="line">        UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_port_dst =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, port_dst,</div>
<div class="line">        UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_proto =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, proto,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_port_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, port_string,</div>
<div class="line">        <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, <a class="code" href="structport.html">port</a>,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_flowid_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result,</div>
<div class="line">        flowid_string, <span class="stringliteral">&quot;flowid&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_flow_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_result, flow_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_add_ipv4_5tuple = {</div>
<div class="line">    .f = cmd_fc_add_ipv4_5tuple_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow add (IPv4 5-tuple)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_add_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_ipv4_5tuple_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_ip_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_ip_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_port_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_port_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_proto,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_port_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_flowid_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_flow_id,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow add ipv4_5tuple all</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_add_ipv4_5tuple_all_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t add_string;</div>
<div class="line">    cmdline_fixed_string_t ipv4_5tuple_string;</div>
<div class="line">    cmdline_fixed_string_t all_string;</div>
<div class="line">    uint32_t n_flows;</div>
<div class="line">    uint32_t n_ports;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_add_ipv4_5tuple_all_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_add_ipv4_5tuple_all_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key *key;</div>
<div class="line">    uint32_t *port_id;</div>
<div class="line">    uint32_t *flow_id;</div>
<div class="line">    uint32_t id;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input parameters */</span></div>
<div class="line">    <span class="keywordflow">if</span> (params-&gt;n_flows == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid number of flows\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (params-&gt;n_ports == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid number of ports\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    key = <a class="code" href="rte__malloc_8h.html#a58042061ad622f028aa2b97e8cb73a41">rte_zmalloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*key),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (key == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    port_id = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*port_id),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (port_id == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    flow_id = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*flow_id),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (flow_id == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(port_id);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Flow add */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; params-&gt;n_flows; <span class="keywordtype">id</span>++) {</div>
<div class="line">        uint32_t pos = <span class="keywordtype">id</span> &amp; (N_FLOWS_BULK - 1);</div>
<div class="line"></div>
<div class="line">        key[pos].type = FLOW_KEY_IPV4_5TUPLE;</div>
<div class="line">        key[pos].key.ipv4_5tuple.ip_src = 0;</div>
<div class="line">        key[pos].key.ipv4_5tuple.ip_dst = id;</div>
<div class="line">        key[pos].key.ipv4_5tuple.port_src = 0;</div>
<div class="line">        key[pos].key.ipv4_5tuple.port_dst = 0;</div>
<div class="line">        key[pos].key.ipv4_5tuple.proto = 6;</div>
<div class="line"></div>
<div class="line">        port_id[pos] = <span class="keywordtype">id</span> % params-&gt;n_ports;</div>
<div class="line">        flow_id[pos] = id;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((pos == N_FLOWS_BULK - 1) ||</div>
<div class="line">            (<span class="keywordtype">id</span> == params-&gt;n_flows - 1)) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            status = app_pipeline_fc_add_bulk(app,</div>
<div class="line">                params-&gt;pipeline_id,</div>
<div class="line">                key,</div>
<div class="line">                port_id,</div>
<div class="line">                flow_id,</div>
<div class="line">                pos + 1);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (status != 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory free */</span></div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_id);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(port_id);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_all_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_all_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        pipeline_id, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_all_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        flow_string, <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_all_add_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        add_string, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_all_ipv4_5tuple_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        ipv4_5tuple_string, <span class="stringliteral">&quot;ipv4_5tuple&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv4_5tuple_all_all_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        all_string, <span class="stringliteral">&quot;all&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_all_n_flows =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        n_flows, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv4_5tuple_all_n_ports =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv4_5tuple_all_result,</div>
<div class="line">        n_ports, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_add_ipv4_5tuple_all = {</div>
<div class="line">    .f = cmd_fc_add_ipv4_5tuple_all_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow add all (IPv4 5-tuple)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_add_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_ipv4_5tuple_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_all_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_n_flows,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv4_5tuple_all_n_ports,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow add ipv6_5tuple</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_add_ipv6_5tuple_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t add_string;</div>
<div class="line">    cmdline_fixed_string_t ipv6_5tuple_string;</div>
<div class="line">    cmdline_ipaddr_t ip_src;</div>
<div class="line">    cmdline_ipaddr_t ip_dst;</div>
<div class="line">    uint16_t port_src;</div>
<div class="line">    uint16_t port_dst;</div>
<div class="line">    uint32_t proto;</div>
<div class="line">    cmdline_fixed_string_t port_string;</div>
<div class="line">    uint32_t <a class="code" href="structport.html">port</a>;</div>
<div class="line">    cmdline_fixed_string_t flowid_string;</div>
<div class="line">    uint32_t flow_id;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_add_ipv6_5tuple_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_add_ipv6_5tuple_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key key;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    memset(&amp;key, 0, <span class="keyword">sizeof</span>(key));</div>
<div class="line">    key.type = FLOW_KEY_IPV6_5TUPLE;</div>
<div class="line">    memcpy(key.key.ipv6_5tuple.ip_src,</div>
<div class="line">        params-&gt;ip_src.addr.ipv6.s6_addr,</div>
<div class="line">        16);</div>
<div class="line">    memcpy(key.key.ipv6_5tuple.ip_dst,</div>
<div class="line">        params-&gt;ip_dst.addr.ipv6.s6_addr,</div>
<div class="line">        16);</div>
<div class="line">    key.key.ipv6_5tuple.port_src = params-&gt;port_src;</div>
<div class="line">    key.key.ipv6_5tuple.port_dst = params-&gt;port_dst;</div>
<div class="line">    key.key.ipv6_5tuple.proto = params-&gt;proto;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_add(app,</div>
<div class="line">        params-&gt;pipeline_id,</div>
<div class="line">        &amp;key,</div>
<div class="line">        params-&gt;port,</div>
<div class="line">        params-&gt;flow_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result,</div>
<div class="line">        p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, pipeline_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result,</div>
<div class="line">        flow_string, <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_add_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result,</div>
<div class="line">        add_string, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_ipv6_5tuple_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result,</div>
<div class="line">        ipv6_5tuple_string, <span class="stringliteral">&quot;ipv6_5tuple&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_add_ipv6_5tuple_ip_src =</div>
<div class="line">    TOKEN_IPV6_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, ip_src);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_add_ipv6_5tuple_ip_dst =</div>
<div class="line">    TOKEN_IPV6_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, ip_dst);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_port_src =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, port_src,</div>
<div class="line">        UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_port_dst =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, port_dst,</div>
<div class="line">        UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_proto =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, proto,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_port_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result,</div>
<div class="line">        port_string, <span class="stringliteral">&quot;port&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, <a class="code" href="structport.html">port</a>,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_flowid_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result,</div>
<div class="line">        flowid_string, <span class="stringliteral">&quot;flowid&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_flow_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_result, flow_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_add_ipv6_5tuple = {</div>
<div class="line">    .f = cmd_fc_add_ipv6_5tuple_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow add (IPv6 5-tuple)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_add_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_ipv6_5tuple_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_ip_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_ip_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_port_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_port_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_proto,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_port_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_flowid_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_flow_id,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow add ipv6_5tuple all</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_add_ipv6_5tuple_all_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t add_string;</div>
<div class="line">    cmdline_fixed_string_t ipv6_5tuple_string;</div>
<div class="line">    cmdline_fixed_string_t all_string;</div>
<div class="line">    uint32_t n_flows;</div>
<div class="line">    uint32_t n_ports;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_add_ipv6_5tuple_all_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_add_ipv6_5tuple_all_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key *key;</div>
<div class="line">    uint32_t *port_id;</div>
<div class="line">    uint32_t *flow_id;</div>
<div class="line">    uint32_t id;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check input parameters */</span></div>
<div class="line">    <span class="keywordflow">if</span> (params-&gt;n_flows == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid number of flows\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (params-&gt;n_ports == 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Invalid number of ports\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory allocation */</span></div>
<div class="line">    key = <a class="code" href="rte__malloc_8h.html#a58042061ad622f028aa2b97e8cb73a41">rte_zmalloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*key),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (key == NULL) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    port_id = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*port_id),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (port_id == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    flow_id = <a class="code" href="rte__malloc_8h.html#afb7316a4ec228ed9b8ffc1864b03d85b">rte_malloc</a>(NULL,</div>
<div class="line">        N_FLOWS_BULK * <span class="keyword">sizeof</span>(*flow_id),</div>
<div class="line">        RTE_CACHE_LINE_SIZE);</div>
<div class="line">    <span class="keywordflow">if</span> (flow_id == NULL) {</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(port_id);</div>
<div class="line">        <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Memory allocation failed\n&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Flow add */</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; params-&gt;n_flows; <span class="keywordtype">id</span>++) {</div>
<div class="line">        uint32_t pos = <span class="keywordtype">id</span> &amp; (N_FLOWS_BULK - 1);</div>
<div class="line">        uint32_t *x;</div>
<div class="line"></div>
<div class="line">        key[pos].type = FLOW_KEY_IPV6_5TUPLE;</div>
<div class="line">        x = (uint32_t *) key[pos].key.ipv6_5tuple.ip_dst;</div>
<div class="line">        *x = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(<span class="keywordtype">id</span>);</div>
<div class="line">        key[pos].key.ipv6_5tuple.proto = 6;</div>
<div class="line"></div>
<div class="line">        port_id[pos] = <span class="keywordtype">id</span> % params-&gt;n_ports;</div>
<div class="line">        flow_id[pos] = id;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ((pos == N_FLOWS_BULK - 1) ||</div>
<div class="line">            (<span class="keywordtype">id</span> == params-&gt;n_flows - 1)) {</div>
<div class="line">            <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">            status = app_pipeline_fc_add_bulk(app,</div>
<div class="line">                params-&gt;pipeline_id,</div>
<div class="line">                key,</div>
<div class="line">                port_id,</div>
<div class="line">                flow_id,</div>
<div class="line">                pos + 1);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (status != 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Memory free */</span></div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(flow_id);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(port_id);</div>
<div class="line">    <a class="code" href="rte__malloc_8h.html#a0bc2d94a40f12074f57ecfd83e07bb7c">rte_free</a>(key);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_all_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_all_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        pipeline_id, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_all_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        flow_string, <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_all_add_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        add_string, <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_all_ipv6_5tuple_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        ipv6_5tuple_string, <span class="stringliteral">&quot;ipv6_5tuple&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_ipv6_5tuple_all_all_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        all_string, <span class="stringliteral">&quot;all&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_all_n_flows =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        n_flows, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_ipv6_5tuple_all_n_ports =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_ipv6_5tuple_all_result,</div>
<div class="line">        n_ports, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_add_ipv6_5tuple_all = {</div>
<div class="line">    .f = cmd_fc_add_ipv6_5tuple_all_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow add all (ipv6 5-tuple)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_add_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_ipv6_5tuple_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_all_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_n_flows,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_ipv6_5tuple_all_n_ports,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow del qinq</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_del_qinq_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t del_string;</div>
<div class="line">    cmdline_fixed_string_t qinq_string;</div>
<div class="line">    uint16_t svlan;</div>
<div class="line">    uint16_t cvlan;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_del_qinq_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_del_qinq_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key key;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    memset(&amp;key, 0, <span class="keyword">sizeof</span>(key));</div>
<div class="line">    key.type = FLOW_KEY_QINQ;</div>
<div class="line">    key.key.qinq.svlan = params-&gt;svlan;</div>
<div class="line">    key.key.qinq.cvlan = params-&gt;cvlan;</div>
<div class="line">    status = app_pipeline_fc_del(app, params-&gt;pipeline_id, &amp;key);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_qinq_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_qinq_result, p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_qinq_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_qinq_result, pipeline_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_qinq_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_qinq_result, flow_string,</div>
<div class="line">        <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_qinq_del_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_qinq_result, del_string,</div>
<div class="line">        <span class="stringliteral">&quot;del&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_qinq_qinq_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_qinq_result, qinq_string,</div>
<div class="line">        <span class="stringliteral">&quot;qinq&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_qinq_svlan =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_qinq_result, svlan, UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_qinq_cvlan =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_qinq_result, cvlan, UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_del_qinq = {</div>
<div class="line">    .f = cmd_fc_del_qinq_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow delete (Q-in-Q)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_qinq_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_qinq_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_qinq_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_qinq_del_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_qinq_qinq_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_qinq_svlan,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_qinq_cvlan,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow del ipv4_5tuple</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_del_ipv4_5tuple_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t del_string;</div>
<div class="line">    cmdline_fixed_string_t ipv4_5tuple_string;</div>
<div class="line">    cmdline_ipaddr_t ip_src;</div>
<div class="line">    cmdline_ipaddr_t ip_dst;</div>
<div class="line">    uint16_t port_src;</div>
<div class="line">    uint16_t port_dst;</div>
<div class="line">    uint32_t proto;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_del_ipv4_5tuple_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_del_ipv4_5tuple_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key key;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    memset(&amp;key, 0, <span class="keyword">sizeof</span>(key));</div>
<div class="line">    key.type = FLOW_KEY_IPV4_5TUPLE;</div>
<div class="line">    key.key.ipv4_5tuple.ip_src = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(</div>
<div class="line">        params-&gt;ip_src.addr.ipv4.s_addr);</div>
<div class="line">    key.key.ipv4_5tuple.ip_dst = <a class="code" href="rte__byteorder_8h.html#aa1ddd507bcc0a87bbcfc5fdd9113094a">rte_bswap32</a>(</div>
<div class="line">        params-&gt;ip_dst.addr.ipv4.s_addr);</div>
<div class="line">    key.key.ipv4_5tuple.port_src = params-&gt;port_src;</div>
<div class="line">    key.key.ipv4_5tuple.port_dst = params-&gt;port_dst;</div>
<div class="line">    key.key.ipv4_5tuple.proto = params-&gt;proto;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_del(app, params-&gt;pipeline_id, &amp;key);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv4_5tuple_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv4_5tuple_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        pipeline_id, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv4_5tuple_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        flow_string, <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv4_5tuple_del_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        del_string, <span class="stringliteral">&quot;del&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv4_5tuple_ipv4_5tuple_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        ipv4_5tuple_string, <span class="stringliteral">&quot;ipv4_5tuple&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_del_ipv4_5tuple_ip_src =</div>
<div class="line">    TOKEN_IPV4_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        ip_src);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_del_ipv4_5tuple_ip_dst =</div>
<div class="line">    TOKEN_IPV4_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result, ip_dst);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv4_5tuple_port_src =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        port_src, UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv4_5tuple_port_dst =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        port_dst, UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv4_5tuple_proto =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv4_5tuple_result,</div>
<div class="line">        proto, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_del_ipv4_5tuple = {</div>
<div class="line">    .f = cmd_fc_del_ipv4_5tuple_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow delete (IPv4 5-tuple)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_del_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_ipv4_5tuple_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_ip_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_ip_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_port_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_port_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv4_5tuple_proto,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow del ipv6_5tuple</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_del_ipv6_5tuple_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t del_string;</div>
<div class="line">    cmdline_fixed_string_t ipv6_5tuple_string;</div>
<div class="line">    cmdline_ipaddr_t ip_src;</div>
<div class="line">    cmdline_ipaddr_t ip_dst;</div>
<div class="line">    uint16_t port_src;</div>
<div class="line">    uint16_t port_dst;</div>
<div class="line">    uint32_t proto;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_del_ipv6_5tuple_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_del_ipv6_5tuple_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keyword">struct </span>pipeline_fc_key key;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    memset(&amp;key, 0, <span class="keyword">sizeof</span>(key));</div>
<div class="line">    key.type = FLOW_KEY_IPV6_5TUPLE;</div>
<div class="line">    memcpy(key.key.ipv6_5tuple.ip_src,</div>
<div class="line">        params-&gt;ip_src.addr.ipv6.s6_addr,</div>
<div class="line">        16);</div>
<div class="line">    memcpy(key.key.ipv6_5tuple.ip_dst,</div>
<div class="line">        params-&gt;ip_dst.addr.ipv6.s6_addr,</div>
<div class="line">        16);</div>
<div class="line">    key.key.ipv6_5tuple.port_src = params-&gt;port_src;</div>
<div class="line">    key.key.ipv6_5tuple.port_dst = params-&gt;port_dst;</div>
<div class="line">    key.key.ipv6_5tuple.proto = params-&gt;proto;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_del(app, params-&gt;pipeline_id, &amp;key);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv6_5tuple_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result,</div>
<div class="line">        p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv6_5tuple_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result,</div>
<div class="line">        pipeline_id, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv6_5tuple_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result,</div>
<div class="line">        flow_string, <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv6_5tuple_del_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result,</div>
<div class="line">        del_string, <span class="stringliteral">&quot;del&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_ipv6_5tuple_ipv6_5tuple_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result,</div>
<div class="line">        ipv6_5tuple_string, <span class="stringliteral">&quot;ipv6_5tuple&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_del_ipv6_5tuple_ip_src =</div>
<div class="line">    TOKEN_IPV6_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result, ip_src);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_ipaddr_t cmd_fc_del_ipv6_5tuple_ip_dst =</div>
<div class="line">    TOKEN_IPV6_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result, ip_dst);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv6_5tuple_port_src =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result, port_src,</div>
<div class="line">        UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv6_5tuple_port_dst =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result, port_dst,</div>
<div class="line">        UINT16);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_ipv6_5tuple_proto =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_ipv6_5tuple_result, proto,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_del_ipv6_5tuple = {</div>
<div class="line">    .f = cmd_fc_del_ipv6_5tuple_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow delete (IPv6 5-tuple)&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_del_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_ipv6_5tuple_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_ip_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_ip_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_port_src,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_port_dst,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_ipv6_5tuple_proto,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow add default</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_add_default_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t add_string;</div>
<div class="line">    cmdline_fixed_string_t default_string;</div>
<div class="line">    uint32_t <a class="code" href="structport.html">port</a>;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_add_default_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_add_default_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_add_default(app, params-&gt;pipeline_id,</div>
<div class="line">        params-&gt;port);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_default_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_default_result, p_string,</div>
<div class="line">        <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_default_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_default_result, pipeline_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_default_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_default_result, flow_string,</div>
<div class="line">        <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_default_add_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_default_result, add_string,</div>
<div class="line">        <span class="stringliteral">&quot;add&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_add_default_default_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_default_result,</div>
<div class="line">        default_string, <span class="stringliteral">&quot;default&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_add_default_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_add_default_result, <a class="code" href="structport.html">port</a>, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_add_default = {</div>
<div class="line">    .f = cmd_fc_add_default_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow add default&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_default_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_default_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_default_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_default_add_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_default_default_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_add_default_port,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow del default</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_del_default_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t del_string;</div>
<div class="line">    cmdline_fixed_string_t default_string;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_del_default_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_del_default_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_del_default(app, params-&gt;pipeline_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_default_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_default_result, p_string,</div>
<div class="line">        <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_del_default_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_default_result, pipeline_id,</div>
<div class="line">        UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_default_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_default_result, flow_string,</div>
<div class="line">        <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_default_del_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_default_result, del_string,</div>
<div class="line">        <span class="stringliteral">&quot;del&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_del_default_default_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_del_default_result,</div>
<div class="line">        default_string, <span class="stringliteral">&quot;default&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_del_default = {</div>
<div class="line">    .f = cmd_fc_del_default_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow delete default&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_default_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_default_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_default_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_default_del_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_del_default_default_string,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * flow ls</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>cmd_fc_ls_result {</div>
<div class="line">    cmdline_fixed_string_t p_string;</div>
<div class="line">    uint32_t pipeline_id;</div>
<div class="line">    cmdline_fixed_string_t flow_string;</div>
<div class="line">    cmdline_fixed_string_t ls_string;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">cmd_fc_ls_parsed(</div>
<div class="line">    <span class="keywordtype">void</span> *parsed_result,</div>
<div class="line">    __attribute__((unused)) <span class="keyword">struct</span> cmdline *cl,</div>
<div class="line">    <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmd_fc_ls_result *params = parsed_result;</div>
<div class="line">    <span class="keyword">struct </span>app_params *app = data;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line"></div>
<div class="line">    status = app_pipeline_fc_ls(app, params-&gt;pipeline_id);</div>
<div class="line">    <span class="keywordflow">if</span> (status != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Command failed\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_ls_p_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_ls_result, p_string, <span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t cmd_fc_ls_pipeline_id =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> cmd_fc_ls_result, pipeline_id, UINT32);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_ls_flow_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_ls_result,</div>
<div class="line">    flow_string, <span class="stringliteral">&quot;flow&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_string_t cmd_fc_ls_ls_string =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> cmd_fc_ls_result, ls_string,</div>
<div class="line">    <span class="stringliteral">&quot;ls&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t cmd_fc_ls = {</div>
<div class="line">    .f = cmd_fc_ls_parsed,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;Flow list&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_ls_p_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_ls_pipeline_id,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_ls_flow_string,</div>
<div class="line">        (<span class="keywordtype">void</span> *) &amp;cmd_fc_ls_ls_string,</div>
<div class="line">        NULL,</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> cmdline_parse_ctx_t pipeline_cmds[] = {</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_add_qinq,</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_add_ipv4_5tuple,</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_add_ipv6_5tuple,</div>
<div class="line"></div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_del_qinq,</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_del_ipv4_5tuple,</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_del_ipv6_5tuple,</div>
<div class="line"></div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_add_default,</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_del_default,</div>
<div class="line"></div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_add_qinq_all,</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_add_ipv4_5tuple_all,</div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_add_ipv6_5tuple_all,</div>
<div class="line"></div>
<div class="line">    (cmdline_parse_inst_t *) &amp;cmd_fc_ls,</div>
<div class="line">    NULL,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>pipeline_fe_ops pipeline_flow_classification_fe_ops = {</div>
<div class="line">    .f_init = app_pipeline_fc_init,</div>
<div class="line">    .f_free = app_pipeline_fc_free,</div>
<div class="line">    .cmds = pipeline_cmds,</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>pipeline_type pipeline_flow_classification = {</div>
<div class="line">    .name = <span class="stringliteral">&quot;FLOW_CLASSIFICATION&quot;</span>,</div>
<div class="line">    .be_ops = &amp;pipeline_flow_classification_be_ops,</div>
<div class="line">    .fe_ops = &amp;pipeline_flow_classification_fe_ops,</div>
<div class="line">};</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>DPDK: ethtool/ethtool-app/ethapp.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DPDK
   &#160;<span id="projectnumber">16.04.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ethtool/ethtool-app/ethapp.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/*-</span></div>
<div class="line"><span class="comment"> *   BSD LICENSE</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Copyright(c) 2015 Intel Corporation. All rights reserved.</span></div>
<div class="line"><span class="comment"> *   All rights reserved.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment"> *   modification, are permitted provided that the following conditions</span></div>
<div class="line"><span class="comment"> *   are met:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment"> *     * Redistributions in binary form must reproduce the above copyright</span></div>
<div class="line"><span class="comment"> *       notice, this list of conditions and the following disclaimer in</span></div>
<div class="line"><span class="comment"> *       the documentation and/or other materials provided with the</span></div>
<div class="line"><span class="comment"> *       distribution.</span></div>
<div class="line"><span class="comment"> *     * Neither the name of Intel Corporation nor the names of its</span></div>
<div class="line"><span class="comment"> *       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment"> *       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment"> *   &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment"> *   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment"> *   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment"> *   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment"> *   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment"> *   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment"> *   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment"> *   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment"> *   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse_num.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse_string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_parse_etheraddr.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmdline_socket.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cmdline_8h.html">cmdline.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;rte_ethtool.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ethapp.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define EEPROM_DUMP_CHUNKSIZE 1024</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line"><span class="keyword">struct </span>pcmd_get_params {</div>
<div class="line">    cmdline_fixed_string_t cmd;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>pcmd_int_params {</div>
<div class="line">    cmdline_fixed_string_t cmd;</div>
<div class="line">    uint16_t <a name="_a0"></a><a class="code" href="structport.html">port</a>;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>pcmd_intstr_params {</div>
<div class="line">    cmdline_fixed_string_t cmd;</div>
<div class="line">    uint16_t <a class="code" href="structport.html">port</a>;</div>
<div class="line">    cmdline_fixed_string_t opt;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>pcmd_intmac_params {</div>
<div class="line">    cmdline_fixed_string_t cmd;</div>
<div class="line">    uint16_t <a class="code" href="structport.html">port</a>;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structether__addr.html">ether_addr</a> mac;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>pcmd_str_params {</div>
<div class="line">    cmdline_fixed_string_t cmd;</div>
<div class="line">    cmdline_fixed_string_t opt;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>pcmd_vlan_params {</div>
<div class="line">    cmdline_fixed_string_t cmd;</div>
<div class="line">    uint16_t <a class="code" href="structport.html">port</a>;</div>
<div class="line">    cmdline_fixed_string_t mode;</div>
<div class="line">    uint16_t vid;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>pcmd_intintint_params {</div>
<div class="line">    cmdline_fixed_string_t cmd;</div>
<div class="line">    uint16_t <a class="code" href="structport.html">port</a>;</div>
<div class="line">    uint16_t tx;</div>
<div class="line">    uint16_t rx;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Parameter-less commands */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_quit_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_get_params, cmd, <span class="stringliteral">&quot;quit&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_stats_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_get_params, cmd, <span class="stringliteral">&quot;stats&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_drvinfo_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_get_params, cmd, <span class="stringliteral">&quot;drvinfo&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_link_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_get_params, cmd, <span class="stringliteral">&quot;link&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Commands taking just port id */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_open_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_int_params, cmd, <span class="stringliteral">&quot;open&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_stop_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_int_params, cmd, <span class="stringliteral">&quot;stop&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_rxmode_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_int_params, cmd, <span class="stringliteral">&quot;rxmode&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_portstats_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_int_params, cmd, <span class="stringliteral">&quot;portstats&quot;</span>);</div>
<div class="line">cmdline_parse_token_num_t pcmd_int_token_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_int_params, <a class="code" href="structport.html">port</a>, UINT16);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Commands taking port id and string */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_eeprom_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params, cmd, <span class="stringliteral">&quot;eeprom&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_mtu_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params, cmd, <span class="stringliteral">&quot;mtu&quot;</span>);</div>
<div class="line">cmdline_parse_token_string_t pcmd_regs_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params, cmd, <span class="stringliteral">&quot;regs&quot;</span>);</div>
<div class="line"></div>
<div class="line">cmdline_parse_token_num_t pcmd_intstr_token_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params, <a class="code" href="structport.html">port</a>, UINT16);</div>
<div class="line">cmdline_parse_token_string_t pcmd_intstr_token_opt =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params, opt, NULL);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Commands taking port id and a MAC address string */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_macaddr_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intmac_params, cmd, <span class="stringliteral">&quot;macaddr&quot;</span>);</div>
<div class="line">cmdline_parse_token_num_t pcmd_intmac_token_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_intmac_params, <a class="code" href="structport.html">port</a>, UINT16);</div>
<div class="line">cmdline_parse_token_etheraddr_t pcmd_intmac_token_mac =</div>
<div class="line">    TOKEN_ETHERADDR_INITIALIZER(<span class="keyword">struct</span> pcmd_intmac_params, mac);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Command taking just a MAC address */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_validate_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intmac_params, cmd, <span class="stringliteral">&quot;validate&quot;</span>);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Commands taking port id and two integers */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_ringparam_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intintint_params, cmd,</div>
<div class="line">        <span class="stringliteral">&quot;ringparam&quot;</span>);</div>
<div class="line">cmdline_parse_token_num_t pcmd_intintint_token_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_intintint_params, <a class="code" href="structport.html">port</a>, UINT16);</div>
<div class="line">cmdline_parse_token_num_t pcmd_intintint_token_tx =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_intintint_params, tx, UINT16);</div>
<div class="line">cmdline_parse_token_num_t pcmd_intintint_token_rx =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_intintint_params, rx, UINT16);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Pause commands */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_pause_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params, cmd, <span class="stringliteral">&quot;pause&quot;</span>);</div>
<div class="line">cmdline_parse_token_num_t pcmd_pause_token_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params, <a class="code" href="structport.html">port</a>, UINT16);</div>
<div class="line">cmdline_parse_token_string_t pcmd_pause_token_opt =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_intstr_params,</div>
<div class="line">        opt, <span class="stringliteral">&quot;all#tx#rx#none&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* VLAN commands */</span></div>
<div class="line">cmdline_parse_token_string_t pcmd_vlan_token_cmd =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_vlan_params, cmd, <span class="stringliteral">&quot;vlan&quot;</span>);</div>
<div class="line">cmdline_parse_token_num_t pcmd_vlan_token_port =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_vlan_params, <a class="code" href="structport.html">port</a>, UINT16);</div>
<div class="line">cmdline_parse_token_string_t pcmd_vlan_token_mode =</div>
<div class="line">    TOKEN_STRING_INITIALIZER(<span class="keyword">struct</span> pcmd_vlan_params, mode, <span class="stringliteral">&quot;add#del&quot;</span>);</div>
<div class="line">cmdline_parse_token_num_t pcmd_vlan_token_vid =</div>
<div class="line">    TOKEN_NUM_INITIALIZER(<span class="keyword">struct</span> pcmd_vlan_params, vid, UINT16);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_quit_callback(<a name="a2"></a><a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    cmdline_quit(ctx);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_drvinfo_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>ethtool_drvinfo info;</div>
<div class="line">    <span class="keywordtype">int</span> id_port;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (id_port = 0; id_port &lt; <a name="a3"></a><a class="code" href="rte__ethdev_8h.html#ac228551f31e57645c7bb5efd1db2e63d">rte_eth_dev_count</a>(); id_port++) {</div>
<div class="line">        <span class="keywordflow">if</span> (rte_ethtool_get_drvinfo(id_port, &amp;info)) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error getting info for port %i\n&quot;</span>, id_port);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i driver: %s (ver: %s)\n&quot;</span>,</div>
<div class="line">            id_port, info.driver, info.version</div>
<div class="line">              );</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_link_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> num_ports = <a class="code" href="rte__ethdev_8h.html#ac228551f31e57645c7bb5efd1db2e63d">rte_eth_dev_count</a>();</div>
<div class="line">    <span class="keywordtype">int</span> id_port, stat_port;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (id_port = 0; id_port &lt; num_ports; id_port++) {</div>
<div class="line">        <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(id_port))</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        stat_port = rte_ethtool_get_link(id_port);</div>
<div class="line">        <span class="keywordflow">switch</span> (stat_port) {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i: Down\n&quot;</span>, id_port);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i: Up\n&quot;</span>, id_port);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i: Error getting link status\n&quot;</span>,</div>
<div class="line">                id_port</div>
<div class="line">                );</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_regs_callback(<span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intstr_params *params = ptr_params;</div>
<div class="line">    <span class="keywordtype">int</span> len_regs;</div>
<div class="line">    <span class="keyword">struct </span>ethtool_regs regs;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf_data;</div>
<div class="line">    FILE *fp_regs;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    len_regs = rte_ethtool_get_regs_len(params-&gt;port);</div>
<div class="line">    <span class="keywordflow">if</span> (len_regs &gt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: %i bytes\n&quot;</span>, params-&gt;port, len_regs);</div>
<div class="line">        buf_data = malloc(len_regs);</div>
<div class="line">        <span class="keywordflow">if</span> (buf_data == NULL) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error allocating %i bytes for buffer\n&quot;</span>,</div>
<div class="line">                len_regs);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!rte_ethtool_get_regs(params-&gt;port, &amp;regs, buf_data)) {</div>
<div class="line">            fp_regs = fopen(params-&gt;opt, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line">            <span class="keywordflow">if</span> (fp_regs == NULL) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Error opening &#39;%s&#39; for writing\n&quot;</span>,</div>
<div class="line">                    params-&gt;opt);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)fwrite(buf_data,</div>
<div class="line">                        1, len_regs,</div>
<div class="line">                        fp_regs) != len_regs)</div>
<div class="line">                    printf(<span class="stringliteral">&quot;Error writing &#39;%s&#39;\n&quot;</span>,</div>
<div class="line">                        params-&gt;opt);</div>
<div class="line">                fclose(fp_regs);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        free(buf_data);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len_regs == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error getting registers\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_eeprom_callback(<span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intstr_params *params = ptr_params;</div>
<div class="line">    <span class="keyword">struct </span>ethtool_eeprom info_eeprom;</div>
<div class="line">    <span class="keywordtype">int</span> len_eeprom;</div>
<div class="line">    <span class="keywordtype">int</span> pos_eeprom;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> bytes_eeprom[EEPROM_DUMP_CHUNKSIZE];</div>
<div class="line">    FILE *fp_eeprom;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    len_eeprom = rte_ethtool_get_eeprom_len(params-&gt;port);</div>
<div class="line">    <span class="keywordflow">if</span> (len_eeprom &gt; 0) {</div>
<div class="line">        fp_eeprom = fopen(params-&gt;opt, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (fp_eeprom == NULL) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error opening &#39;%s&#39; for writing\n&quot;</span>,</div>
<div class="line">                params-&gt;opt);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        printf(<span class="stringliteral">&quot;Total EEPROM length: %i bytes\n&quot;</span>, len_eeprom);</div>
<div class="line">        info_eeprom.len = EEPROM_DUMP_CHUNKSIZE;</div>
<div class="line">        <span class="keywordflow">for</span> (pos_eeprom = 0;</div>
<div class="line">                pos_eeprom &lt; len_eeprom;</div>
<div class="line">                pos_eeprom += EEPROM_DUMP_CHUNKSIZE) {</div>
<div class="line">            info_eeprom.offset = pos_eeprom;</div>
<div class="line">            <span class="keywordflow">if</span> (pos_eeprom + EEPROM_DUMP_CHUNKSIZE &gt; len_eeprom)</div>
<div class="line">                info_eeprom.len = len_eeprom - pos_eeprom;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">                info_eeprom.len = EEPROM_DUMP_CHUNKSIZE;</div>
<div class="line">            stat = rte_ethtool_get_eeprom(</div>
<div class="line">                params-&gt;port, &amp;info_eeprom, bytes_eeprom</div>
<div class="line">                );</div>
<div class="line">            <span class="keywordflow">if</span> (stat != 0) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;EEPROM read error %i\n&quot;</span>, stat);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (fwrite(bytes_eeprom,</div>
<div class="line">                    1, info_eeprom.len,</div>
<div class="line">                    fp_eeprom) != info_eeprom.len) {</div>
<div class="line">                printf(<span class="stringliteral">&quot;Error writing &#39;%s&#39;\n&quot;</span>, params-&gt;opt);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        fclose(fp_eeprom);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len_eeprom == 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Device does not have EEPROM\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len_eeprom == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error getting EEPROM\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_pause_callback(<span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intstr_params *params = ptr_params;</div>
<div class="line">    <span class="keyword">struct </span>ethtool_pauseparam info;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (ptr_data != NULL) {</div>
<div class="line">        stat = rte_ethtool_get_pauseparam(params-&gt;port, &amp;info);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        memset(&amp;info, 0, <span class="keyword">sizeof</span>(info));</div>
<div class="line">        <span class="keywordflow">if</span> (strcasecmp(<span class="stringliteral">&quot;all&quot;</span>, params-&gt;opt) == 0) {</div>
<div class="line">            info.tx_pause = 1;</div>
<div class="line">            info.rx_pause = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(<span class="stringliteral">&quot;tx&quot;</span>, params-&gt;opt) == 0) {</div>
<div class="line">            info.tx_pause = 1;</div>
<div class="line">            info.rx_pause = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(<span class="stringliteral">&quot;rx&quot;</span>, params-&gt;opt) == 0) {</div>
<div class="line">            info.tx_pause = 0;</div>
<div class="line">            info.rx_pause = 1;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            info.tx_pause = 0;</div>
<div class="line">            info.rx_pause = 0;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* Assume auto-negotiation wanted */</span></div>
<div class="line">        info.autoneg = 1;</div>
<div class="line">        stat = rte_ethtool_set_pauseparam(params-&gt;port, &amp;info);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (stat == 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (info.rx_pause &amp;&amp; info.tx_pause)</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i: Tx &amp; Rx Paused\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.rx_pause)</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i: Rx Paused\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info.tx_pause)</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i: Tx Paused\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i: Tx &amp; Rx not paused\n&quot;</span>, params-&gt;port);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error %i\n&quot;</span>, params-&gt;port, stat);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_open_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_int_params *params = ptr_params;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    lock_port(params-&gt;port);</div>
<div class="line">    stat = rte_ethtool_net_open(params-&gt;port);</div>
<div class="line">    mark_port_active(params-&gt;port);</div>
<div class="line">    unlock_port(params-&gt;port);</div>
<div class="line">    <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error opening device\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_stop_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_int_params *params = ptr_params;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    lock_port(params-&gt;port);</div>
<div class="line">    stat = rte_ethtool_net_stop(params-&gt;port);</div>
<div class="line">    mark_port_inactive(params-&gt;port);</div>
<div class="line">    unlock_port(params-&gt;port);</div>
<div class="line">    <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error stopping device\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_rxmode_callback(<span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intstr_params *params = ptr_params;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    stat = rte_ethtool_net_set_rx_mode(params-&gt;port);</div>
<div class="line">    <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error setting rx mode\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_macaddr_callback(<span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intmac_params *params = ptr_params;</div>
<div class="line">    <span class="keyword">struct </span><a class="code" href="structether__addr.html">ether_addr</a> mac_addr;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    stat = 0;</div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (ptr_data != NULL) {</div>
<div class="line">        lock_port(params-&gt;port);</div>
<div class="line">        stat = rte_ethtool_net_set_mac_addr(params-&gt;port,</div>
<div class="line">            &amp;params-&gt;mac);</div>
<div class="line">        mark_port_newmac(params-&gt;port);</div>
<div class="line">        unlock_port(params-&gt;port);</div>
<div class="line">        <span class="keywordflow">if</span> (stat == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;MAC address changed\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        stat = rte_ethtool_net_get_mac_addr(params-&gt;port, &amp;mac_addr);</div>
<div class="line">        <span class="keywordflow">if</span> (stat == 0) {</div>
<div class="line">            printf(</div>
<div class="line">                <span class="stringliteral">&quot;Port %i MAC Address: %02x:%02x:%02x:%02x:%02x:%02x\n&quot;</span>,</div>
<div class="line">                params-&gt;port,</div>
<div class="line">                mac_addr.addr_bytes[0],</div>
<div class="line">                mac_addr.addr_bytes[1],</div>
<div class="line">                mac_addr.addr_bytes[2],</div>
<div class="line">                mac_addr.addr_bytes[3],</div>
<div class="line">                mac_addr.addr_bytes[4],</div>
<div class="line">                mac_addr.addr_bytes[5]);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Port %i: Error %s\n&quot;</span>, params-&gt;port,</div>
<div class="line">           strerror(-stat));</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">pcmd_mtu_callback(<span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intstr_params *params = ptr_params;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line">    <span class="keywordtype">int</span> new_mtu;</div>
<div class="line">    <span class="keywordtype">char</span> *ptr_parse_end;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    new_mtu = atoi(params-&gt;opt);</div>
<div class="line">    new_mtu = strtoul(params-&gt;opt, &amp;ptr_parse_end, 10);</div>
<div class="line">    <span class="keywordflow">if</span> (*ptr_parse_end != <span class="charliteral">&#39;\0&#39;</span> ||</div>
<div class="line">            new_mtu &lt; <a name="a4"></a><a class="code" href="rte__ether_8h.html#af245921a8e199c83853d7976db4c3902">ETHER_MIN_MTU</a> ||</div>
<div class="line">            new_mtu &gt; <a name="a5"></a><a class="code" href="rte__ether_8h.html#af0ddc37d50d201f80a0c8d433cace675">ETHER_MAX_JUMBO_FRAME_LEN</a>) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Invalid MTU value\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    stat = rte_ethtool_net_change_mtu(params-&gt;port, new_mtu);</div>
<div class="line">    <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: MTU set to %i\n&quot;</span>, params-&gt;port, new_mtu);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error setting MTU\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> pcmd_portstats_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_int_params *params = ptr_params;</div>
<div class="line">    <span class="keyword">struct </span><a name="_a6"></a><a class="code" href="structrte__eth__stats.html">rte_eth_stats</a> stat_info;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    stat = rte_ethtool_net_get_stats64(params-&gt;port, &amp;stat_info);</div>
<div class="line">    <span class="keywordflow">if</span> (stat == 0) {</div>
<div class="line">        <span class="comment">/* Most of rte_eth_stats is deprecated.. */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i stats\n&quot;</span>, params-&gt;port);</div>
<div class="line">        printf(<span class="stringliteral">&quot;   In: %&quot;</span> PRIu64 <span class="stringliteral">&quot; (%&quot;</span> PRIu64 <span class="stringliteral">&quot; bytes)\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;  Out: %&quot;</span>PRIu64<span class="stringliteral">&quot; (%&quot;</span>PRIu64 <span class="stringliteral">&quot; bytes)\n&quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;  Err: %&quot;</span>PRIu64<span class="stringliteral">&quot;\n&quot;</span>,</div>
<div class="line">            stat_info.ipackets,</div>
<div class="line">            stat_info.ibytes,</div>
<div class="line">            stat_info.opackets,</div>
<div class="line">            stat_info.obytes,</div>
<div class="line">            stat_info.ierrors+stat_info.oerrors</div>
<div class="line">              );</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error fetching statistics\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> pcmd_ringparam_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intintint_params *params = ptr_params;</div>
<div class="line">    <span class="keyword">struct </span>ethtool_ringparam ring_data;</div>
<div class="line">    <span class="keyword">struct </span>ethtool_ringparam ring_params;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (ptr_data == NULL) {</div>
<div class="line">        stat = rte_ethtool_get_ringparam(params-&gt;port, &amp;ring_data);</div>
<div class="line">        <span class="keywordflow">if</span> (stat == 0) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Port %i ring parameters\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  Rx Pending: %i (%i max)\n&quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;  Tx Pending: %i (%i max)\n&quot;</span>,</div>
<div class="line">                params-&gt;port,</div>
<div class="line">                ring_data.rx_pending,</div>
<div class="line">                ring_data.rx_max_pending,</div>
<div class="line">                ring_data.tx_pending,</div>
<div class="line">                ring_data.tx_max_pending);</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (params-&gt;tx &lt; 1 || params-&gt;rx &lt; 1) {</div>
<div class="line">            printf(<span class="stringliteral">&quot;Error: Invalid parameters\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line">        memset(&amp;ring_params, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> ethtool_ringparam));</div>
<div class="line">        ring_params.tx_pending = params-&gt;tx;</div>
<div class="line">        ring_params.rx_pending = params-&gt;rx;</div>
<div class="line">        lock_port(params-&gt;port);</div>
<div class="line">        stat = rte_ethtool_set_ringparam(params-&gt;port, &amp;ring_params);</div>
<div class="line">        unlock_port(params-&gt;port);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error fetching statistics\n&quot;</span>, params-&gt;port);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> pcmd_validate_callback(<span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_intmac_params *params = ptr_params;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (rte_ethtool_net_validate_addr(0, &amp;params-&gt;mac))</div>
<div class="line">        printf(<span class="stringliteral">&quot;Address is unicast\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Address is not unicast\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> pcmd_vlan_callback(<a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_params,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keyword">struct</span> cmdline *ctx,</div>
<div class="line">    <a class="code" href="rte__common_8h.html#ae1a7c8799cb57669ae2ddf367b21533f">__rte_unused</a> <span class="keywordtype">void</span> *ptr_data)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>pcmd_vlan_params *params = ptr_params;</div>
<div class="line">    <span class="keywordtype">int</span> stat;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (!rte_eth_dev_is_valid_port(params-&gt;port)) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Invalid port number %i\n&quot;</span>, params-&gt;port);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    stat = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (strcasecmp(<span class="stringliteral">&quot;add&quot;</span>, params-&gt;mode) == 0) {</div>
<div class="line">        stat = rte_ethtool_net_vlan_rx_add_vid(</div>
<div class="line">            params-&gt;port, params-&gt;vid</div>
<div class="line">            );</div>
<div class="line">        <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line">            printf(<span class="stringliteral">&quot;VLAN vid %i added\n&quot;</span>, params-&gt;vid);</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(<span class="stringliteral">&quot;del&quot;</span>, params-&gt;mode) == 0) {</div>
<div class="line">        stat = rte_ethtool_net_vlan_rx_kill_vid(</div>
<div class="line">            params-&gt;port, params-&gt;vid</div>
<div class="line">            );</div>
<div class="line">        <span class="keywordflow">if</span> (stat == 0)</div>
<div class="line">            printf(<span class="stringliteral">&quot;VLAN vid %i removed\n&quot;</span>, params-&gt;vid);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">/* Should not happen! */</span></div>
<div class="line">        printf(<span class="stringliteral">&quot;Error: Bad mode %s\n&quot;</span>, params-&gt;mode);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (stat == -ENOTSUP)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Operation not supported\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat == -ENOSYS)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: VLAN filtering disabled\n&quot;</span>, params-&gt;port);</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stat != 0)</div>
<div class="line">        printf(<span class="stringliteral">&quot;Port %i: Error changing VLAN setup (code %i)\n&quot;</span>,</div>
<div class="line">            params-&gt;port, -stat);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">cmdline_parse_inst_t pcmd_quit = {</div>
<div class="line">    .f = pcmd_quit_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;quit\n     Exit program&quot;</span>,</div>
<div class="line">    .tokens = {(<span class="keywordtype">void</span> *)&amp;pcmd_quit_token_cmd, NULL},</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_drvinfo = {</div>
<div class="line">    .f = pcmd_drvinfo_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;drvinfo\n     Print driver info&quot;</span>,</div>
<div class="line">    .tokens = {(<span class="keywordtype">void</span> *)&amp;pcmd_drvinfo_token_cmd, NULL},</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_link = {</div>
<div class="line">    .f = pcmd_link_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;link\n     Print port link states&quot;</span>,</div>
<div class="line">    .tokens = {(<span class="keywordtype">void</span> *)&amp;pcmd_link_token_cmd, NULL},</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_regs = {</div>
<div class="line">    .f = pcmd_regs_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;regs &lt;port_id&gt; &lt;filename&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Dump port register(s) to file&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_regs_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intstr_token_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intstr_token_opt,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_eeprom = {</div>
<div class="line">    .f = pcmd_eeprom_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;eeprom &lt;port_id&gt; &lt;filename&gt;\n    Dump EEPROM to file&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_eeprom_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intstr_token_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intstr_token_opt,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_pause_noopt = {</div>
<div class="line">    .f = pcmd_pause_callback,</div>
<div class="line">    .data = (<span class="keywordtype">void</span> *)0x01,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;pause &lt;port_id&gt;\n     Print port pause state&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_pause_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_pause_token_port,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_pause = {</div>
<div class="line">    .f = pcmd_pause_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str =</div>
<div class="line">        <span class="stringliteral">&quot;pause &lt;port_id&gt; &lt;all|tx|rx|none&gt;\n     Pause/unpause port&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_pause_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_pause_token_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_pause_token_opt,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_open = {</div>
<div class="line">    .f = pcmd_open_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;open &lt;port_id&gt;\n     Open port&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_open_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_int_token_port,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_stop = {</div>
<div class="line">    .f = pcmd_stop_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;stop &lt;port_id&gt;\n     Stop port&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_stop_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_int_token_port,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_rxmode = {</div>
<div class="line">    .f = pcmd_rxmode_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;rxmode &lt;port_id&gt;\n     Toggle port Rx mode&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_rxmode_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_int_token_port,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_macaddr_get = {</div>
<div class="line">    .f = pcmd_macaddr_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;macaddr &lt;port_id&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Get MAC address&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_macaddr_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intstr_token_port,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_macaddr = {</div>
<div class="line">    .f = pcmd_macaddr_callback,</div>
<div class="line">    .data = (<span class="keywordtype">void</span> *)0x01,</div>
<div class="line">    .help_str =</div>
<div class="line">        <span class="stringliteral">&quot;macaddr &lt;port_id&gt; &lt;mac_addr&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Set MAC address&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_macaddr_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intmac_token_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intmac_token_mac,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_mtu = {</div>
<div class="line">    .f = pcmd_mtu_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;mtu &lt;port_id&gt; &lt;mtu_value&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Change MTU&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_mtu_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intstr_token_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intstr_token_opt,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_portstats = {</div>
<div class="line">    .f = pcmd_portstats_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;portstats &lt;port_id&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Print port eth statistics&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_portstats_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_int_token_port,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_ringparam = {</div>
<div class="line">    .f = pcmd_ringparam_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;ringparam &lt;port_id&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Print ring parameters&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_ringparam_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intintint_token_port,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_ringparam_set = {</div>
<div class="line">    .f = pcmd_ringparam_callback,</div>
<div class="line">    .data = (<span class="keywordtype">void</span> *)1,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;ringparam &lt;port_id&gt; &lt;tx_param&gt; &lt;rx_param&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Set ring parameters&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_ringparam_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intintint_token_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intintint_token_tx,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intintint_token_rx,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_validate = {</div>
<div class="line">    .f = pcmd_validate_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;validate &lt;mac_addr&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Check that MAC address is valid unicast address&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_validate_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_intmac_token_mac,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line">cmdline_parse_inst_t pcmd_vlan = {</div>
<div class="line">    .f = pcmd_vlan_callback,</div>
<div class="line">    .data = NULL,</div>
<div class="line">    .help_str = <span class="stringliteral">&quot;vlan &lt;port_id&gt; &lt;add|del&gt; &lt;vlan_id&gt;\n&quot;</span></div>
<div class="line">        <span class="stringliteral">&quot;     Add/remove VLAN id&quot;</span>,</div>
<div class="line">    .tokens = {</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_vlan_token_cmd,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_vlan_token_port,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_vlan_token_mode,</div>
<div class="line">        (<span class="keywordtype">void</span> *)&amp;pcmd_vlan_token_vid,</div>
<div class="line">        NULL</div>
<div class="line">    },</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">cmdline_parse_ctx_t list_prompt_commands[] = {</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_drvinfo,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_eeprom,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_link,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_macaddr_get,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_macaddr,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_mtu,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_open,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_pause_noopt,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_pause,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_portstats,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_regs,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_ringparam,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_ringparam_set,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_rxmode,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_stop,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_validate,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_vlan,</div>
<div class="line">    (cmdline_parse_inst_t *)&amp;pcmd_quit,</div>
<div class="line">    NULL</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> ethapp_main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cmdline *ctx_cmdline;</div>
<div class="line"></div>
<div class="line">    ctx_cmdline = cmdline_stdin_new(list_prompt_commands, <span class="stringliteral">&quot;EthApp&gt; &quot;</span>);</div>
<div class="line">    cmdline_interact(ctx_cmdline);</div>
<div class="line">    cmdline_stdin_exit(ctx_cmdline);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Quick Start Setup Script &mdash; Data Plane Development Kit 16.04.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Data Plane Development Kit 16.04.0 documentation" href="../index.html"/>
        <link rel="up" title="Getting Started Guide for Linux" href="index.html"/>
        <link rel="next" title="7. How to get best performance with NICs on Intel platforms" href="nic_perf_intel_platform.html"/>
        <link rel="prev" title="5. Enabling Additional Functionality" href="enable_func.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Data Plane Development Kit
          

          
            
            <img src="../_static/DPDK_logo_vertical_rev_small.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                16.04.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started Guide for Linux</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="sys_reqs.html">2. System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_dpdk.html">3. Compiling the DPDK Target from Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_sample_apps.html">4. Compiling and Running Sample Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="enable_func.html">5. Enabling Additional Functionality</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">6. Quick Start Setup Script</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#script-organization">6.1. Script Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-cases">6.2. Use Cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#applications">6.3. Applications</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nic_perf_intel_platform.html">7. How to get best performance with NICs on Intel platforms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd_gsg/index.html">Getting Started Guide for FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xen/index.html">Xen Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prog_guide/index.html">Programmer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nics/index.html">Network Interface Controller Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cryptodevs/index.html">Crypto Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sample_app_ug/index.html">Sample Applications User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testpmd_app_ug/index.html">Testpmd Application User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rel_notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributor&#8217;s Guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Data Plane Development Kit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Getting Started Guide for Linux</a> &raquo;</li>
      
    <li>6. Quick Start Setup Script</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/linux_gsg/quick_start.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-start-setup-script">
<span id="linux-setup-script"></span><h1>6. Quick Start Setup Script</h1>
<p>The setup.sh script, found in the tools subdirectory, allows the user to perform the following tasks:</p>
<ul class="simple">
<li>Build the DPDK libraries</li>
<li>Insert and remove the DPDK IGB_UIO kernel module</li>
<li>Insert and remove VFIO kernel modules</li>
<li>Insert and remove the DPDK KNI kernel module</li>
<li>Create and delete hugepages for NUMA and non-NUMA cases</li>
<li>View network port status and reserve ports for DPDK application use</li>
<li>Set up permissions for using VFIO as a non-privileged user</li>
<li>Run the test and testpmd applications</li>
<li>Look at hugepages in the meminfo</li>
<li>List hugepages in <code class="docutils literal"><span class="pre">/mnt/huge</span></code></li>
<li>Remove built DPDK libraries</li>
</ul>
<p>Once these steps have been completed for one of the EAL targets,
the user may compile their own application that links in the EAL libraries to create the DPDK image.</p>
<div class="section" id="script-organization">
<h2>6.1. Script Organization</h2>
<p>The setup.sh script is logically organized into a series of steps that a user performs in sequence.
Each step provides a number of options that guide the user to completing the desired task.
The following is a brief synopsis of each step.</p>
<p><strong>Step 1: Build DPDK Libraries</strong></p>
<p>Initially, the user must select a DPDK target to choose the correct target type and compiler options to use when building the libraries.</p>
<p>The user must have all libraries, modules, updates and compilers installed in the system prior to this,
as described in the earlier chapters in this Getting Started Guide.</p>
<p><strong>Step 2: Setup Environment</strong></p>
<p>The user configures the Linux* environment to support the running of DPDK applications.
Hugepages can be set up for NUMA or non-NUMA systems. Any existing hugepages will be removed.
The DPDK kernel module that is needed can also be inserted in this step,
and network ports may be bound to this module for DPDK application use.</p>
<p><strong>Step 3: Run an Application</strong></p>
<p>The user may run the test application once the other steps have been performed.
The test application allows the user to run a series of functional tests for the DPDK.
The testpmd application, which supports the receiving and sending of packets, can also be run.</p>
<p><strong>Step 4: Examining the System</strong></p>
<p>This step provides some tools for examining the status of hugepage mappings.</p>
<p><strong>Step 5: System Cleanup</strong></p>
<p>The final step has options for restoring the system to its original state.</p>
</div>
<div class="section" id="use-cases">
<h2>6.2. Use Cases</h2>
<p>The following are some example of how to use the setup.sh script.
The script should be run using the source command.
Some options in the script prompt the user for further data before proceeding.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The setup.sh script should be run with root privileges.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">source tools/setup.sh</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">RTE_SDK exported as /home/user/rte</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">Step 1: Select the DPDK environment to build</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">[1] i686-native-linuxapp-gcc</span>

<span class="go">[2] i686-native-linuxapp-icc</span>

<span class="go">[3] ppc_64-power8-linuxapp-gcc</span>

<span class="go">[4] x86_64-ivshmem-linuxapp-gcc</span>

<span class="go">[5] x86_64-ivshmem-linuxapp-icc</span>

<span class="go">[6] x86_64-native-bsdapp-clang</span>

<span class="go">[7] x86_64-native-bsdapp-gcc</span>

<span class="go">[8] x86_64-native-linuxapp-clang</span>

<span class="go">[9] x86_64-native-linuxapp-gcc</span>

<span class="go">[10] x86_64-native-linuxapp-icc</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">Step 2: Setup linuxapp environment</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">[11] Insert IGB UIO module</span>

<span class="go">[12] Insert VFIO module</span>

<span class="go">[13] Insert KNI module</span>

<span class="go">[14] Setup hugepage mappings for non-NUMA systems</span>

<span class="go">[15] Setup hugepage mappings for NUMA systems</span>

<span class="go">[16] Display current Ethernet device settings</span>

<span class="go">[17] Bind Ethernet device to IGB UIO module</span>

<span class="go">[18] Bind Ethernet device to VFIO module</span>

<span class="go">[19] Setup VFIO permissions</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">Step 3: Run test application for linuxapp environment</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">[20] Run test application ($RTE_TARGET/app/test)</span>

<span class="go">[21] Run testpmd application in interactive mode ($RTE_TARGET/app/testpmd)</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">Step 4: Other tools</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">[22] List hugepage info from /proc/meminfo</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">Step 5: Uninstall and system cleanup</span>

<span class="go">------------------------------------------------------------------------</span>

<span class="go">[23] Uninstall all targets</span>

<span class="go">[24] Unbind NICs from IGB UIO driver</span>

<span class="go">[25] Remove IGB UIO module</span>

<span class="go">[26] Remove VFIO module</span>

<span class="go">[27] Remove KNI module</span>

<span class="go">[28] Remove hugepage mappings</span>

<span class="go">[29] Exit Script</span>
</pre></div>
</div>
<p>Option:</p>
<p>The following selection demonstrates the creation of the <code class="docutils literal"><span class="pre">x86_64-native-linuxapp-gcc</span></code> DPDK library.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Option: 9</span>

<span class="go">================== Installing x86_64-native-linuxapp-gcc</span>

<span class="go">Configuration done</span>
<span class="go">== Build lib</span>
<span class="go">...</span>
<span class="go">Build complete</span>
<span class="go">RTE_TARGET exported as x86_64-native-linuxapp-gcc</span>
</pre></div>
</div>
<p>The following selection demonstrates the starting of the DPDK UIO driver.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Option: 25</span>

<span class="go">Unloading any existing DPDK UIO module</span>
<span class="go">Loading DPDK UIO module</span>
</pre></div>
</div>
<p>The following selection demonstrates the creation of hugepages in a NUMA system.
1024 2 MByte pages are assigned to each node.
The result is that the application should use -m 4096 for starting the application to access both memory areas
(this is done automatically if the -m option is not provided).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If prompts are displayed to remove temporary files, type &#8216;y&#8217;.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Option: 15</span>

<span class="go">Removing currently reserved hugepages</span>
<span class="go">mounting /mnt/huge and removing directory</span>
<span class="go">Input the number of 2MB pages for each node</span>
<span class="go">Example: to have 128MB of hugepages available per node,</span>
<span class="go">enter &#39;64&#39; to reserve 64 * 2MB pages on each node</span>
<span class="go">Number of pages for node0: 1024</span>
<span class="go">Number of pages for node1: 1024</span>
<span class="go">Reserving hugepages</span>
<span class="go">Creating /mnt/huge and mounting as hugetlbfs</span>
</pre></div>
</div>
<p>The following selection demonstrates the launch of the test application to run on a single core.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">Option: 20</span>

<span class="go">Enter hex bitmask of cores to execute test app on</span>
<span class="go">Example: to execute app on cores 0 to 7, enter 0xff</span>
<span class="go">bitmask: 0x01</span>
<span class="go">Launching app</span>
<span class="go">EAL: coremask set to 1</span>
<span class="go">EAL: Detected lcore 0 on socket 0</span>
<span class="go">...</span>
<span class="go">EAL: Master core 0 is ready (tid=1b2ad720)</span>
<span class="go">RTE&gt;&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="applications">
<h2>6.3. Applications</h2>
<p>Once the user has run the setup.sh script, built one of the EAL targets and set up hugepages (if using one of the Linux EAL targets),
the user can then move on to building and running their application or one of the examples provided.</p>
<p>The examples in the /examples directory provide a good starting point to gain an understanding of the operation of the DPDK.
The following command sequence shows how the helloworld sample application is built and run.
As recommended in Section 4.2.1 , &#8220;Logical Core Use by Applications&#8221;,
the logical core layout of the platform should be determined when selecting a core mask to use for an application.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cd helloworld/</span>
<span class="go">make</span>
<span class="go">  CC main.o</span>
<span class="go">  LD helloworld</span>
<span class="go">  INSTALL-APP helloworld</span>
<span class="go">  INSTALL-MAP helloworld.map</span>

<span class="go">sudo ./build/app/helloworld -c 0xf -n 3</span>
<span class="go">[sudo] password for rte:</span>

<span class="go">EAL: coremask set to f</span>
<span class="go">EAL: Detected lcore 0 as core 0 on socket 0</span>
<span class="go">EAL: Detected lcore 1 as core 0 on socket 1</span>
<span class="go">EAL: Detected lcore 2 as core 1 on socket 0</span>
<span class="go">EAL: Detected lcore 3 as core 1 on socket 1</span>
<span class="go">EAL: Setting up hugepage memory...</span>
<span class="go">EAL: Ask a virtual area of 0x200000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0add800000 (size = 0x200000)</span>
<span class="go">EAL: Ask a virtual area of 0x3d400000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0aa0200000 (size = 0x3d400000)</span>
<span class="go">EAL: Ask a virtual area of 0x400000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9fc00000 (size = 0x400000)</span>
<span class="go">EAL: Ask a virtual area of 0x400000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9f600000 (size = 0x400000)</span>
<span class="go">EAL: Ask a virtual area of 0x400000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9f000000 (size = 0x400000)</span>
<span class="go">EAL: Ask a virtual area of 0x800000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9e600000 (size = 0x800000)</span>
<span class="go">EAL: Ask a virtual area of 0x800000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9dc00000 (size = 0x800000)</span>
<span class="go">EAL: Ask a virtual area of 0x400000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9d600000 (size = 0x400000)</span>
<span class="go">EAL: Ask a virtual area of 0x400000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9d000000 (size = 0x400000)</span>
<span class="go">EAL: Ask a virtual area of 0x400000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9ca00000 (size = 0x400000)</span>
<span class="go">EAL: Ask a virtual area of 0x200000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9c600000 (size = 0x200000)</span>
<span class="go">EAL: Ask a virtual area of 0x200000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a9c200000 (size = 0x200000)</span>
<span class="go">EAL: Ask a virtual area of 0x3fc00000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a5c400000 (size = 0x3fc00000)</span>
<span class="go">EAL: Ask a virtual area of 0x200000 bytes</span>
<span class="go">EAL: Virtual area found at 0x7f0a5c000000 (size = 0x200000)</span>
<span class="go">EAL: Requesting 1024 pages of size 2MB from socket 0</span>
<span class="go">EAL: Requesting 1024 pages of size 2MB from socket 1</span>
<span class="go">EAL: Master core 0 is ready (tid=de25b700)</span>
<span class="go">EAL: Core 1 is ready (tid=5b7fe700)</span>
<span class="go">EAL: Core 3 is ready (tid=5a7fc700)</span>
<span class="go">EAL: Core 2 is ready (tid=5affd700)</span>
<span class="go">hello from core 1</span>
<span class="go">hello from core 2</span>
<span class="go">hello from core 3</span>
<span class="go">hello from core 0</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nic_perf_intel_platform.html" class="btn btn-neutral float-right" title="7. How to get best performance with NICs on Intel platforms" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="enable_func.html" class="btn btn-neutral" title="5. Enabling Additional Functionality" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'16.04.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
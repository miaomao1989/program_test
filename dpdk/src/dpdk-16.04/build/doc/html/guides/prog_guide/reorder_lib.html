

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>16. Reorder Library &mdash; Data Plane Development Kit 16.04.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Data Plane Development Kit 16.04.0 documentation" href="../index.html"/>
        <link rel="up" title="Programmerâ€™s Guide" href="index.html"/>
        <link rel="next" title="17. IP Fragmentation and Reassembly Library" href="ip_fragment_reassembly_lib.html"/>
        <link rel="prev" title="15. Packet Distributor Library" href="packet_distrib_lib.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Data Plane Development Kit
          

          
            
            <img src="../_static/DPDK_logo_vertical_rev_small.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                16.04.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../linux_gsg/index.html">Getting Started Guide for Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freebsd_gsg/index.html">Getting Started Guide for FreeBSD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xen/index.html">Xen Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Programmer&#8217;s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html">2. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="env_abstraction_layer.html">3. Environment Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="ring_lib.html">4. Ring Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="mempool_lib.html">5. Mempool Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbuf_lib.html">6. Mbuf Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="poll_mode_drv.html">7. Poll Mode Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="cryptodev_lib.html">8. Cryptography Device Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="ivshmem_lib.html">9. IVSHMEM Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="link_bonding_poll_mode_drv_lib.html">10. Link Bonding Poll Mode Driver Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="timer_lib.html">11. Timer Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="hash_lib.html">12. Hash Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="lpm_lib.html">13. LPM Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="lpm6_lib.html">14. LPM6 Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet_distrib_lib.html">15. Packet Distributor Library</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">16. Reorder Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#operation">16.1. Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-details">16.2. Implementation Details</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-case-packet-distributor">16.3. Use Case: Packet Distributor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ip_fragment_reassembly_lib.html">17. IP Fragmentation and Reassembly Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_proc_support.html">18. Multi-process Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="kernel_nic_interface.html">19. Kernel NIC Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="thread_safety_dpdk_functions.html">20. Thread Safety of DPDK Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="qos_framework.html">21. Quality of Service (QoS) Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_man.html">22. Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet_classif_access_ctrl.html">23. Packet Classification and Access Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet_framework.html">24. Packet Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="vhost_lib.html">25. Vhost Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="port_hotplug_framework.html">26. Port Hotplug Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="source_org.html">27. Source Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_kit_build_system.html">28. Development Kit Build System</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_kit_root_make_help.html">29. Development Kit Root Makefile Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="extend_dpdk.html">30. Extending the DPDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_app.html">31. Building Your Own Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="ext_app_lib_make_help.html">32. External Application/Library Makefile help</a></li>
<li class="toctree-l2"><a class="reference internal" href="perf_opt_guidelines.html">33. Performance Optimization Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="writing_efficient_code.html">34. Writing Efficient Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="profile_app.html">35. Profile Your Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">36. Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nics/index.html">Network Interface Controller Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cryptodevs/index.html">Crypto Device Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sample_app_ug/index.html">Sample Applications User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testpmd_app_ug/index.html">Testpmd Application User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rel_notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributor&#8217;s Guidelines</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Data Plane Development Kit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Programmer&#8217;s Guide</a> &raquo;</li>
      
    <li>16. Reorder Library</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/prog_guide/reorder_lib.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reorder-library">
<span id="id1"></span><h1>16. Reorder Library</h1>
<p>The Reorder Library provides a mechanism for reordering mbufs based on their
sequence number.</p>
<div class="section" id="operation">
<h2>16.1. Operation</h2>
<p>The reorder library is essentially a buffer that reorders mbufs.
The user inserts out of order mbufs into the reorder buffer and pulls in-order
mbufs from it.</p>
<p>At a given time, the reorder buffer contains mbufs whose sequence number are
inside the sequence window. The sequence window is determined by the minimum
sequence number and the number of entries that the buffer was configured to hold.
For example, given a reorder buffer with 200 entries and a minimum sequence
number of 350, the sequence window has low and high limits of 350 and 550
respectively.</p>
<p>When inserting mbufs, the reorder library differentiates between valid, early
and late mbufs depending on the sequence number of the inserted mbuf:</p>
<ul class="simple">
<li>valid: the sequence number is inside the window.</li>
<li>late: the sequence number is outside the window and less than the low limit.</li>
<li>early: the sequence number is outside the window and greater than the high
limit.</li>
</ul>
<p>The reorder buffer directly returns late mbufs and tries to accommodate early
mbufs.</p>
</div>
<div class="section" id="implementation-details">
<h2>16.2. Implementation Details</h2>
<p>The reorder library is implemented as a pair of buffers, which referred to as
the <em>Order</em> buffer and the <em>Ready</em> buffer.</p>
<p>On an insert call, valid mbufs are inserted directly into the Order buffer and
late mbufs are returned to the user with an error.</p>
<p>In the case of early mbufs, the reorder buffer will try to move the window
(incrementing the minimum sequence number) so that the mbuf becomes a valid one.
To that end, mbufs in the Order buffer are moved into the Ready buffer.
Any mbufs that have not arrived yet are ignored and therefore will become
late mbufs.
This means that as long as there is room in the Ready buffer, the window will
be moved to accommodate early mbufs that would otherwise be outside the
reordering window.</p>
<p>For example, assuming that we have a buffer of 200 entries with a 350 minimum
sequence number, and we need to insert an early mbuf with 565 sequence number.
That means that we would need to move the windows at least 15 positions to
accommodate the mbuf.
The reorder buffer would try to move mbufs from at least the next 15 slots in
the Order buffer to the Ready buffer, as long as there is room in the Ready buffer.
Any gaps in the Order buffer at that point are skipped, and those packet will
be reported as late packets when they arrive. The process of moving packets
to the Ready buffer continues beyond the minimum required until a gap,
i.e. missing mbuf, in the Order buffer is encountered.</p>
<p>When draining mbufs, the reorder buffer would return  mbufs in the Ready
buffer first and then from the Order buffer until a gap is found (mbufs that
have not arrived yet).</p>
</div>
<div class="section" id="use-case-packet-distributor">
<h2>16.3. Use Case: Packet Distributor</h2>
<p>An application using the DPDK packet distributor could make use of the reorder
library to transmit packets in the same order they were received.</p>
<p>A basic packet distributor use case would consist of a distributor with
multiple workers cores.
The processing of packets by the workers is not guaranteed to be in order,
hence a reorder buffer can be used to order as many packets as possible.</p>
<p>In such a scenario, the distributor assigns a sequence number to mbufs before
delivering them to the workers.
As the workers finish processing the packets, the distributor inserts those
mbufs into the reorder buffer and finally transmit drained mbufs.</p>
<p>NOTE: Currently the reorder buffer is not thread safe so the same thread is
responsible for inserting and draining mbufs.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ip_fragment_reassembly_lib.html" class="btn btn-neutral float-right" title="17. IP Fragmentation and Reassembly Library" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="packet_distrib_lib.html" class="btn btn-neutral" title="15. Packet Distributor Library" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'16.04.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>